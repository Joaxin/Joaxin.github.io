<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>R Tests | Pinsflora</title><meta name="keywords" content="Stats,Statistical Test"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="R的各种检验">
<meta property="og:type" content="article">
<meta property="og:title" content="R Tests">
<meta property="og:url" content="https://u.pinsflora.xyz/Reverie/html/R_stats_tests/index.html">
<meta property="og:site_name" content="Pinsflora">
<meta property="og:description" content="R的各种检验">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_tests_.png">
<meta property="article:published_time" content="2018-01-24T16:00:00.000Z">
<meta property="article:modified_time" content="2018-04-20T16:00:00.000Z">
<meta property="article:author" content="Joaxin">
<meta property="article:tag" content="Stats">
<meta property="article:tag" content="Statistical Test">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_tests_.png"><link rel="shortcut icon" href="/img/favicon-32x32.png"><link rel="canonical" href="https://u.pinsflora.xyz/Reverie/html/R_stats_tests/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":600,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2018-04-21 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_tests_.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">R Tests</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-01-24T16:00:00.000Z" title="Created 2018-01-25 00:00:00">2018-01-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2018-04-20T16:00:00.000Z" title="Updated 2018-04-21 00:00:00">2018-04-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/R/">R</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/R/Stats/">Stats</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">3.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>23min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="R Tests"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container">

<div class="toc" id="TOC">
<ul>
<li><a href="#t.test">T.test</a><ul>
<li><a href="#students-t-test">Student’s t-test</a></li>
<li><a href="#paired-t-test">Paired t-test</a></li>
<li><a href="#misc">MISC</a></li>
</ul></li>
<li><a href="#frequency-tests">Frequency tests</a><ul>
<li><a href="#chi-square-test">Chi-square test</a></li>
<li><a href="#exact-binomial-test">exact binomial test</a></li>
<li><a href="#fishers-exact-test">Fisher’s exact test</a></li>
<li><a href="#cochran-mantel-haenszel-test">Cochran-Mantel-Haenszel test</a></li>
<li><a href="#mcnemars-test">McNemar’s test</a></li>
</ul></li>
<li><a href="#homogeneity-of-variance">Homogeneity of variance</a><ul>
<li><a href="#bartletts-test">Bartlett’s test</a></li>
<li><a href="#levenes-test">Levene’s test</a></li>
<li><a href="#fligner-killeen-test">Fligner-Killeen test</a></li>
</ul></li>
<li><a href="#inter-rater-reliability">Inter-rater reliability</a><ul>
<li><a href="#two-raters-cohens-kappa">Two raters: Cohen’s Kappa</a></li>
<li><a href="#n-raters-fleisss-kappa-congers-kappa">N raters: Fleiss’s Kappa, Conger’s Kappa</a></li>
<li><a href="#ordinal-data-weighted-kappa">Ordinal data: weighted Kappa</a></li>
<li><a href="#weighted-kappa-with-factors">Weighted Kappa with factors</a></li>
<li><a href="#continuous-data-intraclass-correlation-coefficient">Continuous data: Intraclass correlation coefficient</a></li>
<li><a href="#references">REFERENCES</a></li>
</ul></li>
</ul>
</div>
<div id="content-wrapper">
<div class="inner clearfix">
<section id="main-content">
<div class="section level2" id="t.test">
<h2>T.test</h2>
<p>You want to test whether two samples are drawn from populations with different means, or test whether one sample is drawn from a population with a mean different from some theoretical mean. t.test(x, y = NULL, alternative = c(“two.sided”, “less”, “greater”), mu = 0, paired = FALSE (paired t-test), var.equal = FALSE (uses the Welch t-test or Student’s t-test), conf.level = 0.95, …)</p>
<p>Data which show the effect of two soporific drugs (increase in hours of sleep compared to control) on 10 patients.</p>
<p>extra: increase in hours of sleep group: drug given ID : patient ID</p>
<div class="section level3" id="students-t-test">
<h3>Student’s t-test</h3>
<p>Suppose the two groups are independently sampled</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># t.test(extra ~ group, sleep) Welch t-test</span>
<span class="keyword">t.test</span>(extra <span class="string">~</span><span class="string"> </span>group, sleep, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Two Sample t-test
## 
## data:  extra by group
## t = -1.8608, df = 18, p-value = 0.07919
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.363874  0.203874
## sample estimates:
## mean in group 1 mean in group 2 
##            0.75            2.33</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Not too significant indeed</span></pre></td></tr></tbody></table></figure>
</div>
<div class="section level3" id="paired-t-test">
<h3>Paired t-test</h3>
<p>You might have observations before and after a treatment, or of two matched subjects with different treatments.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># with(sleep,</span>
<span class="comment">#      t.test(extra[group == 1],</span>
<span class="comment">#             extra[group == 2], paired = TRUE)) </span>
<span class="comment"># t.test(extra ~ group, data = sleep,paired=TRUE)</span>
<span class="comment"># with(sleep,</span>
<span class="comment"># t.test(extra[group == 1] - extra[group == 2], mu=0, var.equal=TRUE)</span>
<span class="comment"># )</span>
<span class="comment">#   Paired t-test/One Sample t-test</span>
<span class="comment"># </span>
<span class="comment"># data:  extra by group</span>
<span class="comment"># t = -4.0621, df = 9, p-value = 0.002833</span>
<span class="comment"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="comment"># 95 percent confidence interval:</span>
<span class="comment">#  -2.4598858 -0.7001142</span>
<span class="comment"># sample estimates:</span>
<span class="comment"># mean of the differences </span>
<span class="comment">#                   -1.58 </span>

<span class="keyword">with</span>(sleep,
<span class="keyword">stripchart</span>(extra[group <span class="string">==</span><span class="string"> </span><span class="number">2</span>] <span class="string">-</span><span class="string"> </span>extra[group <span class="string">==</span><span class="string"> </span><span class="number">1</span>], <span class="dt">method =</span> <span class="string">"stack"</span>, <span class="dt">xlab =</span> <span class="string">"hours"</span>,
           <span class="dt">main =</span> <span class="string">"Sleep prolongation (n = 10)"</span>)
)
<span class="keyword">with</span>(sleep,
     <span class="keyword">boxplot</span>(extra[group <span class="string">==</span><span class="string"> </span><span class="number">2</span>] <span class="string">-</span><span class="string"> </span>extra[group <span class="string">==</span><span class="string"> </span><span class="number">1</span>], <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,
        <span class="dt">at =</span> .<span class="number">6</span>, <span class="dt">pars =</span> <span class="keyword">list</span>(<span class="dt">boxwex =</span> <span class="fl">0.5</span>, <span class="dt">staplewex =</span> <span class="fl">0.25</span>))
)</pre></td></tr></tbody></table></figure>
<p><img src="data:image/png;base64,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"><!-- --></p>
</div>
<div class="section level3" id="misc">
<h3>MISC</h3>
<p>Comparing a group against an expected population mean: one-sample t-test</p>
<p>Suppose that you want to test whether the data in column extra is drawn from a population whose true mean is 0.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">t.test</span>(sleep<span class="string">$</span>extra, <span class="dt">mu=</span><span class="number">0</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  One Sample t-test
## 
## data:  sleep$extra
## t = 3.413, df = 19, p-value = 0.002918
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  0.5955845 2.4844155
## sample estimates:
## mean of x 
##      1.54</pre></td></tr></tbody></table></figure>
</div>
</div>
<div class="section level2" id="frequency-tests">
<h2>Frequency tests</h2>
<p>There are two general questions that frequency tests address:</p>
<ol style="list-style-type: decimal">
<li>Does the frequency distribution differ from an expected, or theoretical, distribution (e.g., expect 50% yes, 50% no)? (Goodness-of-fit test)</li>
<li>Does the frequency distribution differ between two or more groups? (Independence test)</li>
</ol>
<table>
<thead>
<tr class="header">
<th></th>
<th><strong>Expected distribution</strong></th>
<th><strong>Comparing groups</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Exact</strong></td>
<td>Exact binomial</td>
<td>Fisher’s exact</td>
</tr>
<tr class="even">
<td><strong>Approximate</strong></td>
<td>Chi-square goodness of fit</td>
<td>Chi-square test of independence</td>
</tr>
</tbody>
</table>
<p>Note: The exact binomial test can only be used on one variable that has two levels. Fisher’s exact test can only be used with two-dimensional contingency tables (for example, it can be used when there is one independent variable and one dependent variable, but not when there are 2 IVs and 1 DV).</p>
<p>To test for paired or within-subjects effects, McNemar’s test can be used. To use it, there must be one IV with two levels, and one DV with two levels.</p>
<p>To test for the independence of two variables with repeated measurements, the Cochran-Mantel-Haenszel test can be used.</p>
<div class="section level3" id="chi-square-test">
<h3>Chi-square test</h3>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># chisq.test(c(5,7))</span>
<span class="comment"># data:  c(5, 7)</span>
<span class="comment"># X-squared = 0.33333, df = 1, p-value = 0.5637</span>
M &lt;-<span class="string"> </span><span class="keyword">as.table</span>(<span class="keyword">rbind</span>(<span class="keyword">c</span>(<span class="number">762</span>, <span class="number">327</span>, <span class="number">468</span>), <span class="keyword">c</span>(<span class="number">484</span>, <span class="number">239</span>, <span class="number">477</span>)))
<span class="keyword">dimnames</span>(M) &lt;-<span class="string"> </span><span class="keyword">list</span>(<span class="dt">gender =</span> <span class="keyword">c</span>(<span class="string">"F"</span>, <span class="string">"M"</span>),
                    <span class="dt">party =</span> <span class="keyword">c</span>(<span class="string">"Democrat"</span>,<span class="string">"Independent"</span>, <span class="string">"Republican"</span>))
<span class="comment">#       party</span>
<span class="comment"># gender Democrat Independent Republican</span>
<span class="comment">#      F      762         327        468</span>
<span class="comment">#      M      484         239        477</span>
<span class="keyword">chisq.test</span>(M,<span class="dt">p=</span><span class="keyword">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>)) <span class="comment"># Pearson’s chi-square test </span></pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Pearson's Chi-squared test
## 
## data:  M
## X-squared = 30.07, df = 2, p-value = 2.954e-07</pre></td></tr></tbody></table></figure>
</div>
<div class="section level3" id="exact-binomial-test">
<h3>exact binomial test</h3>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">binom.test</span>(<span class="keyword">c</span>(<span class="number">682</span>, <span class="number">243</span>), <span class="dt">p =</span> <span class="number">3</span><span class="string">/</span><span class="number">4</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Exact binomial test
## 
## data:  c(682, 243)
## number of successes = 682, number of trials = 925, p-value =
## 0.3825
## alternative hypothesis: true probability of success is not equal to 0.75
## 95 percent confidence interval:
##  0.7076683 0.7654066
## sample estimates:
## probability of success 
##              0.7372973</pre></td></tr></tbody></table></figure>
</div>
<div class="section level3" id="fishers-exact-test">
<h3>Fisher’s exact test</h3>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r">TeaTasting &lt;-<span class="keyword">matrix</span>(<span class="keyword">c</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>),<span class="dt">nrow =</span> <span class="number">2</span>,
       <span class="dt">dimnames =</span> <span class="keyword">list</span>(<span class="dt">Guess =</span> <span class="keyword">c</span>(<span class="string">"Milk"</span>, <span class="string">"Tea"</span>),
                       <span class="dt">Truth =</span> <span class="keyword">c</span>(<span class="string">"Milk"</span>, <span class="string">"Tea"</span>)))
<span class="keyword">fisher.test</span>(TeaTasting, <span class="dt">alternative =</span> <span class="string">"greater"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Fisher's Exact Test for Count Data
## 
## data:  TeaTasting
## p-value = 0.2429
## alternative hypothesis: true odds ratio is greater than 1
## 95 percent confidence interval:
##  0.3135693       Inf
## sample estimates:
## odds ratio 
##   6.408309</pre></td></tr></tbody></table></figure>
</div>
<div class="section level3" id="cochran-mantel-haenszel-test">
<h3>Cochran-Mantel-Haenszel test</h3>
<p>The Cochran-Mantel-Haenszel test (or Mantel-Haenszel test) is used for testing the independence of two dichotomous variables with repeated measurements. It is most commonly used with 2x2xK tables, where K is the number of measurement conditions. For example, you may want to know whether a treatment (C vs.&nbsp;D) affects the likelihood of recovery (yes or no). Suppose, though, that the treatments were administered at three different times of day, morning, afternoon, and night – and that you want your test to control for this. The CMH test would then operate on a 2x2x3 contingency table, where the third variable is the one you wish to control for.</p>
<p>The implementation of the CMH test in R can handle dimensions greater than 2x2xK. For example, you could use it for a 3x3xK contingency table.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r">fish &lt;-<span class="string"> </span><span class="keyword">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="string">'</span>
<span class="string">  Location Allele   Habitat Count</span>
<span class="string"> tillamook     94    marine    56</span>
<span class="string"> tillamook     94 estuarine    69</span>
<span class="string"> tillamook non-94    marine    40</span>
<span class="string"> tillamook non-94 estuarine    77</span>
<span class="string">   yaquina     94    marine    61</span>
<span class="string">   yaquina     94 estuarine   257</span>
<span class="string">   yaquina non-94    marine    57</span>
<span class="string">   yaquina non-94 estuarine   301</span>
<span class="string">     alsea     94    marine    73</span>
<span class="string">     alsea     94 estuarine    65</span>
<span class="string">     alsea non-94    marine    71</span>
<span class="string">     alsea non-94 estuarine    79</span>
<span class="string">    umpqua     94    marine    71</span>
<span class="string">    umpqua     94 estuarine    48</span>
<span class="string">    umpqua non-94    marine    55</span>
<span class="string">    umpqua non-94 estuarine    48</span>
<span class="string">'</span>)
<span class="comment"># Make a 3D contingency table, where the last variable, Location, is the one to </span>
<span class="comment"># control for. If you use table() for case data, the last variable is also the </span>
<span class="comment"># one to control for.</span>
ct &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Allele <span class="string">+</span><span class="string"> </span>Habitat <span class="string">+</span><span class="string"> </span>Location, <span class="dt">data=</span>fish)
ct</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## , , Location = alsea
## 
##         Habitat
## Allele   estuarine marine
##   94            65     73
##   non-94        79     71
## 
## , , Location = tillamook
## 
##         Habitat
## Allele   estuarine marine
##   94            69     56
##   non-94        77     40
## 
## , , Location = umpqua
## 
##         Habitat
## Allele   estuarine marine
##   94            48     71
##   non-94        48     55
## 
## , , Location = yaquina
## 
##         Habitat
## Allele   estuarine marine
##   94           257     61
##   non-94       301     57</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># This prints ct in a "flat" format</span>
<span class="keyword">ftable</span>(ct)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##                  Location alsea tillamook umpqua yaquina
## Allele Habitat                                          
## 94     estuarine             65        69     48     257
##        marine                73        56     71      61
## non-94 estuarine             79        77     48     301
##        marine                71        40     55      57</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Print with different arrangement of variables</span>
<span class="keyword">ftable</span>(ct, <span class="dt">row.vars=</span><span class="keyword">c</span>(<span class="string">"Location"</span>,<span class="string">"Allele"</span>), <span class="dt">col.vars=</span><span class="string">"Habitat"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##                  Habitat estuarine marine
## Location  Allele                         
## alsea     94                    65     73
##           non-94                79     71
## tillamook 94                    69     56
##           non-94                77     40
## umpqua    94                    48     71
##           non-94                48     55
## yaquina   94                   257     61
##           non-94               301     57</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">mantelhaen.test</span>(ct)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Mantel-Haenszel chi-squared test with continuity correction
## 
## data:  ct
## Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463
## alternative hypothesis: true common odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.6005522 0.9593077
## sample estimates:
## common odds ratio 
##          0.759022</pre></td></tr></tbody></table></figure>
<p>According to this test, there is a relationship between Allele and Habitat, controlling for Location, p=.025.</p>
<p>Note that the first two dimensions of the contingency table are treated the same (so their order can be swapped without affecting the test result), the highest-order dimension in the contingency table is different. This is illustrated below.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># The following two create different contingency tables, but have the same result</span>
<span class="comment"># with the CMH test</span>
ct.<span class="number">1</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Habitat <span class="string">+</span><span class="string"> </span>Allele <span class="string">+</span><span class="string"> </span>Location, <span class="dt">data=</span>fish)
ct.<span class="number">2</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Allele <span class="string">+</span><span class="string"> </span>Habitat <span class="string">+</span><span class="string"> </span>Location, <span class="dt">data=</span>fish)
<span class="keyword">mantelhaen.test</span>(ct.<span class="number">1</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Mantel-Haenszel chi-squared test with continuity correction
## 
## data:  ct.1
## Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463
## alternative hypothesis: true common odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.6005522 0.9593077
## sample estimates:
## common odds ratio 
##          0.759022</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">mantelhaen.test</span>(ct.<span class="number">2</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Mantel-Haenszel chi-squared test with continuity correction
## 
## data:  ct.2
## Mantel-Haenszel X-squared = 5.0497, df = 1, p-value = 0.02463
## alternative hypothesis: true common odds ratio is not equal to 1
## 95 percent confidence interval:
##  0.6005522 0.9593077
## sample estimates:
## common odds ratio 
##          0.759022</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># With Allele last, we get a different result</span>
ct.<span class="number">3</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Location <span class="string">+</span><span class="string"> </span>Habitat <span class="string">+</span><span class="string"> </span>Allele, <span class="dt">data=</span>fish)
ct.<span class="number">4</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Habitat <span class="string">+</span><span class="string"> </span>Location <span class="string">+</span><span class="string"> </span>Allele, <span class="dt">data=</span>fish)
<span class="keyword">mantelhaen.test</span>(ct.<span class="number">3</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Cochran-Mantel-Haenszel test
## 
## data:  ct.3
## Cochran-Mantel-Haenszel M^2 = 168.47, df = 3, p-value &lt; 2.2e-16</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">mantelhaen.test</span>(ct.<span class="number">4</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Cochran-Mantel-Haenszel test
## 
## data:  ct.4
## Cochran-Mantel-Haenszel M^2 = 168.47, df = 3, p-value &lt; 2.2e-16</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># With Habitat last, we get a different result</span>
ct.<span class="number">5</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Allele <span class="string">+</span><span class="string"> </span>Location <span class="string">+</span><span class="string"> </span>Habitat, <span class="dt">data=</span>fish)
ct.<span class="number">6</span> &lt;-<span class="string"> </span><span class="keyword">xtabs</span>(Count <span class="string">~</span><span class="string"> </span>Location <span class="string">+</span><span class="string"> </span>Allele <span class="string">+</span><span class="string"> </span>Habitat, <span class="dt">data=</span>fish)
<span class="keyword">mantelhaen.test</span>(ct.<span class="number">5</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Cochran-Mantel-Haenszel test
## 
## data:  ct.5
## Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">mantelhaen.test</span>(ct.<span class="number">6</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Cochran-Mantel-Haenszel test
## 
## data:  ct.6
## Cochran-Mantel-Haenszel M^2 = 2.0168, df = 3, p-value = 0.5689</pre></td></tr></tbody></table></figure>
</div>
<div class="section level3" id="mcnemars-test">
<h3>McNemar’s test</h3>
<p>McNemar’s test is conceptually like a within-subjects test for frequency data. For example, suppose you want to test whether a treatment increases the probability that a person will respond “yes” to a question, and that you get just one pre-treatment and one post-treatment response per person. A standard chi-square test would be inappropriate, because it assumes that the groups are independent. Instead, McNemar’s test can be used. This test can only be used when there are two measurements of a dichotomous variable. The 2x2 contingency table used for McNemar’s test bears a superficial resemblance to those used for “normal” chi-square tests, but it is different in structure.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r">data &lt;-<span class="string"> </span><span class="keyword">read.table</span>(<span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">text=</span><span class="string">'</span>
<span class="string"> subject time result</span>
<span class="string">       1  pre      0</span>
<span class="string">       1 post      1</span>
<span class="string">       2  pre      1</span>
<span class="string">       2 post      1</span>
<span class="string">       3  pre      0</span>
<span class="string">       3 post      1</span>
<span class="string">       4  pre      1</span>
<span class="string">       4 post      0</span>
<span class="string">       5  pre      1</span>
<span class="string">       5 post      1</span>
<span class="string">       6  pre      0</span>
<span class="string">       6 post      1</span>
<span class="string">       7  pre      0</span>
<span class="string">       7 post      1</span>
<span class="string">       8  pre      0</span>
<span class="string">       8 post      1</span>
<span class="string">       9  pre      0</span>
<span class="string">       9 post      1</span>
<span class="string">      10  pre      1</span>
<span class="string">      10 post      1</span>
<span class="string">      11  pre      0</span>
<span class="string">      11 post      0</span>
<span class="string">      12  pre      1</span>
<span class="string">      12 post      1</span>
<span class="string">      13  pre      0</span>
<span class="string">      13 post      1</span>
<span class="string">      14  pre      0</span>
<span class="string">      14 post      0</span>
<span class="string">      15  pre      0</span>
<span class="string">      15 post      1</span>
<span class="string">'</span>)
<span class="keyword">library</span>(tidyr)

data_wide &lt;-<span class="string"> </span><span class="keyword">spread</span>(data, time, result)
ct &lt;-<span class="string"> </span><span class="keyword">table</span>( data_wide[,<span class="keyword">c</span>(<span class="string">"pre"</span>,<span class="string">"post"</span>)] )
ct</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##    post
## pre 0 1
##   0 2 8
##   1 1 4</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment">#&gt;    post</span>
<span class="comment">#&gt; pre 0 1</span>
<span class="comment">#&gt;   0 2 8</span>
<span class="comment">#&gt;   1 1 4</span>

<span class="comment"># The contingency table above puts each subject into one of four cells, depending</span>
<span class="comment"># on their pre- and post-treatment response. Note that it it is different from</span>
<span class="comment"># the contingency table used for a "normal" chi-square test, shown below. The table</span>
<span class="comment"># below does not account for repeated measurements, and so it is not useful for</span>
<span class="comment"># the purposes here.</span>

<span class="comment"># table(data[,c("time","result")])</span>
<span class="comment">#       result</span>
<span class="comment"># time    0  1</span>
<span class="comment">#   post  3 12</span>
<span class="comment">#   pre  10  5</span>
<span class="keyword">mcnemar.test</span>(ct)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  McNemar's Chi-squared test with continuity correction
## 
## data:  ct
## McNemar's chi-squared = 4, df = 1, p-value = 0.0455</pre></td></tr></tbody></table></figure>
<p>For small sample sizes, it uses a continuity correction. Instead of using this correction, you can use an exact version of McNemar’s test, which is more accurate. It is available in the package exact2x2.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">library</span>(exact2x2)
<span class="comment">#&gt; Loading required package: exactci</span>
<span class="comment">#&gt; Loading required package: ssanv</span>
<span class="keyword">mcnemar.exact</span>(ct)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Exact McNemar test (with central confidence intervals)
## 
## data:  ct
## b = 8, c = 1, p-value = 0.03906
## alternative hypothesis: true odds ratio is not equal to 1
## 95 percent confidence interval:
##    1.072554 354.981246
## sample estimates:
## odds ratio 
##          8</pre></td></tr></tbody></table></figure>
</div>
</div>
<div class="section level1" id="homogeneity-of-variance">
<h1>Homogeneity of variance</h1>
<p>You want test samples to see for homogeneity of variance (homoscedasticity) – or more accurately. Many statistical tests assume that the populations are homoscedastic. - <strong>Bartlett’s test</strong> - If the data is normally distributed, this is the best test to use. It is sensitive to data which is not non-normally distribution; it is more likely to return a “false positive” when the data is non-normal. - <strong>Levene’s test</strong> - this is more robust to departures from normality than Bartlett’s test. It is in the <code>car</code> package. - <strong>Fligner-Killeen test</strong> - this is a non-parametric test which is very robust against departures from normality.</p>
<p>For all these tests, the null hypothesis is that all populations variances are equal; the alternative hypothesis is that at least two of them differ.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">head</span>(InsectSprays)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##   count spray
## 1    10     A
## 2     7     A
## 3    20     A
## 4    14     A
## 5    14     A
## 6    12     A</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r">tg      &lt;-<span class="string"> </span>ToothGrowth
tg<span class="string">$</span>dose &lt;-<span class="string"> </span><span class="keyword">factor</span>(tg<span class="string">$</span>dose) <span class="comment"># Treat this column as a factor, not numeric</span>
<span class="keyword">head</span>(tg)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##    len supp dose
## 1  4.2   VC  0.5
## 2 11.5   VC  0.5
## 3  7.3   VC  0.5
## 4  5.8   VC  0.5
## 5  6.4   VC  0.5
## 6 10.0   VC  0.5</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">plot</span>(count <span class="string">~</span><span class="string"> </span>spray, <span class="dt">data =</span> InsectSprays)</pre></td></tr></tbody></table></figure>
<p><img src="data:image/png;base64,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BDrT4bXiSiHQPBzFOyPQPATqjEDzEKgzAs0T8+WZQAg0D4E6I9A8BOqMQPOwD+qMQPMQqDMCzUOgzgg0D4E6I9A8kQ+SdJfs40Ka/+Iiwwkr5566IFBv5dxTFwQKaQQKaQQKaQTqrZx76sIp0Mu+O03x7ZfJcJGVc09d+ARabX503xz7b7KGC62ce+rCJdDL/p5l9fyePVxs5dxTFy6Bnnev/bfHP5/klV6j8BHi5ZlA2IJCmtc+6G0Tyj4o8jgdxZ933bPZwPaTQDES50EhjUAhjUAhjUAhjUAhjUAhjUAhjUAhbbFAgVEWCjSTz9K4jBpn0EiLutw845S+gkq//wvOM07pK6j0+7/gPOOUvoJKv/8LzjNO6Suo9Pu/4DzjlL6CSr//C84zTukrqPT7v+A845S+gkq//wvOM07pK6j0+7/gPEASAoU0AoU0AoU0AoU0AoU0AoU0AoU0AoU0AoU0AoU0AoU0AoU0pUAPQx+LmzNk4+nNeNj2aieDH5KapFvSzevXv5kwqs+yWi/sQ0KBnr7/bfDyNqkO7ZqpjAvtPmD6YDpqt6Sn7YvhmP2o1nxGfUwo0Orbv7fW/ya7h/K8M900n7rFvOwt19NtpR9t/y0RqJ3L/qX+z3jQPlDT8PsrSPzHcnt/W+nGDwGB2mm2HdbPxf1TvOlKt/9n1OhXuu3KJ1A7zb02fi6+786bPqDmC9nqV3pluh/eH87YLnGRgZ627YGH8WFS91AeN5bbvFCB+mxB5zuI1wm0cjl1cVtBpt3zFF/iFvS21s87l9Mstpul/iDpaPmviYOkx1QC7U+vGB8m9VtQ00eU00wFBtrf525X1HhY003d9Xai/rJ3OVEf4XCmwEBP91P0todJTi91tpeEjPRSZ4Tt8mMigQKPESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikEai107b9FMXT939u24sXnH/+Y/PtV/tBiK/X66H5AGXbq46sG4Eaaz/p9Lh5rTt9bT8597xrPk2zCbP59Ohj3eplP8vlB9aBQI0dbx/A231WcvX83l4U5PzzrWu3uabY6bv1B+quGIEaO++6QrvPjD4+vd0vc3fsn+OrGT+gODwCtdZeCbnfTN4DrTab7lKk9Rb24HGdpbUiUA+Hp7c/A223p+2X889//eQZfjwC9VBHebtyXrMP+nrbM20vNnLZ/4Vn+AkI1Fh7oaP6y2nbHLNvusOi2/FRe8nMyvjCmStHoNaO3VVfTtu/b9ujovs+6NPboYmXY/hJCNTJ7ys//e8P/soz/AQE6mQw0Ipn+CkI1MlAoKcth0iTECikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESikESik/RcDxQNNoewSlQAAAABJRU5ErkJggg=="><!-- --></p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">plot</span>(len <span class="string">~</span><span class="string"> </span><span class="keyword">interaction</span>(dose,supp), <span class="dt">data=</span>ToothGrowth)</pre></td></tr></tbody></table></figure>
<p><img src="data:image/png;base64,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"><!-- --></p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># On a first glance, it appears that both data sets are heteroscedastic, but this needs to be properly tested, which we’ll do below.</span></pre></td></tr></tbody></table></figure>
<div class="section level2" id="bartletts-test">
<h2>Bartlett’s test</h2>
<p>With one independent variable:</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">bartlett.test</span>(count <span class="string">~</span><span class="string"> </span>spray, <span class="dt">data=</span>InsectSprays)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Bartlett test of homogeneity of variances
## 
## data:  count by spray
## Bartlett's K-squared = 25.96, df = 5, p-value = 9.085e-05</pre></td></tr></tbody></table></figure>
<p>With multiple independent variables, the interaction() function must be used to collapse the IV’s into a single variable with all combinations of the factors. If it is not used, then the will be the wrong degrees of freedom, and the p-value will be wrong.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">bartlett.test</span>(len <span class="string">~</span><span class="string"> </span><span class="keyword">interaction</span>(supp,dose), <span class="dt">data=</span>ToothGrowth)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Bartlett test of homogeneity of variances
## 
## data:  len by interaction(supp, dose)
## Bartlett's K-squared = 6.9273, df = 5, p-value = 0.2261</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># The above gives the same result as testing len vs. dose alone, without supp</span>
<span class="keyword">bartlett.test</span>(len <span class="string">~</span><span class="string"> </span>dose, <span class="dt">data=</span>ToothGrowth)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Bartlett test of homogeneity of variances
## 
## data:  len by dose
## Bartlett's K-squared = 0.66547, df = 2, p-value = 0.717</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="levenes-test">
<h2>Levene’s test</h2>
<p>With one independent variable:</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">library</span>(car)

<span class="keyword">leveneTest</span>(count <span class="string">~</span><span class="string"> </span>spray, <span class="dt">data=</span>InsectSprays)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## Levene's Test for Homogeneity of Variance (center = median)
##       Df F value   Pr(&gt;F)   
## group  5  3.8214 0.004223 **
##       66                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</pre></td></tr></tbody></table></figure>
<p>With two independent variables. Note that the interaction function is not needed, as it is for the other two tests.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">leveneTest</span>(len <span class="string">~</span><span class="string"> </span>supp<span class="string">*</span>dose, <span class="dt">data=</span>tg)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## Levene's Test for Homogeneity of Variance (center = median)
##       Df F value Pr(&gt;F)
## group  5  1.7086 0.1484
##       54</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="fligner-killeen-test">
<h2>Fligner-Killeen test</h2>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># With one independent variable:</span>

<span class="keyword">fligner.test</span>(count <span class="string">~</span><span class="string"> </span>spray, <span class="dt">data=</span>InsectSprays)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  count by spray
## Fligner-Killeen:med chi-squared = 14.483, df = 5, p-value =
## 0.01282</pre></td></tr></tbody></table></figure>
<p>The <code>fligner.test</code> function has the same quirks as <code>bartlett.test</code> when working with multiple IV’s. With multiple independent variables, the <code>interaction()</code> function must be used.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">fligner.test</span>(len <span class="string">~</span><span class="string"> </span><span class="keyword">interaction</span>(supp,dose), <span class="dt">data=</span>ToothGrowth)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  len by interaction(supp, dose)
## Fligner-Killeen:med chi-squared = 7.7488, df = 5, p-value = 0.1706</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># The above gives the same result as testing len vs. dose alone, without supp</span>
<span class="keyword">fligner.test</span>(len <span class="string">~</span><span class="string"> </span>dose, <span class="dt">data=</span>ToothGrowth)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## 
##  Fligner-Killeen test of homogeneity of variances
## 
## data:  len by dose
## Fligner-Killeen:med chi-squared = 1.3879, df = 2, p-value = 0.4996</pre></td></tr></tbody></table></figure>
</div>
</div>
<div class="section level1" id="inter-rater-reliability">
<h1>Inter-rater reliability</h1>
<p>The method for calculating inter-rater reliability will depend on the type of data (categorical, ordinal, or continuous) and the number of coders.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">library</span>(irr)
<span class="comment"># Loading required package: lpSolve</span>

<span class="keyword">data</span>(diagnoses)
dat &lt;-<span class="string"> </span>diagnoses[,<span class="number">1</span><span class="string">:</span><span class="number">3</span>]</pre></td></tr></tbody></table></figure>
<div class="section level2" id="two-raters-cohens-kappa">
<h2>Two raters: Cohen’s Kappa</h2>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># This will calculate Cohen’s Kappa for two coders – In this case, raters 1 and 2.</span>

<span class="keyword">kappa2</span>(dat[,<span class="keyword">c</span>(<span class="number">1</span>,<span class="number">2</span>)], <span class="string">"unweighted"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: unweighted)
## 
##  Subjects = 30 
##    Raters = 2 
##     Kappa = 0.651 
## 
##         z = 7 
##   p-value = 2.63e-12</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="n-raters-fleisss-kappa-congers-kappa">
<h2>N raters: Fleiss’s Kappa, Conger’s Kappa</h2>
<p>If there are more than two raters, use Fleiss’s Kappa.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">kappam.fleiss</span>(dat)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Fleiss' Kappa for m Raters
## 
##  Subjects = 30 
##    Raters = 3 
##     Kappa = 0.534 
## 
##         z = 9.89 
##   p-value = 0</pre></td></tr></tbody></table></figure>
<p>It is also possible to use Conger’s (1980) exact Kappa. (Note that it is not clear to me when it is better or worse to use the exact method.)</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">kappam.fleiss</span>(dat, <span class="dt">exact=</span><span class="ot">TRUE</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Fleiss' Kappa for m Raters (exact value)
## 
##  Subjects = 30 
##    Raters = 3 
##     Kappa = 0.55</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="ordinal-data-weighted-kappa">
<h2>Ordinal data: weighted Kappa</h2>
<p>If the data is ordinal, then it may be appropriate to use a <strong>weighted</strong> Kappa. For example, if the possible values are low, medium, and high, then if a case were rated medium and high by the two coders, they would be in better agreement than if the ratings were low and high.</p>
<p>We will use a subset of the <code>anxiety</code> data set from the irr package.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">library</span>(irr)
<span class="keyword">data</span>(anxiety)

dfa &lt;-<span class="string"> </span>anxiety[,<span class="keyword">c</span>(<span class="number">1</span>,<span class="number">2</span>)]</pre></td></tr></tbody></table></figure>
<p>The weighted Kappa calculation must be made with 2 raters, and can use either linear or squared weights of the differences.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Compare raters 1 and 2 with squared weights</span>
<span class="keyword">kappa2</span>(dfa, <span class="string">"squared"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: squared)
## 
##  Subjects = 20 
##    Raters = 2 
##     Kappa = 0.297 
## 
##         z = 1.34 
##   p-value = 0.18</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Use linear weights</span>
<span class="keyword">kappa2</span>(dfa, <span class="string">"equal"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: equal)
## 
##  Subjects = 20 
##    Raters = 2 
##     Kappa = 0.189 
## 
##         z = 1.42 
##   p-value = 0.157</pre></td></tr></tbody></table></figure>
<p>Compare the results above to the unweighted calculation (used in the tests for non-ordinal data above), which treats all differences as the same:</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">kappa2</span>(dfa, <span class="string">"unweighted"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: unweighted)
## 
##  Subjects = 20 
##    Raters = 2 
##     Kappa = 0.119 
## 
##         z = 1.16 
##   p-value = 0.245</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="weighted-kappa-with-factors">
<h2>Weighted Kappa with factors</h2>
<p>The data above is numeric, but a weighted Kappa can also be calculated for factors. Note that the factor levels must be in the correct order, or results will be wrong.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Make a factor-ized version of the data</span>
dfa2 &lt;-<span class="string"> </span>dfa
dfa2<span class="string">$</span>rater1 &lt;-<span class="string"> </span><span class="keyword">factor</span>(dfa2<span class="string">$</span>rater1, <span class="dt">levels=</span><span class="number">1</span><span class="string">:</span><span class="number">6</span>, <span class="dt">labels=</span>LETTERS[<span class="number">1</span><span class="string">:</span><span class="number">6</span>])
dfa2<span class="string">$</span>rater2 &lt;-<span class="string"> </span><span class="keyword">factor</span>(dfa2<span class="string">$</span>rater2, <span class="dt">levels=</span><span class="number">1</span><span class="string">:</span><span class="number">6</span>, <span class="dt">labels=</span>LETTERS[<span class="number">1</span><span class="string">:</span><span class="number">6</span>])
dfa2</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##    rater1 rater2
## 1       C      C
## 2       C      F
## 3       C      D
## 4       D      F
## 5       E      B
## 6       E      D
## 7       B      B
## 8       C      D
## 9       E      C
## 10      B      C
## 11      B      B
## 12      F      C
## 13      A      C
## 14      E      C
## 15      B      B
## 16      B      B
## 17      A      A
## 18      B      C
## 19      D      C
## 20      C      D</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># The factor levels must be in the correct order:</span>
<span class="keyword">levels</span>(dfa2<span class="string">$</span>rater1)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## [1] "A" "B" "C" "D" "E" "F"</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment">#&gt; [1] "A" "B" "C" "D" "E" "F"</span>
<span class="keyword">levels</span>(dfa2<span class="string">$</span>rater2)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>## [1] "A" "B" "C" "D" "E" "F"</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment">#&gt; [1] "A" "B" "C" "D" "E" "F"</span>
<span class="comment"># The results are the same as with the numeric data, above</span>
<span class="keyword">kappa2</span>(dfa2, <span class="string">"squared"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: squared)
## 
##  Subjects = 20 
##    Raters = 2 
##     Kappa = 0.297 
## 
##         z = 1.34 
##   p-value = 0.18</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Use linear weights</span>
<span class="keyword">kappa2</span>(dfa2, <span class="string">"equal"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Cohen's Kappa for 2 Raters (Weights: equal)
## 
##  Subjects = 20 
##    Raters = 2 
##     Kappa = 0.189 
## 
##         z = 1.42 
##   p-value = 0.157</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="continuous-data-intraclass-correlation-coefficient">
<h2>Continuous data: Intraclass correlation coefficient</h2>
<p>When the variable is continuous, the intraclass correlation coefficient should be computed. From the documentation for <code>icc</code>:</p>
<p>When considering which form of ICC is appropriate for an actual set of data, one has take several decisions (Shrout &amp; Fleiss, 1979):</p>
<ol style="list-style-type: decimal">
<li>Should only the subjects be considered as random effects (<code>"oneway"</code> model, default) or are subjects and raters randomly chosen from a bigger pool of persons (<code>"twoway"</code> model).</li>
<li>If differences in judges’ mean ratings are of interest, interrater <code>"agreement"</code> instead of <code>"consistency"</code> (default) should be computed.</li>
<li>If the unit of analysis is a mean of several ratings, <code>unit</code> should be changed to <code>"average"</code>. In most cases, however, single values (<code>unit="single"</code>, default) are regarded.</li>
</ol>
<p>We will use the <code>anxiety</code> data set from the irr package.</p>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="keyword">library</span>(irr)
<span class="keyword">data</span>(anxiety)
anxiety</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##    rater1 rater2 rater3
## 1       3      3      2
## 2       3      6      1
## 3       3      4      4
## 4       4      6      4
## 5       5      2      3
## 6       5      4      2
## 7       2      2      1
## 8       3      4      6
## 9       5      3      1
## 10      2      3      1
## 11      2      2      1
## 12      6      3      2
## 13      1      3      3
## 14      5      3      3
## 15      2      2      1
## 16      2      2      1
## 17      1      1      3
## 18      2      3      3
## 19      4      3      2
## 20      3      4      2</pre></td></tr></tbody></table></figure>
<figure class="highlight R"><table><tbody><tr><td class="code"><pre class="sourceCode r"><span class="comment"># Just one of the many possible ICC coefficients</span>
<span class="keyword">icc</span>(anxiety, <span class="dt">model=</span><span class="string">"twoway"</span>, <span class="dt">type=</span><span class="string">"agreement"</span>)</pre></td></tr></tbody></table></figure>
<figure class="highlight OUTPUT"><table><tbody><tr><td class="code"><pre>##  Single Score Intraclass Correlation
## 
##    Model: twoway 
##    Type : agreement 
## 
##    Subjects = 20 
##      Raters = 3 
##    ICC(A,1) = 0.198
## 
##  F-Test, H0: r0 = 0 ; H1: r0 &gt; 0 
##  F(19,39.7) = 1.83 , p = 0.0543 
## 
##  95%-Confidence Interval for ICC Population Values:
##   -0.039 &lt; ICC &lt; 0.494</pre></td></tr></tbody></table></figure>
</div>
<div class="section level2" id="references">
<h2>REFERENCES</h2>
<p><a target="_blank" rel="noopener" href="https://stats.stackexchange.com/questions/76875/what-is-the-difference-between-mcnemars-test-and-the-chi-squared-test-and-how">What is the difference between McNemar’s test and the chi-squared test, and how do you know when to use each?</a> <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Yates's_correction_for_continuity">Yates’s correction for continuity</a> <a target="_blank" rel="noopener" href="http://www.personality-project.org/index.html">Using R for psychological research</a></p>
</div>
</div>
</section>
</div>
</div>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joaxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://u.pinsflora.xyz/Reverie/html/R_stats_tests/">https://u.pinsflora.xyz/Reverie/html/R_stats_tests/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Stats/">Stats</a><a class="post-meta__tags" href="/tags/Statistical-Test/">Statistical Test</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Reverie/R_tools/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_music_strings.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">R - Tools</div></div></a></div><div class="next-post pull-right"><a href="/Reverie/R_os/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_music_strings.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">R - OS</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/Reverie/html/R_stats_anova/" title="R ANOVA"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_anova.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2018-04-21</div><div class="title">R ANOVA</div></div></a></div><div><a href="/Reverie/html/R_stats_distribution/" title="R Distributions"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_distribution_smart_city_cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2018-04-21</div><div class="title">R Distributions</div></div></a></div><div><a href="/Reverie/html/R_stats_dirty_data/" title="R Dirty Data"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_dirty_data_wallpaper_cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2018-04-21</div><div class="title">R Dirty Data</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Joaxin</div><div class="author-info__description">When I close my eyes, I'm in my own ♡cean 🐟aves.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/joaxin"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/joaxin" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lotility@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">感謝訪問本站，若喜歡請收藏 ^_^</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#t.test"><span class="toc-number">1.</span> <span class="toc-text">T.test</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#students-t-test"><span class="toc-number">1.1.</span> <span class="toc-text">Student’s t-test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#paired-t-test"><span class="toc-number">1.2.</span> <span class="toc-text">Paired t-test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#misc"><span class="toc-number">1.3.</span> <span class="toc-text">MISC</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#frequency-tests"><span class="toc-number">2.</span> <span class="toc-text">Frequency tests</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#chi-square-test"><span class="toc-number">2.1.</span> <span class="toc-text">Chi-square test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exact-binomial-test"><span class="toc-number">2.2.</span> <span class="toc-text">exact binomial test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fishers-exact-test"><span class="toc-number">2.3.</span> <span class="toc-text">Fisher’s exact test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cochran-mantel-haenszel-test"><span class="toc-number">2.4.</span> <span class="toc-text">Cochran-Mantel-Haenszel test</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mcnemars-test"><span class="toc-number">2.5.</span> <span class="toc-text">McNemar’s test</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#homogeneity-of-variance"><span class="toc-number"></span> <span class="toc-text">Homogeneity of variance</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#bartletts-test"><span class="toc-number">1.</span> <span class="toc-text">Bartlett’s test</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#levenes-test"><span class="toc-number">2.</span> <span class="toc-text">Levene’s test</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fligner-killeen-test"><span class="toc-number">3.</span> <span class="toc-text">Fligner-Killeen test</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#inter-rater-reliability"><span class="toc-number"></span> <span class="toc-text">Inter-rater reliability</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#two-raters-cohens-kappa"><span class="toc-number">1.</span> <span class="toc-text">Two raters: Cohen’s Kappa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#n-raters-fleisss-kappa-congers-kappa"><span class="toc-number">2.</span> <span class="toc-text">N raters: Fleiss’s Kappa, Conger’s Kappa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ordinal-data-weighted-kappa"><span class="toc-number">3.</span> <span class="toc-text">Ordinal data: weighted Kappa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#weighted-kappa-with-factors"><span class="toc-number">4.</span> <span class="toc-text">Weighted Kappa with factors</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#continuous-data-intraclass-correlation-coefficient"><span class="toc-number">5.</span> <span class="toc-text">Continuous data: Intraclass correlation coefficient</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references"><span class="toc-number">6.</span> <span class="toc-text">REFERENCES</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤"><img src="https://i.postimg.cc/KYPmhV8w/android-new-logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安卓 | 装机必备清单及习惯步骤"/></a><div class="content"><a class="title" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤">安卓 | 装机必备清单及习惯步骤</a><time datetime="2020-06-20T04:29:10.462Z" title="Created 2020-06-20 12:29:10">2020-06-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - 操作图像"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像">Python - 操作图像</a><time datetime="2020-05-02T16:00:00.000Z" title="Created 2020-05-03 00:00:00">2020-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word"><img src="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - PDF &amp; Word"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word">Python - PDF &amp; Word</a><time datetime="2020-04-12T16:00:00.000Z" title="Created 2020-04-13 00:00:00">2020-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Shutil &amp; Zip"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip">Python Shutil &amp; Zip</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Subprocess"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess">Python Subprocess</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/r/R_stats_tests_.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Joaxin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Refine, the Life</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="fasle"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/fae45343.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'fae45343',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>