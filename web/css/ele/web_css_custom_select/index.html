<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CSS - Select | Pinsflora</title><meta name="keywords" content="CSS"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="Widget In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.  Design, structure, and semantics Before building a custom w">
<meta property="og:type" content="article">
<meta property="og:title" content="CSS - Select">
<meta property="og:url" content="https://u.pinsflora.xyz/Web/css/ele/web_css_custom_select/index.html">
<meta property="og:site_name" content="Pinsflora">
<meta property="og:description" content="Widget In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.  Design, structure, and semantics Before building a custom w">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg">
<meta property="article:published_time" content="2017-03-16T16:00:00.000Z">
<meta property="article:modified_time" content="2018-05-20T16:00:00.000Z">
<meta property="article:author" content="Joaxin">
<meta property="article:tag" content="CSS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg"><link rel="shortcut icon" href="/img/favicon-32x32.png"><link rel="canonical" href="https://u.pinsflora.xyz/Web/css/ele/web_css_custom_select/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2018-05-21 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">333</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">110</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">34</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CSS - Select</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2017-03-16T16:00:00.000Z" title="Created 2017-03-17 00:00:00">2017-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2018-05-20T16:00:00.000Z" title="Updated 2018-05-21 00:00:00">2018-05-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/">Web</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/CSS/">CSS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>41min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="widget"><a class="markdownIt-Anchor" href="#widget"></a> Widget</h1>
<p>In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.</p>
<h2 id="design-structure-and-semantics"><a class="markdownIt-Anchor" href="#design-structure-and-semantics"></a> Design, structure, and semantics</h2>
<p>Before building a custom widget, you should start by figuring out exactly what you want. This will save you some precious time. In particular, it’s important to clearly define all the states of your widget. To do this, it’s good to start with an existing widget whose states and behavior are well known, so that you can simply mimic those as much as possible.</p>
<p>In terms of behavior, we want our widget to be usable with a mouse as well as with a keyboard, just like any native widget. Let’s start by defining how the widget reaches each state:</p>
<ul>
<li>
<p>The widget is in its normal state when:</p>
<p>the page loads</p>
<p>the widget was active and the user clicks anywhere outside the widget</p>
<p>the widget was active and the user moves the focus to another widget using the keyboard</p>
<blockquote>
<p><strong>Note:</strong> Moving the focus around the page is usually done through hitting the tab key, but this is not standard everywhere. For example cycling through links on a page is done in Safari by default using the <a target="_blank" rel="noopener" href="http://www.456bereastreet.com/archive/200906/enabling_keyboard_navigation_in_mac_os_x_web_browsers/">Option+Tab combination</a>.</p>
</blockquote>
</li>
<li>
<p>The widget is in its active state when:</p>
<p>the user clicks on itthe user hits the tab key and it gains focus</p>
<p>the widget was in its open state and the user clicks on the widget.</p>
</li>
<li>
<p>The widget is in its open state when:</p>
<p>the widget is in any other state than open and the user clicks on it</p>
</li>
</ul>
<p>Once we know how to change states, it is important to define how to change the widget’s value:</p>
<ul>
<li>
<p>The value changes when:</p>
<p>the user clicks on an option when the widget is in the open state</p>
<p>the user hits the up or down arrow keys when the widget is in its active state</p>
</li>
</ul>
<p>Finally, let’s define how the widget’s options will behave:</p>
<ul>
<li>When the widget is opened, the selected option is highlighted</li>
<li>When the mouse is over an option, the option is highlighted and the previously highlighted option is returned to its normal state</li>
</ul>
<p>For the purposes of our example, we’ll stop with that; however, if you’re a careful reader, you’ll notice that some behaviors are missing. For example, what do you think will happen if the user hits the tab key while the widget is in its open state? The answer is… nothing. OK, the right behavior seems obvious but the fact is, because it’s not defined in our specs, it is very easy to overlook this behavior. This is especially true in a team environment when the people who design the widget’s behavior are different from the ones who implement it.</p>
<p>Another fun example: what will happen if the user hits the up or down arrow keys while the widget is in the open state? This one is a little bit trickier. If you consider that the active state and the open state are completely different, the answer is again “nothing will happen” because we did not define any keyboard interactions for the opened state. On the other hand, if you consider that the active state and the open state overlap a bit, the value may change but the option will definitely not be highlighted accordingly, once again because we did not define any keyboard interactions over options when the widget is in its opened state (we have only defined what should happen when the widget is opened, but nothing after that).</p>
<p>In our example, the missing specifications are obvious so we will handle them, but it can be a real problem on exotic new widgets, for which nobody has the slightest idea of what the right behavior is. So it’s always good to spend time in this design stage, because if you define a behavior poorly, or forget to define one, it will be very hard to redefine it once the users have gotten used to it. If you have doubts, ask for the opinions of others, and if you have the budget for it, do not hesitate to <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Usability_testing">perform user tests</a>. This process is called UX Design. If you want to learn more about this topic, you should check out the following helpful resources:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.uxmatters.com/">UXMatters.com</a></li>
<li><a target="_blank" rel="noopener" href="http://uxdesign.com/">UXDesign.com</a></li>
<li><a target="_blank" rel="noopener" href="http://uxdesign.smashingmagazine.com/">The UX Design section of SmashingMagazine</a></li>
</ul>
<p><strong>Note:</strong> Also, in most systems there is a way to open the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select"><code>select</code></a> element to look at all the available choices (this is the same as clicking the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select"><code>select</code></a> element with a mouse). This is achieved with Alt+Down arrow under Windows and was not implemented in our example —but it would be easy to do so, as the mechanism has already been implemented for the <code>click</code> event.</p>
<h3 id="creating-the-look-and-feel-using-csssection"><a class="markdownIt-Anchor" href="#creating-the-look-and-feel-using-csssection"></a> Creating the look and feel using CSS<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/How_to_build_custom_form_widgets#Creating_the_look_and_feel_using_CSS">Section</a></h3>
<p>Now that we have a structure, we can start designing our widget. The whole point of building this custom widget is to be able to style this widget exactly as we want. To that end, we will split our CSS work into two parts: the first part will be the CSS rules absolutely necessary to have our widget behave like a <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element, and the second part will consist of the fancy styles used to make it look the way we want.</p>
<h4 id="required-styles"><a class="markdownIt-Anchor" href="#required-styles"></a> Required styles</h4>
<p>The required styles are those necessary to handle the three states of our widget.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> {</span><br><span class="line">  <span class="comment">/* This will create a positioning context for the list of options */</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* This will make our widget become part of the text flow and sizable at the same time */</span></span><br><span class="line">  <span class="attribute">display </span>: inline-block;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We need an extra class <code>active</code> to define the look and feel of our widget when it is in its active state. Because our widget is focusable, we double this custom style with the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/:focus"><code>:focus</code></a> pseudo-class in order to be sure they will behave the same.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.active</span>,</span><br><span class="line"><span class="selector-class">.select</span><span class="selector-pseudo">:focus</span> {</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* This box-shadow property is not exactly required, however it's so important to be sure</span></span><br><span class="line"><span class="comment">     the active state is visible that we use it as a default value, feel free to override it. */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">3px</span> <span class="number">1px</span> <span class="number">#227755</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Now, let’s handle the list of options:</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* The .select selector here is syntactic sugar to be sure the classes we define are</span></span><br><span class="line"><span class="comment">   the ones inside our widget. */</span></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span> {</span><br><span class="line">  <span class="comment">/* This will make sure our list of options will be displayed below the value</span></span><br><span class="line"><span class="comment">     and out of the HTML flow */</span></span><br><span class="line">  <span class="attribute">position </span>: absolute;</span><br><span class="line">  <span class="attribute">top      </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left     </span>: <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We need an extra class to handle when the list of options is hidden. This is necessary in order to manage the differences between the active state and the open state that do not exactly match.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span><span class="selector-class">.hidden</span> {</span><br><span class="line">  <span class="comment">/* This is a simple way to hide the list in an accessible way, </span></span><br><span class="line"><span class="comment">     we will talk more about accessibility in the end */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="beautification"><a class="markdownIt-Anchor" href="#beautification"></a> Beautification</h4>
<p>So now that we have the basic functionality in place, the fun can start. The following is just an example of what is possible, and will match the screenshot at the beginning of this article. However, you should feel free to experiment and see what you can come up with.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> {</span><br><span class="line">  <span class="comment">/* All sizes will be expressed with the em value for accessibility reasons</span></span><br><span class="line"><span class="comment">     (to make sure the widget remains resizable if the user uses the  </span></span><br><span class="line"><span class="comment">     browser's zoom in a text-only mode). The computations are made</span></span><br><span class="line"><span class="comment">     assuming 1em == 16px which is the default value in most browsers.</span></span><br><span class="line"><span class="comment">     If you are lost with px to em conversion, try http://riddle.pl/emcalc/ */</span></span><br><span class="line">  <span class="attribute">font-size   </span>: <span class="number">0.625em</span>; <span class="comment">/* this (10px) is the new font size context for em value in this context */</span></span><br><span class="line">  <span class="attribute">font-family </span>: Verdana, Arial, sans-serif;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* We need extra room for the down arrow we will add */</span></span><br><span class="line">  <span class="attribute">padding </span>: .<span class="number">1em</span> <span class="number">2.5em</span> .<span class="number">2em</span> .<span class="number">5em</span>; <span class="comment">/* 1px 25px 2px 5px */</span></span><br><span class="line">  <span class="attribute">width   </span>: <span class="number">10em</span>; <span class="comment">/* 100px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">border        </span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-radius </span>: .<span class="number">4em</span>; <span class="comment">/* 4px */</span></span><br><span class="line">  <span class="attribute">box-shadow    </span>: <span class="number">0</span> .<span class="number">1em</span> .<span class="number">2em</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">45</span>); <span class="comment">/* 0 1px 2px */</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* The first declaration is for browsers that do not support linear gradients.</span></span><br><span class="line"><span class="comment">     The second declaration is because WebKit based browsers haven't unprefixed it yet.</span></span><br><span class="line"><span class="comment">     If you want to support legacy browsers, try http://www.colorzilla.com/gradient-editor/ */</span></span><br><span class="line">  <span class="attribute">background </span>: <span class="number">#F0F0F0</span>;</span><br><span class="line">  <span class="attribute">background </span>: <span class="built_in">-webkit-linear-gradient</span>(<span class="number">90deg</span>, #E3E3E3, #fcfcfc <span class="number">50%</span>, #f0f0f0);</span><br><span class="line">  <span class="attribute">background </span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>, #E3E3E3, #fcfcfc <span class="number">50%</span>, #f0f0f0);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.value</span> {</span><br><span class="line">  <span class="comment">/* Because the value can be wider than our widget, we have to make sure it will not</span></span><br><span class="line"><span class="comment">     change the widget's width */</span></span><br><span class="line">  <span class="attribute">display  </span>: inline-block;</span><br><span class="line">  <span class="attribute">width    </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow </span>: hidden;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">vertical-align</span>: top;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* And if the content overflows, it's better to have a nice ellipsis. */</span></span><br><span class="line">  <span class="attribute">white-space  </span>: nowrap;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We don’t need an extra element to design the down arrow; instead, we’re using the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/:after"><code>:after</code></a>pseudo-element. However, it could also be implemented using a simple background image on the <code>select</code> class.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span><span class="selector-pseudo">:after</span> {</span><br><span class="line">  <span class="attribute">content </span>: <span class="string">"▼"</span>; <span class="comment">/* We use the unicode character U+25BC; see http://www.utf8-chartable.de */</span></span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index </span>: <span class="number">1</span>; <span class="comment">/* This will be important to keep the arrow from overlapping the list of options */</span></span><br><span class="line">  <span class="attribute">top     </span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right   </span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">height  </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width   </span>: <span class="number">2em</span>;  <span class="comment">/* 20px */</span></span><br><span class="line">  <span class="attribute">padding-top </span>: .<span class="number">1em</span>; <span class="comment">/* 1px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-left  </span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0</span> .<span class="number">1em</span> .<span class="number">1em</span> <span class="number">0</span>;  <span class="comment">/* 0 1px 1px 0 */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color </span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color </span>: <span class="number">#FFF</span>;</span><br><span class="line">  <span class="attribute">text-align </span>: center;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Next, let’s style the list of options:</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span> {</span><br><span class="line">  <span class="attribute">z-index </span>: <span class="number">2</span>; <span class="comment">/* We explicitly said the list of options will always overlap the down arrow */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* this will reset the default style of the ul element */</span></span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">margin </span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* This will ensure that even if the values are smaller than the widget,</span></span><br><span class="line"><span class="comment">     the list of options will be as large as the widget itself */</span></span><br><span class="line">  <span class="attribute">min-width </span>: <span class="number">100%</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* In case the list is too long, its content will overflow vertically </span></span><br><span class="line"><span class="comment">     (which will add a vertical scrollbar automatically) but never horizontally </span></span><br><span class="line"><span class="comment">     (because we haven't set a width, the list will adjust its width automatically. </span></span><br><span class="line"><span class="comment">     If it can't, the content will be truncated) */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">10em</span>; <span class="comment">/* 100px */</span></span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-top-width </span>: .<span class="number">1em</span>; <span class="comment">/* 1px */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">0</span> .<span class="number">4em</span> .<span class="number">4em</span>; <span class="comment">/* 0 0 4px 4px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> .<span class="number">2em</span> .<span class="number">4em</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">4</span>); <span class="comment">/* 0 2px 4px */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>For the options, we need to add a <code>highlight</code> class to be able to identify the value the user will pick (or has picked).</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.option</span> {</span><br><span class="line">  <span class="attribute">padding</span>: .<span class="number">2em</span> .<span class="number">3em</span>; <span class="comment">/* 2px 3px */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.highlight</span> {</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="bring-your-widget-to-life-with-javascript"><a class="markdownIt-Anchor" href="#bring-your-widget-to-life-with-javascript"></a> Bring your widget to life with JavaScript</h2>
<p>Now that our design and structure are ready, we can write the JavaScript code to make the widget actually work.</p>
<p><strong>Warning:</strong> The following code is educational and should not be used as-is. Among many things, as we’ll see, it is not future-proof and it will not work on legacy browsers. It also has redundant parts that should be optimized in production code.</p>
<p><strong>Note:</strong> Creating reusable widgets is something that can be a bit tricky. The <a target="_blank" rel="noopener" href="http://dvcs.w3.org/hg/webcomponents/raw-file/tip/explainer/index.html">W3C Web Component draft</a> is one of the answers to this specific issue. <a target="_blank" rel="noopener" href="http://x-tags.org/">The X-Tag project</a> is a test implementation of this specification; we encourage you to take a look at it.</p>
<h3 id="why-isnt-it-working"><a class="markdownIt-Anchor" href="#why-isnt-it-working"></a> Why isn’t it working?</h3>
<p>Before we start, it’s important to remember something very important about JavaScript: inside a browser, <strong>it’s an unreliable technology</strong>. When you are building custom widgets, you’ll have to rely on JavaScript because it’s a necessary thread to tie everything together. However, there are many cases in which JavaScript isn’t able to run in the browser:</p>
<ul>
<li>The user has turned off JavaScript: This is the most unusual case ever; very few people turn off JavaScript nowadays.</li>
<li>The script is not loading. This is one of the most common cases, especially in the mobile world where the network is not very reliable.</li>
<li>The script is buggy. You should always consider this possibility.</li>
<li>The script is in conflict with a third party script. This can happen with tracking scripts or any bookmarklets the user uses.</li>
<li>The script is in conflict with, or is affected by, a browser extension (such as Firefox’s <a target="_blank" rel="noopener" href="https://addons.mozilla.org/fr/firefox/addon/noscript/">NoScript</a> extension or Chrome’s <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/notscripts/odjhifogjcknibkahlpidmdajjpkkcfn">NotScripts</a> extension).</li>
<li>The user is using a legacy browser, and one of the features you require is not supported. This will happen frequently when you make use of cutting-edge APIs.</li>
</ul>
<p>Because of these risks, it’s really important to seriously consider what will happen if JavaScript isn’t working. Dealing in detail with this issue is out of the scope of this article because it’s closely linked to how you want to make your script generic and reusable, but we’ll consider the basics of this in our example.</p>
<p>In our example, if our JavaScript code isn’t running, we’ll fall back to displaying a standard <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element. To achieve this, we need two things.</p>
<p>First, we need to add a regular <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element before each use of our custom widget. This is actually also required in order to be able to send data from our custom widget along with the rest of our form data; more about this later.</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"no-widget"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"myFruit"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Lemon<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Strawberry<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"