<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CSS - Select | Pinsflora</title><meta name="description" content="Widget In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.  Design, structure, and semantics Before building a custom w"><meta name="keywords" content="CSS"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://u.pinsflora.com/web/css/ele/web_css_custom_select/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="CSS - Select"><meta property="og:url" content="https://u.pinsflora.com/web/css/ele/web_css_custom_select/"><meta property="og:site_name" content="Pinsflora"><meta property="og:description" content="Widget In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.  Design, structure, and semantics Before building a custom w"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg"><meta property="article:published_time" content="2017-03-16T16:00:00.000Z"><meta property="article:modified_time" content="2018-05-20T16:00:00.000Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime: 'days',
  date_suffix: {"one_hour":"Just","hours":"hours ago","day":"days ago"},
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
    },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2018-05-21 00:00:00'
}</script><noscript><style type="text/css">
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">274</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">99</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">34</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#widget"><span class="toc-number">1.</span> <span class="toc-text"> Widget</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#design-structure-and-semantics"><span class="toc-number">1.1.</span> <span class="toc-text"> Design, structure, and semantics</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#creating-the-look-and-feel-using-csssection"><span class="toc-number">1.1.1.</span> <span class="toc-text"> Creating the look and feel using CSSSection</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#required-styles"><span class="toc-number">1.1.1.1.</span> <span class="toc-text"> Required styles</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#beautification"><span class="toc-number">1.1.1.2.</span> <span class="toc-text"> Beautification</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bring-your-widget-to-life-with-javascript"><span class="toc-number">1.2.</span> <span class="toc-text"> Bring your widget to life with JavaScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#why-isnt-it-working"><span class="toc-number">1.2.1.</span> <span class="toc-text"> Why isn’t it working?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#making-the-job-easiersection"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Making the job easierSection</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#building-event-callbacks"><span class="toc-number">1.2.3.</span> <span class="toc-text"> Building event callbacks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#handling-the-widgets-value"><span class="toc-number">1.2.4.</span> <span class="toc-text"> Handling the widget’s value</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#make-it-accessible"><span class="toc-number">1.3.</span> <span class="toc-text"> Make it accessible</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-role-attribute"><span class="toc-number">1.3.1.</span> <span class="toc-text"> The role attribute</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-aria-selected-attributesection"><span class="toc-number">1.3.2.</span> <span class="toc-text"> The aria-selected attributeSection</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#conclusion"><span class="toc-number">1.4.</span> <span class="toc-text"> Conclusion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#html-forms-in-legacy-browsers"><span class="toc-number">1.5.</span> <span class="toc-text"> HTML forms in legacy browsers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#learn-about-the-issues"><span class="toc-number">1.6.</span> <span class="toc-text"> Learn about the issues</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#browser-vendor-documentation"><span class="toc-number">1.6.1.</span> <span class="toc-text"> Browser vendor documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#independent-documentation"><span class="toc-number">1.6.2.</span> <span class="toc-text"> Independent documentation</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#make-things-simple"><span class="toc-number">1.7.</span> <span class="toc-text"> Make things simple</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#graceful-degradation-is-web-developers-best-friend"><span class="toc-number">1.7.1.</span> <span class="toc-text"> Graceful degradation is web developer’s best friend</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#html-input-types"><span class="toc-number">1.7.1.1.</span> <span class="toc-text"> HTML input types</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#css-attribute-selectors"><span class="toc-number">1.7.1.2.</span> <span class="toc-text"> CSS Attribute Selectors</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#form-buttons"><span class="toc-number">1.7.1.3.</span> <span class="toc-text"> Form buttons</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#let-go-of-css"><span class="toc-number">1.7.2.</span> <span class="toc-text"> Let go of CSS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#feature-detection-and-polyfills"><span class="toc-number">1.8.</span> <span class="toc-text"> Feature detection and polyfills</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unobtrusive-javascript"><span class="toc-number">1.8.1.</span> <span class="toc-text"> Unobtrusive JavaScript</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#the-modernizr-library"><span class="toc-number">1.8.2.</span> <span class="toc-text"> The Modernizr library</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pay-attention-to-performance"><span class="toc-number">1.8.3.</span> <span class="toc-text"> Pay attention to performance</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#references"><span class="toc-number">1.8.4.</span> <span class="toc-text"> REFERENCES</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fa fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">CSS - Select</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2017-03-16T16:00:00.000Z" title="Created 2017-03-17 00:00:00">2017-03-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2018-05-20T16:00:00.000Z" title="Updated 2018-05-21 00:00:00">2018-05-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/">Web</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web/CSS/">CSS</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>41min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="widget"><a class="markdownIt-Anchor" href="#widget"></a> Widget</h1>
<p>In this article, we will see how to build such a widget. To that end, we will work with an example: rebuilding the(select) element.</p>
<h2 id="design-structure-and-semantics"><a class="markdownIt-Anchor" href="#design-structure-and-semantics"></a> Design, structure, and semantics</h2>
<p>Before building a custom widget, you should start by figuring out exactly what you want. This will save you some precious time. In particular, it’s important to clearly define all the states of your widget. To do this, it’s good to start with an existing widget whose states and behavior are well known, so that you can simply mimic those as much as possible.</p>
<p>In terms of behavior, we want our widget to be usable with a mouse as well as with a keyboard, just like any native widget. Let’s start by defining how the widget reaches each state:</p>
<ul>
<li>
<p>The widget is in its normal state when:</p>
<p>the page loads</p>
<p>the widget was active and the user clicks anywhere outside the widget</p>
<p>the widget was active and the user moves the focus to another widget using the keyboard</p>
<blockquote>
<p><strong>Note:</strong> Moving the focus around the page is usually done through hitting the tab key, but this is not standard everywhere. For example cycling through links on a page is done in Safari by default using the <a target="_blank" rel="noopener" href="http://www.456bereastreet.com/archive/200906/enabling_keyboard_navigation_in_mac_os_x_web_browsers/">Option+Tab combination</a>.</p>
</blockquote>
</li>
<li>
<p>The widget is in its active state when:</p>
<p>the user clicks on itthe user hits the tab key and it gains focus</p>
<p>the widget was in its open state and the user clicks on the widget.</p>
</li>
<li>
<p>The widget is in its open state when:</p>
<p>the widget is in any other state than open and the user clicks on it</p>
</li>
</ul>
<p>Once we know how to change states, it is important to define how to change the widget’s value:</p>
<ul>
<li>
<p>The value changes when:</p>
<p>the user clicks on an option when the widget is in the open state</p>
<p>the user hits the up or down arrow keys when the widget is in its active state</p>
</li>
</ul>
<p>Finally, let’s define how the widget’s options will behave:</p>
<ul>
<li>When the widget is opened, the selected option is highlighted</li>
<li>When the mouse is over an option, the option is highlighted and the previously highlighted option is returned to its normal state</li>
</ul>
<p>For the purposes of our example, we’ll stop with that; however, if you’re a careful reader, you’ll notice that some behaviors are missing. For example, what do you think will happen if the user hits the tab key while the widget is in its open state? The answer is… nothing. OK, the right behavior seems obvious but the fact is, because it’s not defined in our specs, it is very easy to overlook this behavior. This is especially true in a team environment when the people who design the widget’s behavior are different from the ones who implement it.</p>
<p>Another fun example: what will happen if the user hits the up or down arrow keys while the widget is in the open state? This one is a little bit trickier. If you consider that the active state and the open state are completely different, the answer is again “nothing will happen” because we did not define any keyboard interactions for the opened state. On the other hand, if you consider that the active state and the open state overlap a bit, the value may change but the option will definitely not be highlighted accordingly, once again because we did not define any keyboard interactions over options when the widget is in its opened state (we have only defined what should happen when the widget is opened, but nothing after that).</p>
<p>In our example, the missing specifications are obvious so we will handle them, but it can be a real problem on exotic new widgets, for which nobody has the slightest idea of what the right behavior is. So it’s always good to spend time in this design stage, because if you define a behavior poorly, or forget to define one, it will be very hard to redefine it once the users have gotten used to it. If you have doubts, ask for the opinions of others, and if you have the budget for it, do not hesitate to <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Usability_testing">perform user tests</a>. This process is called UX Design. If you want to learn more about this topic, you should check out the following helpful resources:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.uxmatters.com/">UXMatters.com</a></li>
<li><a target="_blank" rel="noopener" href="http://uxdesign.com/">UXDesign.com</a></li>
<li><a target="_blank" rel="noopener" href="http://uxdesign.smashingmagazine.com/">The UX Design section of SmashingMagazine</a></li>
</ul>
<p><strong>Note:</strong> Also, in most systems there is a way to open the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select"><code>select</code></a> element to look at all the available choices (this is the same as clicking the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select"><code>select</code></a> element with a mouse). This is achieved with Alt+Down arrow under Windows and was not implemented in our example —but it would be easy to do so, as the mechanism has already been implemented for the <code>click</code> event.</p>
<h3 id="creating-the-look-and-feel-using-csssection"><a class="markdownIt-Anchor" href="#creating-the-look-and-feel-using-csssection"></a> Creating the look and feel using CSS<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/How_to_build_custom_form_widgets#Creating_the_look_and_feel_using_CSS">Section</a></h3>
<p>Now that we have a structure, we can start designing our widget. The whole point of building this custom widget is to be able to style this widget exactly as we want. To that end, we will split our CSS work into two parts: the first part will be the CSS rules absolutely necessary to have our widget behave like a <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element, and the second part will consist of the fancy styles used to make it look the way we want.</p>
<h4 id="required-styles"><a class="markdownIt-Anchor" href="#required-styles"></a> Required styles</h4>
<p>The required styles are those necessary to handle the three states of our widget.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> {</span><br><span class="line">  <span class="comment">/* This will create a positioning context for the list of options */</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* This will make our widget become part of the text flow and sizable at the same time */</span></span><br><span class="line">  <span class="attribute">display </span>: inline-block;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We need an extra class <code>active</code> to define the look and feel of our widget when it is in its active state. Because our widget is focusable, we double this custom style with the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/:focus"><code>:focus</code></a> pseudo-class in order to be sure they will behave the same.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.active</span>,</span><br><span class="line"><span class="selector-class">.select</span><span class="selector-pseudo">:focus</span> {</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">/* This box-shadow property is not exactly required, however it's so important to be sure</span></span><br><span class="line"><span class="comment">     the active state is visible that we use it as a default value, feel free to override it. */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">3px</span> <span class="number">1px</span> <span class="number">#227755</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Now, let’s handle the list of options:</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* The .select selector here is syntactic sugar to be sure the classes we define are</span></span><br><span class="line"><span class="comment">   the ones inside our widget. */</span></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span> {</span><br><span class="line">  <span class="comment">/* This will make sure our list of options will be displayed below the value</span></span><br><span class="line"><span class="comment">     and out of the HTML flow */</span></span><br><span class="line">  <span class="attribute">position </span>: absolute;</span><br><span class="line">  <span class="attribute">top      </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left     </span>: <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We need an extra class to handle when the list of options is hidden. This is necessary in order to manage the differences between the active state and the open state that do not exactly match.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span><span class="selector-class">.hidden</span> {</span><br><span class="line">  <span class="comment">/* This is a simple way to hide the list in an accessible way, </span></span><br><span class="line"><span class="comment">     we will talk more about accessibility in the end */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="beautification"><a class="markdownIt-Anchor" href="#beautification"></a> Beautification</h4>
<p>So now that we have the basic functionality in place, the fun can start. The following is just an example of what is possible, and will match the screenshot at the beginning of this article. However, you should feel free to experiment and see what you can come up with.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> {</span><br><span class="line">  <span class="comment">/* All sizes will be expressed with the em value for accessibility reasons</span></span><br><span class="line"><span class="comment">     (to make sure the widget remains resizable if the user uses the  </span></span><br><span class="line"><span class="comment">     browser's zoom in a text-only mode). The computations are made</span></span><br><span class="line"><span class="comment">     assuming 1em == 16px which is the default value in most browsers.</span></span><br><span class="line"><span class="comment">     If you are lost with px to em conversion, try http://riddle.pl/emcalc/ */</span></span><br><span class="line">  <span class="attribute">font-size   </span>: <span class="number">0.625em</span>; <span class="comment">/* this (10px) is the new font size context for em value in this context */</span></span><br><span class="line">  <span class="attribute">font-family </span>: Verdana, Arial, sans-serif;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* We need extra room for the down arrow we will add */</span></span><br><span class="line">  <span class="attribute">padding </span>: .<span class="number">1em</span> <span class="number">2.5em</span> .<span class="number">2em</span> .<span class="number">5em</span>; <span class="comment">/* 1px 25px 2px 5px */</span></span><br><span class="line">  <span class="attribute">width   </span>: <span class="number">10em</span>; <span class="comment">/* 100px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">border        </span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-radius </span>: .<span class="number">4em</span>; <span class="comment">/* 4px */</span></span><br><span class="line">  <span class="attribute">box-shadow    </span>: <span class="number">0</span> .<span class="number">1em</span> .<span class="number">2em</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">45</span>); <span class="comment">/* 0 1px 2px */</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">/* The first declaration is for browsers that do not support linear gradients.</span></span><br><span class="line"><span class="comment">     The second declaration is because WebKit based browsers haven't unprefixed it yet.</span></span><br><span class="line"><span class="comment">     If you want to support legacy browsers, try http://www.colorzilla.com/gradient-editor/ */</span></span><br><span class="line">  <span class="attribute">background </span>: <span class="number">#F0F0F0</span>;</span><br><span class="line">  <span class="attribute">background </span>: <span class="built_in">-webkit-linear-gradient</span>(<span class="number">90deg</span>, #E3E3E3, #fcfcfc <span class="number">50%</span>, #f0f0f0);</span><br><span class="line">  <span class="attribute">background </span>: <span class="built_in">linear-gradient</span>(<span class="number">0deg</span>, #E3E3E3, #fcfcfc <span class="number">50%</span>, #f0f0f0);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.value</span> {</span><br><span class="line">  <span class="comment">/* Because the value can be wider than our widget, we have to make sure it will not</span></span><br><span class="line"><span class="comment">     change the widget's width */</span></span><br><span class="line">  <span class="attribute">display  </span>: inline-block;</span><br><span class="line">  <span class="attribute">width    </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">overflow </span>: hidden;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">vertical-align</span>: top;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* And if the content overflows, it's better to have a nice ellipsis. */</span></span><br><span class="line">  <span class="attribute">white-space  </span>: nowrap;</span><br><span class="line">  <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We don’t need an extra element to design the down arrow; instead, we’re using the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/:after"><code>:after</code></a>pseudo-element. However, it could also be implemented using a simple background image on the <code>select</code> class.</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span><span class="selector-pseudo">:after</span> {</span><br><span class="line">  <span class="attribute">content </span>: <span class="string">"▼"</span>; <span class="comment">/* We use the unicode character U+25BC; see http://www.utf8-chartable.de */</span></span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">z-index </span>: <span class="number">1</span>; <span class="comment">/* This will be important to keep the arrow from overlapping the list of options */</span></span><br><span class="line">  <span class="attribute">top     </span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">right   </span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">height  </span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width   </span>: <span class="number">2em</span>;  <span class="comment">/* 20px */</span></span><br><span class="line">  <span class="attribute">padding-top </span>: .<span class="number">1em</span>; <span class="comment">/* 1px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">border-left  </span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0</span> .<span class="number">1em</span> .<span class="number">1em</span> <span class="number">0</span>;  <span class="comment">/* 0 1px 1px 0 */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">background-color </span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color </span>: <span class="number">#FFF</span>;</span><br><span class="line">  <span class="attribute">text-align </span>: center;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Next, let’s style the list of options:</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.optList</span> {</span><br><span class="line">  <span class="attribute">z-index </span>: <span class="number">2</span>; <span class="comment">/* We explicitly said the list of options will always overlap the down arrow */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* this will reset the default style of the ul element */</span></span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">margin </span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">-moz-box-sizing </span>: border-box;</span><br><span class="line">  <span class="attribute">box-sizing </span>: border-box;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* This will ensure that even if the values are smaller than the widget,</span></span><br><span class="line"><span class="comment">     the list of options will be as large as the widget itself */</span></span><br><span class="line">  <span class="attribute">min-width </span>: <span class="number">100%</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* In case the list is too long, its content will overflow vertically </span></span><br><span class="line"><span class="comment">     (which will add a vertical scrollbar automatically) but never horizontally </span></span><br><span class="line"><span class="comment">     (because we haven't set a width, the list will adjust its width automatically. </span></span><br><span class="line"><span class="comment">     If it can't, the content will be truncated) */</span></span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">10em</span>; <span class="comment">/* 100px */</span></span><br><span class="line">  <span class="attribute">overflow-y</span>: auto;</span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line"></span><br><span class="line">  <span class="attribute">border</span>: .<span class="number">2em</span> solid <span class="number">#000</span>; <span class="comment">/* 2px */</span></span><br><span class="line">  <span class="attribute">border-top-width </span>: .<span class="number">1em</span>; <span class="comment">/* 1px */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0</span> <span class="number">0</span> .<span class="number">4em</span> .<span class="number">4em</span>; <span class="comment">/* 0 0 4px 4px */</span></span><br><span class="line"></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> .<span class="number">2em</span> .<span class="number">4em</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">4</span>); <span class="comment">/* 0 2px 4px */</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#f0f0f0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>For the options, we need to add a <code>highlight</code> class to be able to identify the value the user will pick (or has picked).</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.option</span> {</span><br><span class="line">  <span class="attribute">padding</span>: .<span class="number">2em</span> .<span class="number">3em</span>; <span class="comment">/* 2px 3px */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.select</span> <span class="selector-class">.highlight</span> {</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FFFFFF</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h2 id="bring-your-widget-to-life-with-javascript"><a class="markdownIt-Anchor" href="#bring-your-widget-to-life-with-javascript"></a> Bring your widget to life with JavaScript</h2>
<p>Now that our design and structure are ready, we can write the JavaScript code to make the widget actually work.</p>
<p><strong>Warning:</strong> The following code is educational and should not be used as-is. Among many things, as we’ll see, it is not future-proof and it will not work on legacy browsers. It also has redundant parts that should be optimized in production code.</p>
<p><strong>Note:</strong> Creating reusable widgets is something that can be a bit tricky. The <a target="_blank" rel="noopener" href="http://dvcs.w3.org/hg/webcomponents/raw-file/tip/explainer/index.html">W3C Web Component draft</a> is one of the answers to this specific issue. <a target="_blank" rel="noopener" href="http://x-tags.org/">The X-Tag project</a> is a test implementation of this specification; we encourage you to take a look at it.</p>
<h3 id="why-isnt-it-working"><a class="markdownIt-Anchor" href="#why-isnt-it-working"></a> Why isn’t it working?</h3>
<p>Before we start, it’s important to remember something very important about JavaScript: inside a browser, <strong>it’s an unreliable technology</strong>. When you are building custom widgets, you’ll have to rely on JavaScript because it’s a necessary thread to tie everything together. However, there are many cases in which JavaScript isn’t able to run in the browser:</p>
<ul>
<li>The user has turned off JavaScript: This is the most unusual case ever; very few people turn off JavaScript nowadays.</li>
<li>The script is not loading. This is one of the most common cases, especially in the mobile world where the network is not very reliable.</li>
<li>The script is buggy. You should always consider this possibility.</li>
<li>The script is in conflict with a third party script. This can happen with tracking scripts or any bookmarklets the user uses.</li>
<li>The script is in conflict with, or is affected by, a browser extension (such as Firefox’s <a target="_blank" rel="noopener" href="https://addons.mozilla.org/fr/firefox/addon/noscript/">NoScript</a> extension or Chrome’s <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/notscripts/odjhifogjcknibkahlpidmdajjpkkcfn">NotScripts</a> extension).</li>
<li>The user is using a legacy browser, and one of the features you require is not supported. This will happen frequently when you make use of cutting-edge APIs.</li>
</ul>
<p>Because of these risks, it’s really important to seriously consider what will happen if JavaScript isn’t working. Dealing in detail with this issue is out of the scope of this article because it’s closely linked to how you want to make your script generic and reusable, but we’ll consider the basics of this in our example.</p>
<p>In our example, if our JavaScript code isn’t running, we’ll fall back to displaying a standard <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element. To achieve this, we need two things.</p>
<p>First, we need to add a regular <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element before each use of our custom widget. This is actually also required in order to be able to send data from our custom widget along with the rest of our form data; more about this later.</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"no-widget"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">"myFruit"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Lemon<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Strawberry<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"value"</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"optList hidden"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Lemon<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Strawberry<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Second, we need two new classes to let us hide the unneeded element (that is, the “real” <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element if our script isn’t running, or the custom widget if it is running). Note that by default, our HTML code hides our custom widget.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.widget select,</span><br><span class="line">.no-widget .select {</span><br><span class="line">  /* This CSS selector basically says:</span><br><span class="line">     - either we have set the body class to "widget" and thus we hide the actual &lt;select&gt; element</span><br><span class="line">     - or we have not changed the body class, therefore the body class is still "no-widget",</span><br><span class="line">       so the elements whose class is "select" must be hidden */</span><br><span class="line">  position : absolute;</span><br><span class="line">  left     : -5000em;</span><br><span class="line">  height   : 0;</span><br><span class="line">  overflow : hidden;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Now we just need a JavaScript switch to determine if the script is running or not. This switch is very simple: if at page load time our script is running, it will remove the <code>no-widget</code> class and add the <code>widget</code> class, thereby swapping the visibility of the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select">``</a> element and of the custom widget.</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"load"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="built_in">document</span>.body.classList.remove(<span class="string">"no-widget"</span>);</span><br><span class="line">  <span class="built_in">document</span>.body.classList.add(<span class="string">"widget"</span>);</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Note:</strong> If you really want to make your code generic and reusable, instead of doing a class switch it’s far better to just add the widget class to hide the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select"><code>](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/select) elements, and to dynamically add the DOM tree representing the custom widget after every [</code></a>element in the page.</p>
<h3 id="making-the-job-easiersection"><a class="markdownIt-Anchor" href="#making-the-job-easiersection"></a> Making the job easier<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/How_to_build_custom_form_widgets#Making_the_job_easier">Section</a></h3>
<p>In the code we are about to build, we will use the standard DOM API to do all the work we need. However, although DOM API support has gotten much better in browsers, there are always issues with legacy browsers (especially with good old Internet Explorer).</p>
<p>If you want to avoid trouble with legacy browsers, there are two ways to do so: using a dedicated framework such as <a target="_blank" rel="noopener" href="http://jquery.com/">jQuery</a>, <a target="_blank" rel="noopener" href="https://github.com/julienw/dollardom">$dom</a>, <a target="_blank" rel="noopener" href="http://prototypejs.org/">prototype</a>, <a target="_blank" rel="noopener" href="http://dojotoolkit.org/">Dojo</a>, <a target="_blank" rel="noopener" href="http://yuilibrary.com/">YUI</a>, or the like, or by polyfilling the missing feature you want to use (which can easily be done through conditional loading, with the <a target="_blank" rel="noopener" href="http://yepnopejs.com/">yepnope</a> library for example).</p>
<p>The features we plan to use are the following (ordered from the riskiest to the safest):</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/classList"><code>classList</code></a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener"><code>addEventListener</code></a></li>
<li><code>forEach</code> (This is not DOM but modern JavaScript)</li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelector"><code>querySelector</code></a> and <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelectorAll"><code>querySelectorAll</code></a></li>
</ol>
<p>Beyond the availability of those specific features, there is still one issue remaining before starting. The object returned by the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Element/querySelectorAll"><code>querySelectorAll()</code></a> function is a <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList"><code>NodeList</code></a> rather than an <code>Array</code>. This is important because <code>Array</code> objects support the <code>forEach</code> function, but <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList"><code>NodeList</code></a> doesn’t. Because <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList"><code>NodeList</code></a> really looks like an <code>Array</code> and because <code>forEach</code> is so convenient to use, we can easily add the support of <code>forEach</code> to <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/NodeList"><code>NodeList</code></a> in order to make our life easier, like so:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">NodeList.prototype.forEach = <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>{</span><br><span class="line">  <span class="built_in">Array</span>.prototype.forEach.call(<span class="built_in">this</span>, callback);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>We weren’t kidding when we said it’s easy to do.</p>
<h3 id="building-event-callbacks"><a class="markdownIt-Anchor" href="#building-event-callbacks"></a> Building event callbacks</h3>
<p>The ground is ready, we can now start to define all the functions that will be used each time the user interacts with our widget.</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function will be used each time we want to deactivate a custom widget</span></span><br><span class="line"><span class="comment">// It takes one parameter</span></span><br><span class="line"><span class="comment">// select : the DOM node with the `select` class to deactivate</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deactivateSelect</span>(<span class="params">select</span>) </span>{</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If the widget is not active there is nothing to do</span></span><br><span class="line">  <span class="keyword">if</span> (!select.classList.contains(<span class="string">'active'</span>)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We need to get the list of options for the custom widget</span></span><br><span class="line">  <span class="keyword">var</span> optList = select.querySelector(<span class="string">'.optList'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We close the list of option</span></span><br><span class="line">  optList.classList.add(<span class="string">'hidden'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// and we deactivate the custom widget itself</span></span><br><span class="line">  select.classList.remove(<span class="string">'active'</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function will be used each time the user wants to (de)activate the widget</span></span><br><span class="line"><span class="comment">// It takes two parameters:</span></span><br><span class="line"><span class="comment">// select : the DOM node with the `select` class to activate</span></span><br><span class="line"><span class="comment">// selectList : the list of all the DOM nodes with the `select` class</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">activeSelect</span>(<span class="params">select, selectList</span>) </span>{</span><br><span class="line"></span><br><span class="line">  <span class="comment">// If the widget is already active there is nothing to do</span></span><br><span class="line">  <span class="keyword">if</span> (select.classList.contains(<span class="string">'active'</span>)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We have to turn off the active state on all custom widgets</span></span><br><span class="line">  <span class="comment">// Because the deactivateSelect function fulfill all the requirement of the</span></span><br><span class="line">  <span class="comment">// forEach callback function, we use it directly without using an intermediate</span></span><br><span class="line">  <span class="comment">// anonymous function.</span></span><br><span class="line">  selectList.forEach(deactivateSelect);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// And we turn on the active state for this specific widget</span></span><br><span class="line">  select.classList.add(<span class="string">'active'</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function will be used each time the user wants to open/closed the list of options</span></span><br><span class="line"><span class="comment">// It takes one parameter:</span></span><br><span class="line"><span class="comment">// select : the DOM node with the list to toggle</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toggleOptList</span>(<span class="params">select</span>) </span>{</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The list is kept from the widget</span></span><br><span class="line">  <span class="keyword">var</span> optList = select.querySelector(<span class="string">'.optList'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We change the class of the list to show/hide it</span></span><br><span class="line">  optList.classList.toggle(<span class="string">'hidden'</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function will be used each time we need to highlight an option</span></span><br><span class="line"><span class="comment">// It takes two parameters:</span></span><br><span class="line"><span class="comment">// select : the DOM node with the `select` class containing the option to highlight</span></span><br><span class="line"><span class="comment">// option : the DOM node with the `option` class to highlight</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">highlightOption</span>(<span class="params">select, option</span>) </span>{</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We get the list of all option available for our custom select element</span></span><br><span class="line">  <span class="keyword">var</span> optionList = select.querySelectorAll(<span class="string">'.option'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We remove the highlight from all options</span></span><br><span class="line">  optionList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">other</span>) </span>{</span><br><span class="line">    other.classList.remove(<span class="string">'highlight'</span>);</span><br><span class="line">  });</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We highlight the right option</span></span><br><span class="line">  option.classList.add(<span class="string">'highlight'</span>);</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>That’s all you need in order to handle the various states of the custom widget.</p>
<p>Next, we bind these functions to the appropriate events:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// We handle the event binding when the document is loaded.</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> selectList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.select'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Each custom widget needs to be initialized</span></span><br><span class="line">  selectList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">select</span>) </span>{</span><br><span class="line"></span><br><span class="line">    <span class="comment">// as well as all its `option` elements</span></span><br><span class="line">    <span class="keyword">var</span> optionList = select.querySelectorAll(<span class="string">'.option'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each time a user hovers their mouse over an option, we highlight the given option</span></span><br><span class="line">    optionList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">option</span>) </span>{</span><br><span class="line">      option.addEventListener(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">        <span class="comment">// Note: the `select` and `option` variable are closures</span></span><br><span class="line">        <span class="comment">// available in the scope of our function call.</span></span><br><span class="line">        highlightOption(select, option);</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each times the user click on a custom select element</span></span><br><span class="line">    select.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">      <span class="comment">// Note: the `select` variable is a closure</span></span><br><span class="line">      <span class="comment">// available in the scope of our function call.</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// We toggle the visibility of the list of options</span></span><br><span class="line">      toggleOptList(select);</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="comment">// In case the widget gain focus</span></span><br><span class="line">    <span class="comment">// The widget gains the focus each time the user clicks on it or each time</span></span><br><span class="line">    <span class="comment">// they use the tabulation key to access the widget</span></span><br><span class="line">    select.addEventListener(<span class="string">'focus'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">      <span class="comment">// Note: the `select` and `selectList` variable are closures</span></span><br><span class="line">      <span class="comment">// available in the scope of our function call.</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// We activate the widget</span></span><br><span class="line">      activeSelect(select, selectList);</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="comment">// In case the widget loose focus</span></span><br><span class="line">    select.addEventListener(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">      <span class="comment">// Note: the `select` variable is a closure</span></span><br><span class="line">      <span class="comment">// available in the scope of our function call.</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">// We deactivate the widget</span></span><br><span class="line">      deactivateSelect(select);</span><br><span class="line">    });</span><br><span class="line">  });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>At that point, our widget will change state according to our design, but its value doesn’t get updated yet. We’ll handle that next.</p>
<h3 id="handling-the-widgets-value"><a class="markdownIt-Anchor" href="#handling-the-widgets-value"></a> Handling the widget’s value</h3>
<p>Now that our widget is working, we have to add code to update its value according to user input and make it possible to send the value along with form data.</p>
<p>The easiest way to do this is to use a native widget under the hood. Such a widget will keep track of the value with all the built-in controls provided by the browser, and the value will be sent as usual when a form is submitted. There’s no point in reinventing the wheel when we can have all this done for us.</p>
<p>As seen previously, we already use a native select widget as a fallback for accessibility reasons; we can simply synchronize its value with that of our custom widget:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This function updates the displayed value and synchronizes it with the native widget.</span></span><br><span class="line"><span class="comment">// It takes two parameters:</span></span><br><span class="line"><span class="comment">// select : the DOM node with the class `select` containing the value to update</span></span><br><span class="line"><span class="comment">// index  : the index of the value to be selected</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateValue</span>(<span class="params">select, index</span>) </span>{</span><br><span class="line">  <span class="comment">// We need to get the native widget for the given custom widget</span></span><br><span class="line">  <span class="comment">// In our example, that native widget is a sibling of the custom widget</span></span><br><span class="line">  <span class="keyword">var</span> nativeWidget = select.previousElementSibling;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We also need  to get the value placeholder of our custom widget</span></span><br><span class="line">  <span class="keyword">var</span> value = select.querySelector(<span class="string">'.value'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// And we need the whole list of options</span></span><br><span class="line">  <span class="keyword">var</span> optionList = select.querySelectorAll(<span class="string">'.option'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We set the selected index to the index of our choice</span></span><br><span class="line">  nativeWidget.selectedIndex = index;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We update the value placeholder accordingly</span></span><br><span class="line">  value.innerHTML = optionList[index].innerHTML;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// And we highlight the corresponding option of our custom widget</span></span><br><span class="line">  highlightOption(select, optionList[index]);</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function returns the current selected index in the native widget</span></span><br><span class="line"><span class="comment">// It takes one parameter:</span></span><br><span class="line"><span class="comment">// select : the DOM node with the class `select` related to the native widget</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIndex</span>(<span class="params">select</span>) </span>{</span><br><span class="line">  <span class="comment">// We need to access the native widget for the given custom widget</span></span><br><span class="line">  <span class="comment">// In our example, that native widget is a sibling of the custom widget</span></span><br><span class="line">  <span class="keyword">var</span> nativeWidget = select.previousElementSibling;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> nativeWidget.selectedIndex;</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>With these two functions, we can bind the native widgets to the custom ones:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// We handle event binding when the document is loaded.</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> selectList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.select'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Each custom widget needs to be initialized</span></span><br><span class="line">  selectList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">select</span>) </span>{</span><br><span class="line">    <span class="keyword">var</span> optionList = select.querySelectorAll(<span class="string">'.option'</span>),</span><br><span class="line">        selectedIndex = getIndex(select);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We make our custom widget focusable</span></span><br><span class="line">    select.tabIndex = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We make the native widget no longer focusable</span></span><br><span class="line">    select.previousElementSibling.tabIndex = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// We make sure that the default selected value is correctly displayed</span></span><br><span class="line">    updateValue(select, selectedIndex);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each time a user clicks on an option, we update the value accordingly</span></span><br><span class="line">    optionList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">option, index</span>) </span>{</span><br><span class="line">      option.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">        updateValue(select, index);</span><br><span class="line">      });</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Each time a user uses their keyboard on a focused widget, we update the value accordingly</span></span><br><span class="line">    select.addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>{</span><br><span class="line">      <span class="keyword">var</span> length = optionList.length,</span><br><span class="line">          index  = getIndex(select);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// When the user hits the down arrow, we jump to the next option</span></span><br><span class="line">      <span class="keyword">if</span> (event.keyCode === <span class="number">40</span> &amp;&amp; index &lt; length - <span class="number">1</span>) { index++; }</span><br><span class="line"></span><br><span class="line">      <span class="comment">// When the user hits the up arrow, we jump to the previous option</span></span><br><span class="line">      <span class="keyword">if</span> (event.keyCode === <span class="number">38</span> &amp;&amp; index &gt; <span class="number">0</span>) { index--; }</span><br><span class="line"></span><br><span class="line">      updateValue(select, index);</span><br><span class="line">    });</span><br><span class="line">  });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>In the code above, it’s worth noting the use of the <code>tabIndex</code> property. Using this property is necessary to ensure that the native widget will never gain focus, and to make sure that our custom widget gains focus when the user uses his keyboard or his mouse.</p>
<h2 id="make-it-accessible"><a class="markdownIt-Anchor" href="#make-it-accessible"></a> Make it accessible</h2>
<p>We have built something that works and though we’re far from a fully-featured select box, it works nicely. But what we’ve done is nothing more than fiddle with the DOM. It has no real semantics, and even though it looks like a select box, from the browser’s point of view it isn’t one, so assistive technologies won’t be able to understand it’s a select box. In short, this pretty new select box isn’t accessible!</p>
<p>Fortunately, there is a solution and it’s called <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA">ARIA</a>. ARIA stands for “Accessible Rich Internet Application”, and it’s <a target="_blank" rel="noopener" href="http://www.w3.org/TR/wai-aria/">a W3C specification</a> specifically designed for what we are doing here: making web applications and custom widgets accessible. It’s basically a set of attributes that extend HTML so that we can better describe roles, states and properties as though the element we’ve just devised was the native element it tries to pass for. Using these attributes is dead simple, so let’s do it.</p>
<h3 id="the-role-attribute"><a class="markdownIt-Anchor" href="#the-role-attribute"></a> The <code>role</code> attribute</h3>
<p>The key attribute used by <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA">ARIA</a> is the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques"><code>role</code></a> attribute. The <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques"><code>role</code></a> attribute accepts a value that defines what an element is used for. Each role defines its own requirements and behaviors. In our example, we will use the <code>listbox</code> role. It’s a “composite role”, which means elements with that role expect to have children, each with a specific role (in this case, at least one child with the <code>option</code> role).</p>
<p>It’s also worth noting that ARIA defines roles that are applied by default to standard HTML markup. For example, the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul"><code>](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/table) element matches the role `grid`, and the [</code></a> element matches the role <code>list</code>. Because we use a <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul"><code>](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul) element, we want to make sure the `listbox`role of our widget will supersede the `list` role of the [</code></a> element. To that end, we will use the role <code>presentation</code>. This role is designed to let us indicate that an element has no special meaning, and is used solely to present information. We will apply it to our <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/ul">``</a> element.</p>
<p>To support the <code>listbox</code> role, we just have to update our HTML like this:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- We add the role="listbox" attribute to our top element --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"select"</span> <span class="attr">role</span>=<span class="string">"listbox"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"value"</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- We also add the role="presentation" to the ul element --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"optList"</span> <span class="attr">role</span>=<span class="string">"presentation"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- And we add the role="option" attribute to all the li elements --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">"option"</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Cherry<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">"option"</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Lemon<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">"option"</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Banana<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">"option"</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Strawberry<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">role</span>=<span class="string">"option"</span> <span class="attr">class</span>=<span class="string">"option"</span>&gt;</span>Apple<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>Note:</strong> Including both the <code>role</code> attribute and a <code>class</code> attribute is only necessary if you want to support legacy browsers that do not support the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/CSS/Attribute_selectors">CSS attribute selectors</a>.</p>
<h3 id="the-aria-selected-attributesection"><a class="markdownIt-Anchor" href="#the-aria-selected-attributesection"></a> The <code>aria-selected</code> attribute<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/How_to_build_custom_form_widgets#The_aria-selected_attribute">Section</a></h3>
<p>Using the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques"><code>role</code></a> attribute is not enough. <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Accessibility/ARIA">ARIA</a> also provides many states and property attributes. The more and better you use them, the better your widget will be understood by assistive technologies. In our case, we will limit our usage to one attribute: <code>aria-selected</code>.</p>
<p>The <code>aria-selected</code> attribute is used to mark which option is currently selected; this lets assistive technologies inform the user what the current selection is. We will use it dynamically with JavaScript to mark the selected option each time the user chooses one. To that end, we need to revise our <code>updateValue()</code> function:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateValue</span>(<span class="params">select, index</span>) </span>{</span><br><span class="line">  <span class="keyword">var</span> nativeWidget = select.previousElementSibling;</span><br><span class="line">  <span class="keyword">var</span> value = select.querySelector(<span class="string">'.value'</span>);</span><br><span class="line">  <span class="keyword">var</span> optionList = select.querySelectorAll(<span class="string">'.option'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We make sure that all the options are not selected</span></span><br><span class="line">  optionList.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">other</span>) </span>{</span><br><span class="line">    other.setAttribute(<span class="string">'aria-selected'</span>, <span class="string">'false'</span>);</span><br><span class="line">  });</span><br><span class="line"></span><br><span class="line">  <span class="comment">// We make sure the chosen option is selected</span></span><br><span class="line">  optionList[index].setAttribute(<span class="string">'aria-selected'</span>, <span class="string">'true'</span>);</span><br><span class="line"></span><br><span class="line">  nativeWidget.selectedIndex = index;</span><br><span class="line">  value.innerHTML = optionList[index].innerHTML;</span><br><span class="line">  highlightOption(select, optionList[index]);</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>
<p>Here is the final result of all these changes (you’ll get a better feel for this by trying it with an assistive technology such as <a target="_blank" rel="noopener" href="http://www.nvda-project.org/">NVDA</a> or <a target="_blank" rel="noopener" href="http://www.apple.com/accessibility/voiceover/">VoiceOver</a>):</p>
<h2 id="conclusion"><a class="markdownIt-Anchor" href="#conclusion"></a> Conclusion</h2>
<p>We have seen all the basics of building a custom form widget, but as you can see it’s not trivial to do, and often it’s better and easier to rely on third-party libraries instead of coding them from scratch yourself (unless, of course, your goal is to build such a library).</p>
<p>Here are a few libraries you should consider before coding your own:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://jqueryui.com/">jQuery UI</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/marghoobsuleman/ms-Dropdown">msDropDown</a></li>
<li><a target="_blank" rel="noopener" href="http://www.emblematiq.com/lab/niceforms/">Nice Forms</a></li>
<li><a target="_blank" rel="noopener" href="https://www.google.fr/search?q=HTML+custom+form+controls&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:fr:official&amp;client=firefox-a">And many more…</a></li>
</ul>
<p>If you want to move forward, the code in this example needs some improvement before it becomes generic and reusable. This is an exercise you can try to perform. Two hints to help you in this: the first argument for all our functions is the same, which means those functions need the same context. Building an object to share that context would be wise. Also, you need to make it feature-proof; that is, it needs to be able to work better with a variety of browsers whose compatibility with the Web standards they use vary. Have fun!</p>
<h2 id="html-forms-in-legacy-browsers"><a class="markdownIt-Anchor" href="#html-forms-in-legacy-browsers"></a> HTML forms in legacy browsers</h2>
<p>All web developers learn very quickly (and sometimes painfully) that the Web is a very rough place for them. Our worst curse is legacy browsers. Okay, let’s admit it, when we said “legacy browser” we all have in mind old versions of Internet Explorer … but it’s far from the only one. A one-year-old Firefox such as <a target="_blank" rel="noopener" href="http://www.mozilla.org/en-US/firefox/organizations/">the ESR version</a> is a legacy browser too. And in the mobile world? When neither the browser nor the OS can be updated? Yes, there are many older Android phones or iPhones that have stock browsers that are not up to date. These are also legacy browsers.</p>
<p>Sadly, dealing with that wilderness is part of the job. Fortunately, there are a few tricks to know that can help you to solve about 80% of the problems caused by legacy browsers.</p>
<h2 id="learn-about-the-issues"><a class="markdownIt-Anchor" href="#learn-about-the-issues"></a> Learn about the issues</h2>
<p>Actually, the most important thing is to read documentation about those browsers to try to understand the common patterns. For example, CSS support is the biggest issue with HTML forms in many cases. You are at the right place to start. Just check the support of the elements (or DOM interface) you want to use. MDN has compatibility tables available for many elements, properties or APIs that can be used in a web page. But there are other resources that can be amazingly helpful:</p>
<h3 id="browser-vendor-documentation"><a class="markdownIt-Anchor" href="#browser-vendor-documentation"></a> Browser vendor documentation</h3>
<ul>
<li>Mozilla: You’re in the right place, just browse MDN</li>
<li>Microsoft: <a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/ff410218%28v=vs.85%29.aspx">Internet Explorer Standards Support Documentation</a></li>
<li>WebKit: Because there are several different editions of this engine, things are a little trickier.
<ul>
<li><a target="_blank" rel="noopener" href="https://www.webkit.org/blog/">The WebKit blog</a> and <a target="_blank" rel="noopener" href="http://planet.webkit.org/">Planet WebKit</a> aggregate the best articles by WebKit core developers.</li>
<li><a target="_blank" rel="noopener" href="https://www.chromestatus.com/features">Chrome platform status site</a> is also important.</li>
<li>As well as <a target="_blank" rel="noopener" href="https://developer.apple.com/technologies/safari/">the Apple web site.</a></li>
</ul>
</li>
</ul>
<h3 id="independent-documentation"><a class="markdownIt-Anchor" href="#independent-documentation"></a> Independent documentation</h3>
<ul>
<li><a target="_blank" rel="noopener" href="http://caniuse.com/">Can I Use</a> has information about support for cutting edge technologies.</li>
<li><a target="_blank" rel="noopener" href="http://www.quirksmode.org/">Quirks Mode</a> is an amazing resource about browsers’ compatibility. <a target="_blank" rel="noopener" href="http://www.quirksmode.org/mobile/">The mobile part</a> is one of the best available at the moment.</li>
<li><a target="_blank" rel="noopener" href="http://positioniseverything.net/">Position Is Everything</a> is the best resource available about rendering bugs in legacy browsers and their work-arounds (if any).</li>
<li><a target="_blank" rel="noopener" href="http://mobilehtml5.org/">Mobile HTML5</a> has compatibility information for a wide range of mobile browsers, not just the “top 5” (including Nokia, Amazon, and Blackberry).</li>
</ul>
<h2 id="make-things-simple"><a class="markdownIt-Anchor" href="#make-things-simple"></a> Make things simple</h2>
<p>Because <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/HTML/Forms">HTML forms</a> involves complex interaction, there is one rule of thumb: <a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/KISS_principle">keep it as simple as possible</a>. There are so many cases where we want forms that are “nicer” or “with advanced functionality”, but building efficient HTML Forms is not a question of design or technology. Just as a reminder, take the time to read this article about <a target="_blank" rel="noopener" href="http://www.uxforthemasses.com/forms-usability/">forms usability on UX For The Masses</a>.</p>
<h3 id="graceful-degradation-is-web-developers-best-friend"><a class="markdownIt-Anchor" href="#graceful-degradation-is-web-developers-best-friend"></a> Graceful degradation is web developer’s best friend</h3>
<p><a target="_blank" rel="noopener" href="http://www.sitepoint.com/progressive-enhancement-graceful-degradation-choice/">Graceful degradation and progressive enhancement</a> are development patterns that allow you to build great stuff by supporting a wide range of browsers at the same time. When you build something for a modern browser, and you want to be sure it will work, one way or another, on legacy browsers, you are performing graceful degradation.</p>
<p>Let’s see some examples related to HTML forms.</p>
<h4 id="html-input-types"><a class="markdownIt-Anchor" href="#html-input-types"></a> HTML input types</h4>
<p>The new input types brought by HTML5 are very cool because the way they degrade is highly predictable. If a browser does not know the value of the <code>type</code> attribute of an <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input">``</a> element, it will fall back as if the value were <code>text</code>.</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"myColor"</span>&gt;</span></span><br><span class="line">  Pick a color</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"color"</span> <span class="attr">id</span>=<span class="string">"myColor"</span> <span class="attr">name</span>=<span class="string">"color"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<table>
<thead>
<tr>
<th>Chrome 24</th>
<th>Firefox 18</th>
</tr>
</thead>
<tbody>
<tr>
<td><img src="https://developer.mozilla.org/files/4575/color-fallback-chrome.png" alt="Screen shot of the color input on Chrome for Mac OSX"></td>
<td><img src="https://developer.mozilla.org/files/4577/color-fallback-firefox.png" alt="Screen shot of the color input on Firefox for Mac OSX"></td>
</tr>
</tbody>
</table>
<h4 id="css-attribute-selectors"><a class="markdownIt-Anchor" href="#css-attribute-selectors"></a> CSS Attribute Selectors</h4>
<p>The <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/CSS/Attribute_selectors">CSS Attribute selectors</a> are very useful with <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/HTML/Forms">HTML Forms</a> but some legacy browsers do not support it. In that case, it’s customary to double the type with an equivalent class:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">class</span>=<span class="string">"number"</span>&gt;</span></span><br><span class="line">input[type=number] {</span><br><span class="line">  /* This can fail in some browsers */</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">input.number {</span><br><span class="line">  /* This will work everywhere */</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Note that the following is useless (because it’s redundant) and can fail in some browsers:</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-attr">[type=number]</span>,</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-class">.number</span> {</span><br><span class="line">  <span class="comment">/* This can fail in some browsers because if they do not understand</span></span><br><span class="line"><span class="comment">     one of the selectors, they will skip the whole rule */</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h4 id="form-buttons"><a class="markdownIt-Anchor" href="#form-buttons"></a> Form buttons</h4>
<p>There are two ways to define buttons within HTML forms:</p>
<ul>
<li>The <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input">``</a> element with its attribute <code>type</code> set to the values <code>button</code>, <code>submit</code>, <code>reset</code>or <code>image</code></li>
<li>The <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button">``</a> element</li>
</ul>
<p>The  <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input">``</a> element can make things a little difficult if you want to apply some CSS by using the element selector:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"click me"</span>&gt;</span></span><br><span class="line">input {</span><br><span class="line">  /* This rule turns off the default rendering for buttons defined with an input element */</span><br><span class="line">  border: 1px solid #CCC;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">input.button {</span><br><span class="line">  /* This does NOT restore the default rendering */</span><br><span class="line">  border: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">input.button {</span><br><span class="line">  /* That doesn't either! Actually there is no standard way to do it in any browser */</span><br><span class="line">  border: auto;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>The <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button">``</a> element suffers from two possible issues:</p>
<ul>
<li>A bug in some old versions of Internet Explorer. When the user click the button, it’s not the content of the <code>value</code> attribute that is sent, but the HTML content available between the starting and ending tag of the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button">``</a> element. This is an issue only if you want to send such a value, for example if the processing of the data depends on which button the user clicks.</li>
<li>Some very old browsers does not use <code>submit</code> as the default value for the <code>type</code> attribute, so it’s recommended to always set the attribute <code>type</code> on <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/button">``</a> elements.</li>
</ul>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Clicking this button sends "&lt;em&gt;Do A&lt;/em&gt;" instead of "A" in some cases --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"IWantTo"</span> <span class="attr">value</span>=<span class="string">"A"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">em</span>&gt;</span>Do A<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>Choosing one solution or the other is up to you based on your project’s constraints.</p>
<h3 id="let-go-of-css"><a class="markdownIt-Anchor" href="#let-go-of-css"></a> Let go of CSS</h3>
<p>The biggest issue with HTML Forms and legacy browsers is the support for CSS. As you can see from the complexity of the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Property_compatibility_table_for_form_widgets">Property compatibility table for form widgets</a> article, it’s very difficult. Even if it’s still possible to do a few adjustments on text elements (such as sizing or font color), there are always side effects. The best approach remains to not style HTML Form widgets at all. But you can still apply styles to all the surrounding items. If you are a professional and if your client requires it, in that case, you can investigate some hard techniques such as <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/HTML/Forms/How_to_build_custom_form_widgets">rebuilding widgets with JavaScript</a>. But in that case, do not hesitate to <a target="_blank" rel="noopener" href="http://www.smashingmagazine.com/2011/11/03/but-the-client-wants-ie-6-support/">charge your client for such foolishness</a>.</p>
<h2 id="feature-detection-and-polyfills"><a class="markdownIt-Anchor" href="#feature-detection-and-polyfills"></a> Feature detection and polyfills</h2>
<p>While JavaScript is an awesome technology in modern browsers, legacy browsers have many issues with it.</p>
<h3 id="unobtrusive-javascript"><a class="markdownIt-Anchor" href="#unobtrusive-javascript"></a> Unobtrusive JavaScript</h3>
<p>One of the biggest problems is the availability of APIs. For that reason, it’s considered best practice to work with “unobtrusive” JavaScript. It’s a development pattern that defines two requirements:</p>
<ul>
<li>A strict separation between structure and behaviors.</li>
<li>If the code breaks, the content and the basic functionalities must remain accessible and usable.</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://webplatform.github.io/docs/concepts/programming/the_principles_of_unobtrusive_javascript/">The principles of unobtrusive JavaScript</a> (originally written by Peter-Paul Koch for <a target="_blank" rel="noopener" href="http://Dev.Opera.com">Dev.Opera.com</a> and now moved to <a target="_blank" rel="noopener" href="http://Docs.WebPlatform.org">Docs.WebPlatform.org</a>) describes these ideas very well.</p>
<h3 id="the-modernizr-library"><a class="markdownIt-Anchor" href="#the-modernizr-library"></a> The Modernizr library</h3>
<p>There are many cases where a good “polyfill” can help a lot by providing a missing API. A <a target="_blank" rel="noopener" href="http://remysharp.com/2010/10/08/what-is-a-polyfill/">polyfill</a> is a bit of JavaScript that “fills in the holes” in the functionality of legacy browsers. While they can be used to improve support for any functionality, using them for JavaScript is less risky than for CSS or HTML; there many cases where JavaScript can break (network issues, script conflicts, etc.). But for JavaScript, if you work with unobstructive JavaScript in mind, if polyfills are missing, it’s no big deal.</p>
<p>The best way to polyfill missing API is by using the <a target="_blank" rel="noopener" href="http://modernizr.com/">Modernizr</a> library and its spin-off project: <a target="_blank" rel="noopener" href="http://yepnopejs.com/">YepNope</a>. Modernizr is a library that allows you to test the availability of functionality in order to act accordingly. YepNope is a conditional loading library.</p>
<p>Here is an example:</p>
<figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Modernizr.load({</span><br><span class="line">  <span class="comment">// This tests if your browser supports the HTML5 form validation API</span></span><br><span class="line">  test : Modernizr.formvalidation,</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// If the browser does not support it, the following polyfill is loaded</span></span><br><span class="line">  nope : form-validation-API-polyfill.js,</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// In any case, your core App file that depends on that API is loaded</span></span><br><span class="line">  both : app.js,</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// Once both files are loaded, this function is called in order to initialize the App.</span></span><br><span class="line">  complete : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>{</span><br><span class="line">    app.init();</span><br><span class="line">  }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>The Modernizr team conveniently maintains <a target="_blank" rel="noopener" href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills">a list of great polyfills</a>. Just pick what you need.</p>
<p><strong>Note:</strong> Modernizr has other awesome features to help you in dealing with unobstructive JavaScript and graceful degradation techniques. Please <a target="_blank" rel="noopener" href="http://modernizr.com/docs/">read the Modernizr documentation</a>.</p>
<h3 id="pay-attention-to-performance"><a class="markdownIt-Anchor" href="#pay-attention-to-performance"></a> Pay attention to performance</h3>
<p>Even though scripts like Modernizr are very aware of performance, loading a 200 kilobyte polyfill can affect the performance of your application. This is especially critical with legacy browsers; many of them have a very slow JavaScript engine that can make the execution of all your polyfills painful for the user. Performance is a subject on its own, but legacy browsers are very sensitive to it: basically, they are slow and the more polyfills they need, the more JavaScript they have to process. So they are doubly burdened compared to modern browsers. Test your code with legacy browsers to see how they actually perform. Sometimes, dropping some functionality leads to a better user experience than having exactly the same functionality in all browsers. As a last reminder, just always think about the end users.</p>
<h3 id="references"><a class="markdownIt-Anchor" href="#references"></a> REFERENCES</h3>
<ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/Forms">https://developer.mozilla.org/en-US/docs/Learn/Forms</a></li>
<li>Property compatibility table for form widgets :<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Property_compatibility_table_for_form_widgets">https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Property_compatibility_table_for_form_widgets</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/Forms/How_to_build_custom_form_controls">https://developer.mozilla.org/en-US/docs/Learn/Forms/How_to_build_custom_form_controls</a></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joaxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://u.pinsflora.com/web/css/ele/web_css_custom_select/">https://u.pinsflora.com/web/css/ele/web_css_custom_select/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CSS/">CSS</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/web/css/web_css_grids/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">CSS - grid layout</div></div></a></div><div class="next-post pull-right"><a href="/web/css/web_css_media_responsive/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_grass_in_the_snow.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">CSS - Media queries &amp; Responsive Layout</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/web/css/web_css_animation/" title="CSS - Animation"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2018-05-21</div><div class="title">CSS - Animation</div></div></a></div><div><a href="/web/css/web_css_flex/" title="CSS - Flexible Box"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_red_dim_flower.jpg"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2019-11-21</div><div class="title">CSS - Flexible Box</div></div></a></div><div><a href="/web/css/web_css_gradients/" title="CSS - Background Gradients"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_little_girl_phone.jpg"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2018-05-21</div><div class="title">CSS - Background Gradients</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div></div></div></div></article></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Joaxin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Refine, the Life</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js', function () {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="fasle"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/fae45343.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'fae45343',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script></div></body></html>