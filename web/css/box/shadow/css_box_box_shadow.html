
<html lang="en">
    <head>
        <title>Code Editor</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <style>
            * {
                margin: 0;
                padding: 0;
            }
    
            .container {
                margin: 5px 5px 0px;
            }
    
            textarea {
                width: 100%;
                min-height: 250px;
                overflow: scroll;
                margin: 0px auto;
                display: inline-block;
                border: none;
                background: #f4f4f9;
                font-family: Courier, sans-serif;
                font-size: 14px;
            }
    
            ul.tabs {
                list-style: none;
                height: 32px;
                width: 100%;
                z-index: 999;
            }
    
            ul.tabs li {
                float: left;
                cursor: pointer;
                padding: 0px 20px;
                height: 30px;
                line-height: 30px;
                background-color: #666;
                color: #ccc;
                overflow: hidden;
                position: relative;
            }
    
            ul.tabs li:hover {
                background-color: #ccc;
                color: #555;
            }
    
            ul.tabs li.active {
                background-color: #f4f4f9;
                color: #555;
                display: block;
                /* border-bottom: 1px solid #f4f4f9; */
            }
    
            .tab_code {
                width: 100%;
                background: #fff;
                overflow: auto;
            }
    
            .tab_ {
                padding: 0px;
                display: none;
            }
    
            iframe {
                bottom: 0;
                border: none;
                position: relative;
                width: 100%;
            }
    
            #colorBox{
                position: absolute;
                top: 45px;
                right: 45px;
            }
            #colorBox div div{
                position: relative;
            }
            #toggle{
                display: block;
            }
        </style>
        <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    </head>
    
    <body>
        <div class="container">
            <ul class="tabs" id="tabs">
                <li class="active" rel="tab1">HTML</li>
                <li rel="tab2">CSS</li>
                <li rel="tab3">JavaScript</li>
                <li onclick="mi()" id = "toggle"><i class="fa fa-window-minimize"></i></li>
            </ul>
            <div class="tab_code">
                <div id="tab1" class="tab_">
                    <textarea id="html" placeholder="HTML">
<select id="select_shadow" onChange='apply_css_select(this)'>
    <option value="none">-Select Box Shadow CSS-</option>
<!--     blur-radius | spread-radius -->
<!--     0 0 10px -10px #06c/ 0 0 10px 10px #06c / inset 0 0 10px 10px #06c -->
    <option value="0"> 0 0 10px #06c</option>
    <option value="1"> 0 0 0 10px #06c </option> <!-- border: 10px solid #06c -->
    <option value="2">60px -16px teal</option>
    <option value="3">12px 12px 2px 1px rgba(0, 0, 255, .2)</option>
    <option value="4">inset 5px 0.5em gold</option>
    <option value="5">3px 3px red, -1em 0 .4em olive</option>
    <option value="6">5px 5px 2px red, 0 0 1em #FC0</option>
    <option value="7">12px 12px 2px 1px rgba(0, 0, 255, .2)</option>
    <option value="8">5px -10px 2px red, 0 0 1em green, 0 0 0.5em #Fc0</option>
    <option value="9">-50px -50px 2px red,-50px 50px 1px yellow,10px -10px 2px green,10px 10px 2px blue</option>
<!--      -5px 0 5px red, 0 5px 5px blue, 5px 0 5px green, 0 -5px 5px orange -->
    <option value="10">0 -4px 5px -3px red, 4px 0 5px -3px green, 0 4px 5px -3px blue, -4px 0 5px -1px orange</option>
    <option value="11">10px 20px 5px 1px #888888,  inset -10px -20px 5px 0px #888888</option>
    <option value="12">inset 10px 20px 5px 1px #888888,  inset -10px -20px 5px 0px #888888</option>
    <option value="13">inset -1px -1px 60px 0px magenta, -1px -1px 20px 5px red,  -1px -1px 20px 10px blue,  20px 0 10px 30px orange</option>
    <option value="14">0 0 0 1px red, 0 0 0 5px blue,0 0 0 8px green, 0 0 0 12px yellow, 0 0 0 16px orange,0 0 0 20px #06c,0 0 0 24px lime</option>
</select>
<input id = "shadow" type="text" placeholder="Text Shadow CSS" >

<p id="shadow_">This is a box with a box-shadow.</p>        
                    </textarea>
                </div>
                <div id="tab2" class="tab_">
                    <textarea id="css" placeholder="CSS">                 
select,input{
    display: block;
    width: 100%;
    padding: 8px 16px;
    line-height: 25px;
    font: 1.2em Georgia,serif;
    border-radius: 5px;
    border: 1px solid gray;
    margin-top:15px;
}

p {
    color:#352995;
    font:2.5em Georgia,serif;
    margin: 25px 50px;
    text-align:center;
    border:2px dotted magenta;
    border-radius: 10px;
}
    </textarea>
                    <div id="colorBox">
                        <p></p>
                    </div>
                </div>
                <div id="tab3" class="tab_">
                    <textarea id="js" placeholder="JavaScript">
function apply_css_select(rel){
    let v = document.getElementById("shadow_")
    v.style.boxShadow = rel.options[rel.selectedIndex].text;
    document.getElementById("shadow").value = "";
}
               
function apply_css(){
    let v = document.getElementById("shadow_")
    v.style.boxShadow = this.value;
    document.getElementById("select_shadow").selectedIndex = 0;
}
document.getElementById("shadow").addEventListener('change', apply_css);
                    </textarea>
                </div>
            </div>
        </div>
        <iframe id="code"></iframe>
        <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script>
            $(".tab_").hide();
            $(".tab_:first").show();
    
            $("ul.tabs li").click(function() {
                $(".tab_").hide();
                let activeTab = $(this).attr("rel");
                $("#" + activeTab).fadeIn();
    
                $("ul.tabs li").removeClass("active");
                $(this).addClass("active");
            });
    
            function mi() {
                var iframe = document.getElementById("code");
                var tabs = document.getElementById("tabs");
                if (tabs.style.position == "fixed") {
                    iframe.style.height = window.innerHeight - document.querySelector(".tabs").offsetHeight
                    for (var i = 0; i < tabs.children.length - 1; i++) {
                        tabs.children[i].style.display = "block";
                    }
                    tabs.children[3].childNodes[0].className = "fa fa-window-minimize";
                    tabs.style.position = "relative";
                    document.querySelector(".container").style.margin = "5px 5px 0px"
                } else {
                    for (var i = 0; i < tabs.children.length - 1; i++) {
                        tabs.children[i].style.display = "none";
                    }
                    tabs.children[3].childNodes[0].className = "fa fa-plus";
                    tabs.children[3].childNodes[0].style.padding = "7px";
                    tabs.style.position = "fixed";
                    document.querySelector(".container").style.margin = "0px"
                    // iframe.style.height = "100%";
                    iframe.style.width = "100%";
                    $("#toggle").hide(3000);
                    $('body').dblclick(function() {
                    $('#toggle').show(1000);
                    });  
                }
            }
    
            function isLight(color) {
                if (["mistyrose","white","yellow","floralwhite","honeydew","azure","whitesmoke","blanchedalmond","beige","antiquewhite","aliceblue","cornsilk","ghostwhite","floralwhite","ivory","lightcyan","lavenderblush","lemonchiffon","lavender","lightcyan","lightyellow","mintcream","oldlace","lightgoldenrodyellow","linen","moccasin","navajowhite","snow"].includes(color)) {
                    return false
                }
                var r, g, b, hsp;
                if (color.match(/^rgb/)) {
                    color = color.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d?(?:\.\d+)?))?\)$/);
                    r = color[1];
                    g = color[2];
                    b = color[3];
                } else {
                    // If hex --> Convert it to RGB: http://gist.github.com/983661
                    color = +("0x" + color.slice(1).replace(
                        color.length < 5 && /./g, '$&$&'));
                    r = color >> 16;
                    g = color >> 8 & 255;
                    b = color & 255;
                }
                // HSP (Highly Sensitive Poo) equation from http://alienryderflex.com/hsp.html
                hsp = Math.sqrt(
                    0.299 * (r * r) +
                    0.587 * (g * g) +
                    0.114 * (b * b)
                );
                // Using the HSP value, determine whether the color is light or dark
                return hsp < 127.5
            }
    
            function compile() {
                let html = document.getElementById("html");
                let css = document.getElementById("css");
                // let css = document.getElementById("css").value;
                // var regex = /#(?:[0-9a-f]{3}){1,2}/gi
                // https://gist.github.com/olmokramer/82ccce673f86db7cda5e
                let regex = /(#([\da-f]{3}){1,2}|\b(black|silver|gray|whitesmoke|maroon|red|purple|fuchsia|green|lime|olivedrab|yellow|navy|blue|teal|aquamarine|orange|aliceblue|antiquewhite|aqua|azure|beige|bisque|blanchedalmond|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkgrey|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|gainsboro|ghostwhite|goldenrod|gold|greenyellow|grey|honeydew|hotpink|indianred|indigo|ivory|khaki|lavenderblush|lavender|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|limegreen|linen|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|oldlace|olive|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|thistle|tomato|turquoise|violet|wheat|white|yellowgreen|rebeccapurple)\b|(rgb|hsl)a\((\d{1,3}%?,\s?){3}(1|0?\.\d+)\)|(rgb|hsl)\(\d{1,3}%?(,\s?\d{1,3}%?){2}\))/gi
                let colorSet = [...new Set(css.value.match(regex))];
    
                let colorBox = document.getElementById("colorBox");
                let colorInfo = document.createElement("div");
                for (let n = 0; n < colorSet.length; n++) {
                    var co = document.createElement("div");
                    co.style.backgroundColor = colorSet[n];
                    co.style.height = "1.5em";
                    co.style.top = parseInt(n / parseInt(css.offsetHeight/30))*-224 + "px"
                    co.style.right = parseInt(n / parseInt(css.offsetHeight/30))*154 + "px"
                    co.style.padding = "2px";
                    co.style.width = "150px";
                    co.style.textAlign = "center";
                    console.log(colorSet[n]);
                    co.style.color = isLight(colorSet[n]) ? '#FFF' : '#000';
                    co.innerHTML = "<b>" + colorSet[n] + "</b>";
                    colorInfo.appendChild(co);
                }
                colorBox.replaceChild(colorInfo, colorBox.childNodes[0]);
                let js = document.getElementById("js");
                document.getElementById("code").style.height = window.innerHeight - document.querySelector(".container").offsetHeight - document.querySelector(".container").offsetTop
                let code = document.getElementById("code").contentWindow.document;
                code.open();
                code.writeln(
                    html.value +
                    "<style>" +
                    css.value +
                    "</style>" +
                    "<script>" +
                    js.value +
                    "<" +
                    "/script>"
                );
                code.close();
            }
    
            compile();
            window.addEventListener("click", compile);
        </script>
    </body>
    
    </html>