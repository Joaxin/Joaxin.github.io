<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python - PDF &amp; Word | Pinsflora</title><meta name="keywords" content="Word,PDF"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Working with PDF and Word Documents">
<meta property="og:type" content="article">
<meta property="og:title" content="Python - PDF &amp; Word">
<meta property="og:url" content="https://u.pinsflora.xyz/Pysnista/Intro/files/py_files_pdf_word/index.html">
<meta property="og:site_name" content="Pinsflora">
<meta property="og:description" content="Working with PDF and Word Documents">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png">
<meta property="article:published_time" content="2020-04-12T16:00:00.000Z">
<meta property="article:modified_time" content="2020-07-10T16:00:00.000Z">
<meta property="article:author" content="Joaxin">
<meta property="article:tag" content="Word">
<meta property="article:tag" content="PDF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png"><link rel="shortcut icon" href="/img/favicon-32x32.png"><link rel="canonical" href="https://u.pinsflora.xyz/Pysnista/Intro/files/py_files_pdf_word/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":600,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-07-11 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python - PDF &amp; Word</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2020-04-12T16:00:00.000Z" title="Created 2020-04-13 00:00:00">2020-04-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-07-10T16:00:00.000Z" title="Updated 2020-07-11 00:00:00">2020-07-11</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/Introduction/">Introduction</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>9min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python - PDF &amp; Word"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>PDF 和 Word 文档是二进制文件，比文本复杂的多，要特定程序才能打开它们，利用Python可以让我们很方便的处理这些文件。</p>
<h1 id="安装包"><a class="markdownIt-Anchor" href="#安装包"></a> 安装包</h1>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-docx</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Installing collected packages: python-docx</span><br><span class="line">Successfully installed python-docx-0.8.10</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pyPDF2</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Installing collected packages: pyPDF2</span><br><span class="line">Successfully installed pyPDF2-1.26.0</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pdfminer.six</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Installing collected packages: pycryptodome, sortedcontainers, pdfminer.six</span><br><span class="line">Successfully installed pdfminer.six-20200517 pycryptodome-3.9.8 sortedcontainers</span><br><span class="line">-2.2.2</span><br></pre></td></tr></tbody></table></figure>
<h1 id="pdf"><a class="markdownIt-Anchor" href="#pdf"></a> PDF</h1>
<p>PDF 表示 Portable Document Format，使用.pdf 文件扩展名。</p>
<h2 id="pdf-读取文本内容"><a class="markdownIt-Anchor" href="#pdf-读取文本内容"></a> PDF 读取文本内容</h2>
<p>PyPDF2 没有办法从 PDF 文档中提取图像、图表或其他媒体，但它可以提取文本，并将文本返回为 Python 字符串。</p>
<p><img src="https://i.loli.net/2020/07/11/zB4YtJP8q6DaRgs.jpg" alt="pdf_meeting.jpg"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 导入 PyPDF2 模块。然后以读二进制模式打开 meetingminutes.pdf，并将它保存在 pdfFileObj</span></span><br><span class="line"><span class="keyword">import</span> PyPDF2 </span><br><span class="line">pdfFileObj = open(<span class="string">'meetingminutes.pdf'</span>, <span class="string">'rb'</span>) </span><br><span class="line">pdfReader = PyPDF2.PdfFileReader(pdfFileObj) </span><br><span class="line">pdfReader.numPages <span class="comment">## 文档的总页数</span></span><br><span class="line"><span class="comment"># 19</span></span><br><span class="line"><span class="comment">## 只提取第一页的文本</span></span><br><span class="line">pageObj = pdfReader.getPage(<span class="number">0</span>) </span><br><span class="line"><span class="comment">##  extractText()方法，返回该页文本的字符串</span></span><br><span class="line">pageObj.extractText() </span><br><span class="line"><span class="comment"># 'OOFFFFIICCIIAALL  BBOOAARRDD  MMIINNUUTTEESS   Meeting of \nMarch 7\n, 2014\n        \n     The Board of Elementary and Secondary Education shall provide leadership and \ncreate policies for education that expand opportunities for children, empower \nfamilies and communities, and advance Louisiana in an increasingly \ncompetitive glob\nal market.\n BOARD \n of ELEMENTARY\n and \n SECONDARY\n EDUCATION\n  '</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 该PDF中的文本 Charles E.“Chas”Roemer, President，在函数返回的字符串中消失了，而且空格有时候也会没有。但其实已经足够了。 </span></span><br></pre></td></tr></tbody></table></figure>
<h2 id="加密解密-pdf"><a class="markdownIt-Anchor" href="#加密解密-pdf"></a> 加密/解密 PDF</h2>
<p>某些 PDF 文档有加密功能，以防止别人阅读，只有在打开文档时提供口令才能阅读。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2 </span><br><span class="line">pdfReader = PyPDF2.PdfFileReader(open(<span class="string">'encrypted.pdf'</span>, <span class="string">'rb'</span>)) </span><br><span class="line"><span class="comment">## 判断是否加密</span></span><br><span class="line">pdfReader.isEncrypted </span><br><span class="line"><span class="comment"># True </span></span><br><span class="line">pdfReader.getPage(<span class="number">0</span>) </span><br><span class="line"><span class="comment"># Traceback (most recent call last): </span></span><br><span class="line"><span class="comment"># --snip-- </span></span><br><span class="line"><span class="comment"># PyPDF2.utils.PdfReadError: file has not been decrypted </span></span><br></pre></td></tr></tbody></table></figure>
<p>我们用一个encrypted.pdf,它已经用口令 rosebud 加密,就无法正常打开，此时我们可以用<code>pdfReader.decrypt</code>输入正确口令后打开。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pdfReader.decrypt(<span class="string">'rosebud'</span>) </span><br><span class="line"><span class="comment"># 1 </span></span><br><span class="line">pageObj = pdfReader.getPage(<span class="number">0</span>) </span><br></pre></td></tr></tbody></table></figure>
<p>使用<code>pdfWriter.encrypt('swordfish')</code>即可加密pdf。</p>
<h2 id="从已有的文档生成新的-pdf"><a class="markdownIt-Anchor" href="#从已有的文档生成新的-pdf"></a> 从已有的文档生成新的 PDF</h2>
<p>在 <code>PyPDF2</code>中，与 PdfFileReader 对象相对的是 PdfFileWriter 对象，它可以创建一个新的 PDF 文件。但 PyPDF2 不具备直接写入PDF的能力，仅可从其他 PDF 中拷贝页面、旋转页面、重叠页面和加密文件。</p>
<h3 id="拷贝页面"><a class="markdownIt-Anchor" href="#拷贝页面"></a> 拷贝页面</h3>
<p>可以利用 PyPDF2，从一个 PDF 文档拷贝页面到另一个 PDF 文档。这让你能够组合多个 PDF 文件，去除不想要的页面，或调整页面的次序。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2 </span><br><span class="line">pdf1File = open(<span class="string">'meetingminutes.pdf'</span>, <span class="string">'rb'</span>) </span><br><span class="line">pdf2File = open(<span class="string">'meetingminutes2.pdf'</span>, <span class="string">'rb'</span>) </span><br><span class="line">pdf1Reader = PyPDF2.PdfFileReader(pdf1File) </span><br><span class="line">pdf2Reader = PyPDF2.PdfFileReader(pdf2File) </span><br><span class="line"><span class="comment">## 创建一个新的 PdfFileWriter对象，表示一个空白的PDF文档</span></span><br><span class="line">pdfWriter = PyPDF2.PdfFileWriter() </span><br><span class="line"></span><br><span class="line"><span class="comment">## 从两个源 PDF 拷贝所有的页面，将它们添加到 PdfFileWriter 对象。</span></span><br><span class="line"><span class="keyword">for</span> pageNum <span class="keyword">in</span> range(pdf1Reader.numPages): </span><br><span class="line">	pageObj = pdf1Reader.getPage(pageNum)</span><br><span class="line">	pdfWriter.addPage(pageObj) </span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> pageNum <span class="keyword">in</span> range(pdf2Reader.numPages): </span><br><span class="line">    pageObj = pdf2Reader.getPage(pageNum) </span><br><span class="line">    pdfWriter.addPage(pageObj) </span><br><span class="line"><span class="comment">## 写入一个新的 PDF 文档，名为 combinedminutes.pdf</span></span><br><span class="line">pdfOutputFile = open(<span class="string">'combinedminutes.pdf'</span>, <span class="string">'wb'</span>) </span><br><span class="line">pdfWriter.write(pdfOutputFile) </span><br><span class="line">pdfOutputFile.close() </span><br><span class="line">pdf1File.close() </span><br><span class="line">pdf2File.close() </span><br></pre></td></tr></tbody></table></figure>
<h3 id="旋转页面"><a class="markdownIt-Anchor" href="#旋转页面"></a> 旋转页面</h3>
<p>利用 rotateClockwise()和 rotateCounterClockwise()方法，PDF 文档的页面也可以旋转 90 度的整数倍。</p>
<p>以下代码旋转了第一页：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2 </span><br><span class="line">minutesFile = open(<span class="string">'meetingminutes.pdf'</span>, <span class="string">'rb'</span>) </span><br><span class="line">pdfReader = PyPDF2.PdfFileReader(minutesFile) </span><br><span class="line">page = pdfReader.getPage(<span class="number">0</span>) </span><br><span class="line">page.rotateClockwise(<span class="number">90</span>) </span><br><span class="line"><span class="comment"># {'/Contents': [IndirectObject(961, 0), IndirectObject(962, 0), </span></span><br><span class="line"><span class="comment">#--snip-- </span></span><br><span class="line"><span class="comment"># } </span></span><br><span class="line">pdfWriter = PyPDF2.PdfFileWriter() </span><br><span class="line">pdfWriter.addPage(page) </span><br><span class="line">resultPdfFile = open(<span class="string">'rotatedPage.pdf'</span>, <span class="string">'wb'</span>) </span><br><span class="line">pdfWriter.write(resultPdfFile) </span><br><span class="line">resultPdfFile.close() </span><br><span class="line">minutesFile.close() </span><br></pre></td></tr></tbody></table></figure>
<h3 id="叠加页面"><a class="markdownIt-Anchor" href="#叠加页面"></a> 叠加页面</h3>
<p>PyPDF2 也可以将一页的内容叠加到另一页上，这可以用来在页面上添加公司标志、时间戳或水印。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2 </span><br><span class="line">minutesFile = open(<span class="string">'meetingminutes.pdf'</span>, <span class="string">'rb'</span>) </span><br><span class="line">pdfReader = PyPDF2.PdfFileReader(minutesFile) </span><br><span class="line">minutesFirstPage = pdfReader.getPage(<span class="number">0</span>) </span><br><span class="line">pdfWatermarkReader = PyPDF2.PdfFileReader(open(<span class="string">'watermark.pdf'</span>, <span class="string">'rb'</span>))</span><br><span class="line"><span class="comment">## 加入水印</span></span><br><span class="line">minutesFirstPage.mergePage(pdfWatermarkReader.getPage(<span class="number">0</span>)) </span><br><span class="line">pdfWriter = PyPDF2.PdfFileWriter() </span><br><span class="line"><span class="comment">## 加入加了水印的第一页</span></span><br><span class="line">pdfWriter.addPage(minutesFirstPage) </span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> pageNum <span class="keyword">in</span> range(<span class="number">1</span>, pdfReader.numPages): </span><br><span class="line">    pageObj = pdfReader.getPage(pageNum) </span><br><span class="line">    pdfWriter.addPage(pageObj) </span><br><span class="line">resultPdfFile = open(<span class="string">'watermarkedCover.pdf'</span>, <span class="string">'wb'</span>) </span><br><span class="line">pdfWriter.write(resultPdfFile) </span><br><span class="line">minutesFile.close() </span><br><span class="line">resultPdfFile.close() </span><br></pre></td></tr></tbody></table></figure>
<h3 id="从多个-pdf-中合并选择的页面"><a class="markdownIt-Anchor" href="#从多个-pdf-中合并选择的页面"></a> 从多个 PDF 中合并选择的页面</h3>
<p>目标：将所有PDF 文件合并成一个 PDF 文件，并去除每一个文件的第一个封面。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> PyPDF2, os</span><br><span class="line"></span><br><span class="line"><span class="comment">## 返回当前工作目录中所有PDF文件的列表并简单整理排序</span></span><br><span class="line">pdfFiles = []</span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> os.listdir(<span class="string">'.'</span>):</span><br><span class="line">    <span class="keyword">if</span> filename.endswith(<span class="string">'.pdf'</span>):</span><br><span class="line">        pdfFiles.append(filename)</span><br><span class="line">pdfFiles.sort()</span><br><span class="line"></span><br><span class="line">pdfWriter = PyPDF2.PdfFileWriter()</span><br><span class="line"></span><br><span class="line"><span class="comment">## 循环打开每个PDF 文件，并读取除第一页的酥油内容然后写入 </span></span><br><span class="line"><span class="keyword">for</span> filename <span class="keyword">in</span> pdfFiles:</span><br><span class="line">    pdfFileObj = open(filename, <span class="string">'rb'</span>)</span><br><span class="line">    pdfReader = PyPDF2.PdfFileReader(pdfFileObj)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> pageNum <span class="keyword">in</span> range(<span class="number">1</span>, pdfReader.numPages):</span><br><span class="line">        pageObj = pdfReader.getPage(pageNum)</span><br><span class="line">        pdfWriter.addPage(pageObj)</span><br><span class="line"></span><br><span class="line"><span class="comment">## 以写二进制的模式打开输出 PDF 文件 allminutes.pdf并写入刚才的结果</span></span><br><span class="line">pdfOutput = open(<span class="string">'allminutes.pdf'</span>, <span class="string">'wb'</span>)</span><br><span class="line">pdfWriter.write(pdfOutput)</span><br><span class="line">pdfOutput.close()</span><br></pre></td></tr></tbody></table></figure>
<h1 id="docx"><a class="markdownIt-Anchor" href="#docx"></a> Docx</h1>
<p>利用 python-docx 模块，Python 可以创建和修改.docx 的 Word 文档。</p>
<h2 id="读取-word-文档"><a class="markdownIt-Anchor" href="#读取-word-文档"></a> 读取 Word 文档</h2>
<p>Document 对象包含一个 Paragraph 对象的列表，表示文档中的段落, 每个 Paragraph 对象都包含一个 Run 对象的列表。</p>
<p><img src="https://automatetheboringstuff.com/images/000017.png" alt=""></p>
<p><img src="https://i.loli.net/2020/07/11/z9Rlesr5Y3Tvo71.jpg" alt="Docx.jpg"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> docx </span><br><span class="line">doc = docx.Document(<span class="string">'demo.docx'</span>) </span><br><span class="line">len(doc.paragraphs) </span><br><span class="line"><span class="comment"># 7 </span></span><br><span class="line">doc.paragraphs[<span class="number">0</span>].text </span><br><span class="line"><span class="comment"># 'Document Title' </span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].text </span><br><span class="line"><span class="comment"># 'A plain paragraph with some bold and some italic' </span></span><br><span class="line">len(doc.paragraphs[<span class="number">1</span>].runs) </span><br><span class="line"><span class="comment"># 4 </span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">0</span>].text </span><br><span class="line"><span class="comment"># 'A plain paragraph with some ' </span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">1</span>].text </span><br><span class="line"><span class="comment"># 'bold' </span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">2</span>].text </span><br><span class="line"><span class="comment"># ' and some ' </span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">3</span>].text </span><br><span class="line"><span class="comment"># 'italic' </span></span><br></pre></td></tr></tbody></table></figure>
<p>利用 getText()函数,可从.docx 文件中取得完整的文本 。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> docx</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getText</span>(<span class="params">filename</span>):</span></span><br><span class="line">    doc = docx.Document(filename)</span><br><span class="line">    fullText = []</span><br><span class="line">    <span class="keyword">for</span> para <span class="keyword">in</span> doc.paragraphs:</span><br><span class="line">        fullText.append(para.text)</span><br><span class="line">    <span class="comment">## 在段落间增加空行</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'\n\n'</span>.join(fullText)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="设置-paragraph-和-run-对象的样式"><a class="markdownIt-Anchor" href="#设置-paragraph-和-run-对象的样式"></a> 设置 Paragraph 和 Run 对象的样式</h2>
<blockquote>
<p>在 Windows 平台的 Word 中，你可以按下 Ctrl-Alt-Shift-S，显示样式窗口并查看样式。</p>
<p>在 OS X 上，可以点击 ViewStyles 菜单项，查看样式窗口。</p>
</blockquote>
<p>对于 Word 文档，有 3 种类型的样式：段落样式可以应用于 Paragraph 对象，字符样式可以应用于 Run 对象，链接的样式可以应用于这两种对象。</p>
<p><img src="https://s1.ax1x.com/2020/07/11/UQGinJ.jpg" alt="UQGinJ.jpg"></p>
<p>注意点：</p>
<ol>
<li>
<p>在设置 style 属性时，不要在样式名称中使用空格。</p>
</li>
<li>
<p>如果对 Run 对象应用链接的样式，需要在样式名称末尾加上’Char’。</p>
</li>
</ol>
<p><strong>Run 属性</strong></p>
<p>通过 text 属性，Run 可以进一步设置样式。每个属性都可以被设置为 3 个值之一：True（该属性总是启用，不论其他样式是否应用于该 Run）、False（该属性总是禁用）或 None（默认使用该 Run 被设置的任何属性）。</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>bold</td>
<td>文本以粗体出现</td>
</tr>
<tr>
<td>italic</td>
<td>文本以斜体出现</td>
</tr>
<tr>
<td>underline</td>
<td>文本带下划线</td>
</tr>
<tr>
<td>strike</td>
<td>文本带删除线</td>
</tr>
<tr>
<td>double_strike</td>
<td>文本带双删除线</td>
</tr>
<tr>
<td>all_caps</td>
<td>文本以大写首字母出现</td>
</tr>
<tr>
<td>small_caps</td>
<td>文本以大写首字母出现，小写字母小两个点</td>
</tr>
<tr>
<td>shadow</td>
<td>文本带阴影</td>
</tr>
<tr>
<td>outline</td>
<td>文本以轮廓线出现，而不是实心</td>
</tr>
<tr>
<td>rtl</td>
<td>文本从右至左书写</td>
</tr>
<tr>
<td>imprint</td>
<td>文本以刻入页面的方式出现</td>
</tr>
<tr>
<td>emboss</td>
<td>文本以凸出页面的方式出现</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">doc = docx.Document(<span class="string">'demo.docx'</span>)</span><br><span class="line">doc.paragraphs[<span class="number">0</span>].text</span><br><span class="line"><span class="comment"># 'Document Title'</span></span><br><span class="line">doc.paragraphs[<span class="number">0</span>].style</span><br><span class="line"><span class="comment"># 'Title'</span></span><br><span class="line">doc.paragraphs[<span class="number">0</span>].style = <span class="string">'Normal'</span></span><br><span class="line"><span class="comment">##  将Document  Title 设置为 Normal 样式</span></span><br><span class="line"></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].text</span><br><span class="line"><span class="string">'A plain paragraph with some bold and some italic'</span></span><br><span class="line">(doc.paragraphs[<span class="number">1</span>].runs[<span class="number">0</span>].text, doc.paragraphs[<span class="number">1</span>].runs[<span class="number">1</span>].text, doc.</span><br><span class="line">paragraphs[<span class="number">1</span>].runs[<span class="number">2</span>].text, doc.paragraphs[<span class="number">1</span>].runs[<span class="number">3</span>].text)</span><br><span class="line"><span class="comment"># ('A plain paragraph with some ', 'bold', ' and some ', 'italic')</span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">0</span>].style = <span class="string">'QuoteChar'</span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">1</span>].underline = <span class="literal">True</span></span><br><span class="line">doc.paragraphs[<span class="number">1</span>].runs[<span class="number">3</span>].underline = <span class="literal">True</span></span><br><span class="line">doc.save(<span class="string">'restyled.docx'</span>)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="写入-word-文档"><a class="markdownIt-Anchor" href="#写入-word-文档"></a> 写入 Word 文档</h2>
<p>这里我们直接引入官方的demo，</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> Inches</span><br><span class="line"><span class="comment">## 调用 docx.Document()，返回一个新的、空白的 Word Document 对象</span></span><br><span class="line">document = Document()</span><br><span class="line"><span class="comment">## 添加一个段落，并使用一种标题样式0-4</span></span><br><span class="line">document.add_heading(<span class="string">'Document Title'</span>, <span class="number">0</span>)</span><br><span class="line"><span class="comment">## 添加新的段落文本</span></span><br><span class="line">p = document.add_paragraph(<span class="string">'A plain paragraph having some '</span>)</span><br><span class="line">p.add_run(<span class="string">'bold'</span>).bold = <span class="literal">True</span></span><br><span class="line">p.add_run(<span class="string">' and some '</span>)</span><br><span class="line">p.add_run(<span class="string">'italic.'</span>).italic = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">document.add_heading(<span class="string">'Heading, level 1'</span>, level=<span class="number">1</span>)</span><br><span class="line">document.add_paragraph(<span class="string">'Intense quote'</span>, style=<span class="string">'Intense Quote'</span>)</span><br><span class="line"></span><br><span class="line">document.add_paragraph(</span><br><span class="line">    <span class="string">'first item in unordered list'</span>, style=<span class="string">'List Bullet'</span></span><br><span class="line">)</span><br><span class="line">document.add_paragraph(</span><br><span class="line">    <span class="string">'first item in ordered list'</span>, style=<span class="string">'List Number'</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">document.add_picture(<span class="string">'zophie.png'</span>, width=Inches(<span class="number">1.25</span>))</span><br><span class="line"></span><br><span class="line">records = (</span><br><span class="line">    (<span class="number">3</span>, <span class="string">'101'</span>, <span class="string">'Spam'</span>),</span><br><span class="line">    (<span class="number">7</span>, <span class="string">'422'</span>, <span class="string">'Eggs'</span>),</span><br><span class="line">    (<span class="number">4</span>, <span class="string">'631'</span>, <span class="string">'Spam, spam, eggs, and spam'</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">table = document.add_table(rows=<span class="number">1</span>, cols=<span class="number">3</span>)</span><br><span class="line">hdr_cells = table.rows[<span class="number">0</span>].cells</span><br><span class="line">hdr_cells[<span class="number">0</span>].text = <span class="string">'Qty'</span></span><br><span class="line">hdr_cells[<span class="number">1</span>].text = <span class="string">'Id'</span></span><br><span class="line">hdr_cells[<span class="number">2</span>].text = <span class="string">'Desc'</span></span><br><span class="line"><span class="keyword">for</span> qty, id, desc <span class="keyword">in</span> records:</span><br><span class="line">    row_cells = table.add_row().cells</span><br><span class="line">    row_cells[<span class="number">0</span>].text = str(qty)</span><br><span class="line">    row_cells[<span class="number">1</span>].text = id</span><br><span class="line">    row_cells[<span class="number">2</span>].text = desc</span><br><span class="line"><span class="comment">## 添加换页符</span></span><br><span class="line">document.add_page_break()</span><br><span class="line"></span><br><span class="line">document.save(<span class="string">'demo2.docx'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png" alt="zophie.png"></p>
<h1 id="references"><a class="markdownIt-Anchor" href="#references"></a> REFERENCES</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://automatetheboringstuff.com/chapter13/">https://automatetheboringstuff.com/chapter13/</a></li>
<li>Python编程快速上手  让繁琐工作自动化</li>
<li><a target="_blank" rel="noopener" href="http://mstamy2.github.io/PyPDF2/">http://mstamy2.github.io/PyPDF2/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mstamy2/PyPDF2">https://github.com/mstamy2/PyPDF2</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/pdfminer/pdfminer.six">https://github.com/pdfminer/pdfminer.six</a></li>
<li><a target="_blank" rel="noopener" href="https://pdfminersix.readthedocs.io/en/latest/">https://pdfminersix.readthedocs.io/en/latest/</a></li>
<li><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/98626155">https://zhuanlan.zhihu.com/p/98626155</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/python-openxml/python-docx">https://github.com/python-openxml/python-docx</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/elapouya/python-docx-template">https://github.com/elapouya/python-docx-template</a></li>
<li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/">https://python-docx.readthedocs.io/en/latest/</a></li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joaxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://u.pinsflora.xyz/Pysnista/Intro/files/py_files_pdf_word/">https://u.pinsflora.xyz/Pysnista/Intro/files/py_files_pdf_word/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Word/">Word</a><a class="post-meta__tags" href="/tags/PDF/">PDF</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Pysnista/Intro/files/py_pillow/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Python - 操作图像</div></div></a></div><div class="next-post pull-right"><a href="/Pysnista/Intro/files/py_shutil_zip/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Python Shutil &amp; Zip</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Joaxin</div><div class="author-info__description">When I close my eyes, I'm in my own ♡cean 🐟aves.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/joaxin"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/joaxin" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lotility@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">感謝訪問本站，若喜歡請收藏 ^_^</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%8C%85"><span class="toc-number">1.</span> <span class="toc-text"> 安装包</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pdf"><span class="toc-number">2.</span> <span class="toc-text"> PDF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#pdf-%E8%AF%BB%E5%8F%96%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9"><span class="toc-number">2.1.</span> <span class="toc-text"> PDF 读取文本内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86-pdf"><span class="toc-number">2.2.</span> <span class="toc-text"> 加密&#x2F;解密 PDF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E5%B7%B2%E6%9C%89%E7%9A%84%E6%96%87%E6%A1%A3%E7%94%9F%E6%88%90%E6%96%B0%E7%9A%84-pdf"><span class="toc-number">2.3.</span> <span class="toc-text"> 从已有的文档生成新的 PDF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%B7%E8%B4%9D%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.3.1.</span> <span class="toc-text"> 拷贝页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%8B%E8%BD%AC%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.3.2.</span> <span class="toc-text"> 旋转页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%A0%E5%8A%A0%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.3.3.</span> <span class="toc-text"> 叠加页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E5%A4%9A%E4%B8%AA-pdf-%E4%B8%AD%E5%90%88%E5%B9%B6%E9%80%89%E6%8B%A9%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-number">2.3.4.</span> <span class="toc-text"> 从多个 PDF 中合并选择的页面</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#docx"><span class="toc-number">3.</span> <span class="toc-text"> Docx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96-word-%E6%96%87%E6%A1%A3"><span class="toc-number">3.1.</span> <span class="toc-text"> 读取 Word 文档</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE-paragraph-%E5%92%8C-run-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%A0%B7%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text"> 设置 Paragraph 和 Run 对象的样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%99%E5%85%A5-word-%E6%96%87%E6%A1%A3"><span class="toc-number">3.3.</span> <span class="toc-text"> 写入 Word 文档</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#references"><span class="toc-number">4.</span> <span class="toc-text"> REFERENCES</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤"><img src="https://i.postimg.cc/KYPmhV8w/android-new-logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安卓 | 装机必备清单及习惯步骤"/></a><div class="content"><a class="title" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤">安卓 | 装机必备清单及习惯步骤</a><time datetime="2020-06-20T04:29:10.462Z" title="Created 2020-06-20 12:29:10">2020-06-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - 操作图像"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像">Python - 操作图像</a><time datetime="2020-05-02T16:00:00.000Z" title="Created 2020-05-03 00:00:00">2020-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word"><img src="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - PDF &amp; Word"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word">Python - PDF &amp; Word</a><time datetime="2020-04-12T16:00:00.000Z" title="Created 2020-04-13 00:00:00">2020-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Shutil &amp; Zip"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip">Python Shutil &amp; Zip</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Subprocess"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess">Python Subprocess</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Joaxin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Refine, the Life</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="fasle"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/fae45343.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'fae45343',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>