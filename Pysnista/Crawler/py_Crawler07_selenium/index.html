<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Python Web Crawle Pt.7 - Selenium | Pinsflora</title><meta name="keywords" content="Selenium"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="我们每天都与浏览器打交道，甚至工作也与浏览器相关，从浏览器抓取、提取、提交信息，成了你的家常便饭。你每天不断的重复着做一件事，完全出于习惯，就像程序化的机器人一样，那为何不交给程序呢？  WebBrowser简介 我们先利用自带的webbrowser，它可以打开浏览器并获取指定页面。 12import webbrowser webbrowser.open(&#39;https:&#x2F;&#x2F;bing.com&#x2F;&#39;)">
<meta property="og:type" content="article">
<meta property="og:title" content="Python Web Crawle Pt.7 - Selenium">
<meta property="og:url" content="https://u.pinsflora.xyz/Pysnista/Crawler/py_Crawler07_selenium/index.html">
<meta property="og:site_name" content="Pinsflora">
<meta property="og:description" content="我们每天都与浏览器打交道，甚至工作也与浏览器相关，从浏览器抓取、提取、提交信息，成了你的家常便饭。你每天不断的重复着做一件事，完全出于习惯，就像程序化的机器人一样，那为何不交给程序呢？  WebBrowser简介 我们先利用自带的webbrowser，它可以打开浏览器并获取指定页面。 12import webbrowser webbrowser.open(&#39;https:&#x2F;&#x2F;bing.com&#x2F;&#39;)">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_forests.jpg">
<meta property="article:published_time" content="2018-03-06T21:22:32.000Z">
<meta property="article:modified_time" content="2020-04-30T16:00:00.000Z">
<meta property="article:author" content="Joaxin">
<meta property="article:tag" content="Selenium">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_forests.jpg"><link rel="shortcut icon" href="/img/favicon-32x32.png"><link rel="canonical" href="https://u.pinsflora.xyz/Pysnista/Crawler/py_Crawler07_selenium/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-05-01 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">333</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">110</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">34</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_forests.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Python Web Crawle Pt.7 - Selenium</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-03-06T21:22:32.000Z" title="Created 2018-03-07 05:22:32">2018-03-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-04-30T16:00:00.000Z" title="Updated 2020-05-01 00:00:00">2020-05-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/Crawler/">Crawler</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">10.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>60min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>我们每天都与浏览器打交道，甚至工作也与浏览器相关，从浏览器抓取、提取、提交信息，成了你的家常便饭。你每天不断的重复着做一件事，完全出于习惯，就像程序化的机器人一样，那为何不交给程序呢？</p>
<h2 id="webbrowser简介"><a class="markdownIt-Anchor" href="#webbrowser简介"></a> WebBrowser简介</h2>
<p>我们先利用自带的webbrowser，它可以打开浏览器并获取指定页面。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> webbrowser </span><br><span class="line">webbrowser.open(<span class="string">'https://bing.com/'</span>) </span><br></pre></td></tr></tbody></table></figure>
<p>很简单，是不是？</p>
<p>我们再用它来完成一个稍微复杂点的动作，比如将一个地址通过命令行参数或者剪贴板，然后在 Google 地图上打开它。</p>
<p>首先，我们需要搞清楚网址是怎么构成的,比如在Google地图查找一下西湖。</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://www.google.com/maps/place/%E8%A5%BF%E6%B9%96/@30.243081,120.1258987,14z/data=!3m1!4b1!4m5!3m4!1s0x344b62c0d149f2cb:0xf0f28861cfd37ec9!8m2!3d30.2427011!4d120.1502699?hl=zh-CN</span><br></pre></td></tr></tbody></table></figure>
<p>%E8%A5%BF%E6%B9%96: 西湖的URLEncode编码,可以在这里解码(<a target="_blank" rel="noopener" href="https://tool.oschina.net/encode?type=4">https://tool.oschina.net/encode?type=4</a>)，打作英文的话，是<code>west+lake</code>(west%20lake)。</p>
<p>至于其他的参数，你不必管它，因为网站常常在 URL 中添加额外的数据，用于帮助追踪访问者或定制网站数据。</p>
<p>所以网址的构成是：<a target="_blank" rel="noopener" href="https://www.google.com/maps/place/">https://www.google.com/maps/place/</a> + Keywords， 那这样接下去就很简单了,如下：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! python3 </span></span><br><span class="line"><span class="comment"># mapIt.py</span></span><br><span class="line"><span class="keyword">import</span> webbrowser, sys </span><br><span class="line"><span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>: </span><br><span class="line">    <span class="comment">## sys.argv 变量保存了程序的文件名和命令行参数的列表，这里去掉程序的名称</span></span><br><span class="line">    address = <span class="string">' '</span>.join(sys.argv[<span class="number">1</span>:])  </span><br><span class="line"><span class="keyword">else</span>: </span><br><span class="line">    <span class="comment">## 处理剪贴板内容，从剪切板得到信息 </span></span><br><span class="line">    address = pyperclip.paste() </span><br><span class="line"> </span><br><span class="line">webbrowser.open(<span class="string">'https://www.google.com/maps/place/'</span> + address) </span><br></pre></td></tr></tbody></table></figure>
<p>在终端键入<code>python mapIt.py west lake, hangzhou</code> 即可在Google地图中打开杭州西湖的地图，此时<code>sys.argv</code> 为<code>['mapIt.py', 'west', 'lake,', 'hangzhou']</code>，如果你还不知道它的用法的话。</p>
<h2 id="selenium简介"><a class="markdownIt-Anchor" href="#selenium简介"></a> Selenium简介</h2>
<p>python的selenium 模块是个好东西，它能让我们的程序模拟真实的人类直接控制浏览器来完成复杂的网页操作。</p>
<p>首先呢，我们需要安装浏览器驱动，谷歌浏览器在这儿：<a target="_blank" rel="noopener" href="https://chromedriver.storage.googleapis.com/index.html">https://chromedriver.storage.googleapis.com/index.html</a> 火狐浏览器在这儿：<a target="_blank" rel="noopener" href="https://github.com/mozilla/geckodriver/releases%EF%BC%8C%E8%AE%B0%E5%BE%97%E4%B8%8E%E4%BD%A0%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E7%89%88%E6%9C%AC%E5%8F%B7%E7%9B%B8%E5%8C%B9%E9%85%8D%EF%BC%8C%E5%B9%B6%E6%B7%BB%E5%8A%A0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E3%80%82">https://github.com/mozilla/geckodriver/releases，记得与你的浏览器版本号相匹配，并添加环境变量。</a></p>
<h3 id="webdriver"><a class="markdownIt-Anchor" href="#webdriver"></a> Webdriver</h3>
<p>现在，我们就可以用selenium启动浏览器啦，以谷歌浏览器为例：</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">type(browser) </span><br><span class="line"><span class="comment"># &lt;class 'selenium.webdriver.chrome.webdriver.WebDriver'&gt; </span></span><br></pre></td></tr></tbody></table></figure>
<p>此时，运行程序，会自动打开一个浏览器测试窗口，此外selenium提供其他的浏览器接口：</p>
<ul>
<li>browser = webdriver.Firefox()</li>
<li>browser = webdriver.Edge()</li>
<li>browser = webdriver.Safari()</li>
<li><s>browser = webdriver.PhantomJS()</s>(已弃用)</li>
</ul>
<h3 id="在页面中寻找元素"><a class="markdownIt-Anchor" href="#在页面中寻找元素"></a> 在页面中寻找元素</h3>
<p>selenium提供成**find_element_**和 **find_elements_**方法，可以让我们快速的在页面中寻找我们需要的元素，</p>
<table>
<thead>
<tr>
<th>find_element(By.XX, “YY”)</th>
<th>find_elements(By.XX, ‘YY’)</th>
</tr>
</thead>
<tbody>
<tr>
<td>find_element_by_id</td>
<td>find_elements_by_id</td>
</tr>
<tr>
<td>find_element_by_name</td>
<td>find_elements_by_name</td>
</tr>
<tr>
<td>find_element_by_xpath</td>
<td>find_elements_by_xpath</td>
</tr>
<tr>
<td>find_element_by_link_text</td>
<td>find_elements_by_link_text</td>
</tr>
<tr>
<td>find_element_by_partial_link_text</td>
<td>find_elements_by_partial_link_text</td>
</tr>
<tr>
<td>find_element_by_tag_name</td>
<td>find_elements_by_tag_name(不区分大小写)</td>
</tr>
<tr>
<td>find_element_by_class_name</td>
<td>find_elements_by_class_name</td>
</tr>
<tr>
<td>find_element_by_css_selector</td>
<td>find_elements_by_css_selector</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">input= browser.find_element_by_css_selector(<span class="string">'#q'</span>)</span><br><span class="line">input = browser.find_element_by_xpath(<span class="string">'//*[@id="q"]'</span>)</span><br><span class="line">input = browser.find_element_by_id(<span class="string">'q'</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>如果页面上没有元素匹配该方法要查找的元素，selenium 模块就会抛出 <code>NoSuchElement</code>异常。如果你不希望这个异常让程序崩溃，就在代码中添加 try 和 except 语句。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">browser = webdriver.Chrome()</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    browser.get(<span class="string">'https://www.baidu.com'</span>)</span><br><span class="line">    input = browser.find_element_by_id(<span class="string">'kw'</span>)</span><br><span class="line"><span class="keyword">except</span>: </span><br><span class="line">    print(<span class="string">'Was not able to find an element with that id.'</span>) </span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    browser.close()</span><br></pre></td></tr></tbody></table></figure>
<p>一旦有了 WebElement 对象，我们就可以做很多事情了，</p>
<table>
<thead>
<tr>
<th>属性或方法</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>tag_name</td>
<td>标签名，例如’a’表示元素</td>
</tr>
<tr>
<td>get_attribute(name)</td>
<td>该元素 name 属性的值</td>
</tr>
<tr>
<td>text</td>
<td>该元素内的文本，例如hello中的’hello’</td>
</tr>
<tr>
<td>clear()</td>
<td>对于文本字段或文本区域元素，清除其中输入的文本</td>
</tr>
<tr>
<td>is_displayed()</td>
<td>如果该元素可见，返回 True，否则返回 False</td>
</tr>
<tr>
<td>is_enabled()</td>
<td>对于输入元素，如果该元素启用，返回 True，否则返回 False</td>
</tr>
<tr>
<td>is_selected()</td>
<td>对于复选框或单选框元素，如果该元素被选中，选择 True，否则返回 False</td>
</tr>
<tr>
<td>location</td>
<td>一个字典，包含键’x’和’y’，表示该元素在页面上的位置</td>
</tr>
</tbody>
</table>
<p>我们还可以通过<code>click()</code>方法以及键盘事件，模拟鼠标键盘与web页面的交互行为,还可调用 send_keys()方法对的<input>或<textarea>元素发送文本。&lt;/p&gt;
&lt;p&gt;我们模拟一下，自动登录到阿里巴巴网站，填写表单：&lt;/p&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;browser.get(&lt;span class="string"&gt;'https://passport.alibaba.com/icbu_login.htm'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;emailElem = browser.find_element_by_id(&lt;span class="string"&gt;'fm-login-id'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;emailElem.send_keys(&lt;span class="string"&gt;'your@emailaddress'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;passwordElem = browser.find_element_by_id(&lt;span class="string"&gt;'fm-login-password'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;passwordElem.send_keys(&lt;span class="string"&gt;'yourpassword'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;passwordElem.submit()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这里列出了常用的 Keys 变量，需从&lt;code&gt;selenium.webdriver.common.keys&lt;/code&gt;d导入，&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;属性&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Keys.DOWN, Keys.UP, Keys.LEFT,Keys.RIGHT&lt;/td&gt;
&lt;td&gt;键盘箭头键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keys.ENTER, Keys.RETURN&lt;/td&gt;
&lt;td&gt;回车和换行键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keys.HOME, Keys.END,Keys.PAGE_DOWN,Keys.PAGE_UP&lt;/td&gt;
&lt;td&gt;Home 键、End 键、PageUp 键和 Page Down 键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keys.ESCAPE, Keys.BACK_SPACE,Keys.DELETE&lt;/td&gt;
&lt;td&gt;Esc、Backspace 和字母键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keys.F1, Keys.F2, . . . , Keys.F12&lt;/td&gt;
&lt;td&gt;键盘顶部的F1到F12键&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Keys.TAB&lt;/td&gt;
&lt;td&gt;Tab 键&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;然后我们可以模拟，使浏览器滚动到页面的顶部或底部，以淘宝为例：&lt;/p&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.common.keys &lt;span class="keyword"&gt;import&lt;/span&gt; Keys &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Firefox() &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(&lt;span class="string"&gt;'https://taobao.com'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;htmlElem = browser.find_element_by_tag_name(&lt;span class="string"&gt;'html'&lt;/span&gt;) &lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;htmlElem.send_keys(Keys.END)   &lt;span class="comment"&gt;# scrolls to bottom &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;htmlElem.send_keys(Keys.HOME)   &lt;span class="comment"&gt;# scrolls to top &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.common.by &lt;span class="keyword"&gt;import&lt;/span&gt; By&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.common.keys &lt;span class="keyword"&gt;import&lt;/span&gt; Keys&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.support &lt;span class="keyword"&gt;import&lt;/span&gt; expected_conditions &lt;span class="keyword"&gt;as&lt;/span&gt; EC&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.support.wait &lt;span class="keyword"&gt;import&lt;/span&gt; WebDriverWait&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    browser.get(&lt;span class="string"&gt;'https://www.baidu.com'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    input = browser.find_element_by_id(&lt;span class="string"&gt;'kw'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    input.send_keys(&lt;span class="string"&gt;'Python'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    input.send_keys(Keys.ENTER)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    wait = WebDriverWait(browser, &lt;span class="number"&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    wait.until(EC.presence_of_element_located((By.ID, &lt;span class="string"&gt;'content_left'&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    print(browser.current_url)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    &lt;span class="comment"&gt;# print(browser.page_source)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;finally&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    browser.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&lt;selenium.webdriver.remote.webelement.WebElement (session="79a05cb08e038e55bb67cccde1a721d3", element="0.01975843313654524-2")&gt;



https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=0&amp;rsv_idx=1&amp;tn=baidu&amp;wd=Python&amp;rsv_pq=c70562c000041f36&amp;rsv_t=a076ZhTKlVhfEEZFBKnGxzdC3PrCjQyUZvslmdIJf7Lfi77BXx4uTsdjolI&amp;rqlang=cn&amp;rsv_enter=1&amp;rsv_sug3=6&amp;rsv_sug2=0&amp;inputT=476&amp;rsv_sug4=477
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="find-nodes"&gt;&lt;a class="markdownIt-Anchor" href="#find-nodes"&gt;&lt;/a&gt; Find Nodes&lt;/h2&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.common.by &lt;span class="keyword"&gt;import&lt;/span&gt; By&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.support.ui &lt;span class="keyword"&gt;import&lt;/span&gt; WebDriverWait&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver.support &lt;span class="keyword"&gt;import&lt;/span&gt; expected_conditions &lt;span class="keyword"&gt;as&lt;/span&gt; EC&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(&lt;span class="string"&gt;'https://www.taobao.com'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="comment"&gt;# browser.implicitly_wait(10)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;wait = WebDriverWait(browser, &lt;span class="number"&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;input = wait.until(EC.presence_of_element_located((By.ID, &lt;span class="string"&gt;'q'&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;button = wait.until(EC.element_to_be_clickable((By.CSS_SELECTOR, &lt;span class="string"&gt;'.btn-search'&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;print(input, button)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;input.send_keys(&lt;span class="string"&gt;'iPhone'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;time.sleep(&lt;span class="number"&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;input.clear()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;input.send_keys(&lt;span class="string"&gt;'iPad'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;button = browser.find_element_by_class_name(&lt;span class="string"&gt;'btn-search'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;button.click()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&lt;selenium.webdriver.remote.webelement.WebElement (session="83231186bd470037ae4c1216f6f09b9f", element="0.8243104404533572-1")&gt; &lt;selenium.webdriver.remote.webelement.WebElement (session="83231186bd470037ae4c1216f6f09b9f", element="0.8243104404533572-2")&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="action-chains"&gt;&lt;a class="markdownIt-Anchor" href="#action-chains"&gt;&lt;/a&gt; Action chains&lt;/h2&gt;
&lt;p&gt;ActionChains 类提供了鼠标操作的常用方法：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;perform()：执行所有 ActionChains 中存储的行为。&lt;/li&gt;
&lt;li&gt;context_click()：右击。&lt;/li&gt;
&lt;li&gt;double_click()：双击。&lt;/li&gt;
&lt;li&gt;drag_and_drop()：拖动。&lt;/li&gt;
&lt;li&gt;move_to_element()：鼠标悬停。&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.webdriver &lt;span class="keyword"&gt;import&lt;/span&gt; ActionChains&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;url = &lt;span class="string"&gt;'http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(url)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.switch_to.frame(&lt;span class="string"&gt;'iframeResult'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;source = browser.find_element_by_css_selector(&lt;span class="string"&gt;'#draggable'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;target = browser.find_element_by_css_selector(&lt;span class="string"&gt;'#droppable'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;actions = ActionChains(browser)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;actions.drag_and_drop(source, target)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;actions.perform()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&lt;selenium.webdriver.common.action_chains.ActionChains at 0x5a78df0&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(&lt;span class="string"&gt;'https://www.zhihu.com/explore'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.execute_script(&lt;span class="string"&gt;'window.scrollTo(0, document.body.scrollHeight)'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.execute_script(&lt;span class="string"&gt;'alert("To Bottom")'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id="iframe"&gt;&lt;a class="markdownIt-Anchor" href="#iframe"&gt;&lt;/a&gt; iFrame&lt;/h2&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium.common.exceptions &lt;span class="keyword"&gt;import&lt;/span&gt; NoSuchElementException&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;url = &lt;span class="string"&gt;'http://www.runoob.com/try/try.php?filename=jqueryui-api-droppable'&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(url)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.switch_to.frame(&lt;span class="string"&gt;'iframeResult'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    logo = browser.find_element_by_class_name(&lt;span class="string"&gt;'logo'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;except&lt;/span&gt; NoSuchElementException:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    print(&lt;span class="string"&gt;'NO LOGO'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.switch_to.parent_frame()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;logo = browser.find_element_by_class_name(&lt;span class="string"&gt;'logo'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;print(logo)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;print(logo.text)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;NO LOGO
&lt;selenium.webdriver.remote.webelement.WebElement (session="012ebef8608abbba12f8298de6cebb25", element="0.9532684819811263-2")&gt;
RUNOOB.COM
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id="tabs"&gt;&lt;a class="markdownIt-Anchor" href="#tabs"&gt;&lt;/a&gt; Tabs&lt;/h2&gt;
&lt;p&gt;利用以下的方法，selenium 也可以模拟点击各种浏览器按钮：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;方法&lt;/th&gt;
&lt;th&gt;~&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;browser.back()&lt;/td&gt;
&lt;td&gt;点击“返回”按钮。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;browser.forward()&lt;/td&gt;
&lt;td&gt;点击“前进”按钮。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;browser.refresh()&lt;/td&gt;
&lt;td&gt;点击“刷新”按钮。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;browser.quit()&lt;/td&gt;
&lt;td&gt;点击“关闭窗口”按钮。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="line"&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;pre&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;from&lt;/span&gt; selenium &lt;span class="keyword"&gt;import&lt;/span&gt; webdriver&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser = webdriver.Chrome()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;browser.get(&lt;span class="string"&gt;'https://www.jianshu.com/'&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="comment"&gt;# browser.execute_script('document.documentElement.scrollTop=8000')&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="comment"&gt;# browser.execute_script('alert("To Bottom")')&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;i=&lt;span class="number"&gt;100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;&lt;span class="keyword"&gt;for&lt;/span&gt; i &lt;span class="keyword"&gt;in&lt;/span&gt; range(&lt;span class="number"&gt;2&lt;/span&gt;,&lt;span class="number"&gt;90&lt;/span&gt;):   &lt;span class="comment"&gt;#也可以设置一个较大的数，一下到底&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    js = &lt;span class="string"&gt;"var q=document.documentElement.scrollTop={}"&lt;/span&gt;.format(i*&lt;span class="number"&gt;500&lt;/span&gt;)  &lt;span class="comment"&gt;#javascript语句&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    browser.execute_script(js)&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    &lt;span class="keyword"&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;        browser.find_element_by_link_text(&lt;span class="string"&gt;'阅读更多'&lt;/span&gt;).click()&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    &lt;span class="keyword"&gt;except&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;        &lt;span class="keyword"&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class="line"&gt;    time.sleep(&lt;span class="number"&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class="highlight python"&gt;&lt;table&gt;&lt;tr&gt;&lt;td class="gutter"&gt;&lt;pre&gt;&lt;span class="l