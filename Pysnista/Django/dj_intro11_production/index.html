<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Django Introduction Part11 - Deploying Django to production | Pinsflora</title><meta name="keywords" content="Django"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="pip3 install uwsgi  #gcc 123456789101112131415161718root@vultr:~# python3Python 3.6.5 (default, Apr  1 2018, 05:46:30)[GCC 7.3.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more info">
<meta property="og:type" content="article">
<meta property="og:title" content="Django Introduction Part11 - Deploying Django to production">
<meta property="og:url" content="https://u.pinsflora.xyz/Pysnista/Django/dj_intro11_production/index.html">
<meta property="og:site_name" content="Pinsflora">
<meta property="og:description" content="pip3 install uwsgi  #gcc 123456789101112131415161718root@vultr:~# python3Python 3.6.5 (default, Apr  1 2018, 05:46:30)[GCC 7.3.0] on linuxType &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more info">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg">
<meta property="article:published_time" content="2018-01-23T16:00:00.000Z">
<meta property="article:modified_time" content="2020-09-04T16:00:00.000Z">
<meta property="article:author" content="Joaxin">
<meta property="article:tag" content="Django">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg"><link rel="shortcut icon" href="/img/favicon-32x32.png"><link rel="canonical" href="https://u.pinsflora.xyz/Pysnista/Django/dj_intro11_production/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":600,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-09-05 00:00:00'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Galleries"><i class="fa-fw /gallery/"></i><span> 0</span></a></li><li><a class="site-page child" href="/Movie"><i class="fa-fw /movies/"></i><span> 1</span></a></li><li><a class="site-page child" href="/Games"><i class="fa-fw /games/"></i><span> 2</span></a></li><li><a class="site-page child" href="/Tools"><i class="fa-fw /tools/"></i><span> 3</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Django Introduction Part11 - Deploying Django to production</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-01-23T16:00:00.000Z" title="Created 2018-01-24 00:00:00">2018-01-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2020-09-04T16:00:00.000Z" title="Updated 2020-09-05 00:00:00">2020-09-05</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/">Python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Python/Django/">Django</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">4.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>28min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Django Introduction Part11 - Deploying Django to production"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>pip3 install uwsgi  #gcc</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@vultr:~# python3</span><br><span class="line">Python 3.6.5 (default, Apr  1 2018, 05:46:30)</span><br><span class="line">[GCC 7.3.0] on linux</span><br><span class="line">Type "help", "copyright", "credits" or "license" for more information.</span><br><span class="line">&gt;&gt;&gt; import django</span><br><span class="line">&gt;&gt;&gt; print(django.get_version())</span><br><span class="line">2.1</span><br><span class="line">&gt;&gt;&gt; exit()</span><br><span class="line">django-admin.py startproject pavo</span><br><span class="line">#uwsgi --http :8000 --module star.wsgi</span><br><span class="line">python3 manage.py startapp demo</span><br><span class="line">python3 manage.py migrate</span><br><span class="line">python3 manage.py runserver 0.0.0.0:8000</span><br><span class="line">python3 manage.py runserver 0.0.0.0:80</span><br><span class="line">lsof -i:8000</span><br><span class="line">kill -9 27774 27775</span><br><span class="line">sudo apt-get install unrar</span><br><span class="line">nohup python3 manage.py runserver 0.0.0.0:80 &amp;</span><br></pre></td></tr></tbody></table></figure>
<p>DisallowedHost at /<br>
Invalid HTTP_HOST header: ‘45.77.201.180:8000’. You may need to add ‘45.77.201.180’ to ALLOWED_HOSTS.<br>
Request Method:	GET<br>
Request URL:	<a target="_blank" rel="noopener" href="http://45.77.201.180:8000/">http://45.77.201.180:8000/</a><br>
Django Version:	2.1<br>
Exception Type:	DisallowedHost<br>
Exception Value:	<br>
Invalid HTTP_HOST header: ‘45.77.201.180:8000’. You may need to add ‘45.77.201.180’ to ALLOWED_HOSTS.<br>
Exception Location:	/usr/local/lib/python3.6/dist-packages/django/http/request.py in get_host, line 106<br>
Python Executable:	/usr/bin/python3<br>
Python Version:	3.6.5<br>
Python Path:	<br>
[’/home/sanring’,<br>
‘/usr/lib/python36.zip’,<br>
‘/usr/lib/python3.6’,<br>
‘/usr/lib/python3.6/lib-dynload’,<br>
‘/usr/local/lib/python3.6/dist-packages’,<br>
‘/usr/lib/python3/dist-packages’]<br>
Server time:	Thu, 30 Aug 2018 06:38:20 +0000</p>
<p>修改settings.py这个文件里面的配置文件：<br>
在 ALLOWED_HOSTS = [’’] 里面的中括号里面添加*,如下:<br>
ALLOWED_HOSTS = [’*’]</p>
<p>uwsgi --http :80 --chdir /path/to/project --home=/path/to/env --module project.wsgi</p>
<h2 id="overview"><a class="markdownIt-Anchor" href="#overview"></a> Overview</h2>
<p>Once your site is finished (or finished “enough” to start public testing) you’re going to need to host it somewhere more public and accessible than your personal development computer.</p>
<p>Up to now you’ve been working in a development environment, using the Django development web server to share your site to the local browser/network, and running your website with (insecure) development settings that expose debug and other private information. Before you can host a website externally you’re first going to have to:</p>
<ul>
<li>Make a few changes to your project settings.</li>
<li>Choose an environment for hosting the Django app.</li>
<li>Choose an environment for hosting any static files.</li>
<li>Set up a production-level infrastructure for serving your website.</li>
</ul>
<h2 id="what-is-a-production-environment"><a class="markdownIt-Anchor" href="#what-is-a-production-environment"></a> What is a production environment?</h2>
<p>The production environment is the environment provided by the server computer where you will run your website for external consumption. The environment includes:</p>
<ul>
<li>Computer hardware on which the website runs.</li>
<li>Operating system (e.g. Linux, Windows).</li>
<li>Programming language runtime and framework libraries on top of which your website is written.</li>
<li>Web server used to serve pages and other content (e.g. Nginx, Apache).</li>
<li>Application server that passes “dynamic” requests between your Django website and the webserver.</li>
<li>Databases on which your website is dependent.</li>
</ul>
<p><strong>Note</strong>: Depending on how your production is configured you might also have a reverse proxy, load balancer, etc.</p>
<p>The server computer could be located on your premises and connected to the Internet by a fast link, but it is far more common to use a computer that is hosted “in the cloud”. What this actually means is that your code is run on some remote computer (or possibly a “virtual” computer) in your hosting company’s data center(s). The remote server will usually offer some guaranteed level of computing resources (e.g. CPU, RAM, storage memory, etc.) and Internet connectivity for a certain price.</p>
<p>This sort of remotely accessible computing/networking hardware is referred to as <em>Infrastructure as a Service (IaaS)</em>. Many IaaS vendors provide options to preinstall a particular operating system, onto which you must install the other components of your production environment. Other vendors allow you to select more fully-featured environments, perhaps including a complete Django and web-server setup.</p>
<p>Other hosting providers support Django as part of a <em>Platform as a Service</em> (PaaS) offering. In this sort of hosting you don’t need to worry about most of your production environment (web server, application server, load balancers) as the host platform takes care of those for you (along with most of what you need to do in order to scale your application). That makes deployment quite easy, because you just need to concentrate on your web application and not all the other server infrastructure.</p>
<p>Some developers will choose the increased flexibility provided by IaaS over PaaS, while others will appreciate the reduced maintenance overhead and easier scaling of PaaS. When you’re getting started, setting up your website on a PaaS system is much easier, and so that is what we’ll do in this tutorial.</p>
<p><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/py/dj/lass-sass-pass.png" alt="lass-sass-pass.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/py/dj/lass-sass-pass.jpg" alt="img"></p>
<h2 id="choosing-a-hosting-provider"><a class="markdownIt-Anchor" href="#choosing-a-hosting-provider"></a> Choosing a hosting provider</h2>
<p>There are well over 100 hosting providers that are known to either actively support or work well with Django (you can find a fairly extensive list at <a target="_blank" rel="noopener" href="http://djangofriendly.com">Djangofriendly hosts</a>). These vendors provide different types of environments (IaaS, PaaS), and different levels of computing and network resources at different prices.</p>
<p>Some of the things to consider when choosing a host:</p>
<ul>
<li>How busy your site is likely to be and the cost of data and computing resources required to meet that demand.</li>
<li>Level of support for scaling horizontally (adding more machines) and vertically (upgrading to more powerful machines) and the costs of doing so.</li>
<li>Where the supplier has data centres, and hence where access is likely to be fastest.</li>
<li>The host’s historical uptime and downtime performance.</li>
<li>Tools provided for managing the site — are they easy to use and are they secure (e.g. SFTP vs FTP).</li>
<li>Inbuilt frameworks for monitoring your server.</li>
<li>Known limitations. Some hosts will deliberately block certain services (e.g. email). Others offer only a certain number of hours of “live time” in some price tiers, or only offer a small amount of storage.</li>
<li>Additional benefits. Some providers will offer free domain names and support for SSL certificates that you would otherwise have to pay for.</li>
<li>Whether the “free” tier you’re relying on expires over time, and whether the cost of mig rating to a more expensive tier means you would have been better off using some other service in the first place!</li>
</ul>
<p>The good news when you’re starting out is that there are quite a few sites that provide “evaluation”, “developer”, or “hobbyist” computing environments for “free”. These are always fairly resource constrained/limited environments, and you do need to be aware that they may expire after some introductory period. They are however great for testing low traffic sites in a real environment, and can provide an easy migration to paying for more resources when your site gets busier. Popular choices in this category include <a target="_blank" rel="noopener" href="https://www.heroku.com/">Heroku</a>, <a target="_blank" rel="noopener" href="https://www.pythonanywhere.com/">Python Anywhere</a>, <a target="_blank" rel="noopener" href="http://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/billing-free-tier.html">Amazon Web Services</a>, <a target="_blank" rel="noopener" href="https://azure.microsoft.com/en-us/pricing/details/app-service/">Microsoft Azure</a>, etc.</p>
<h2 id="getting-your-website-ready-to-publish"><a class="markdownIt-Anchor" href="#getting-your-website-ready-to-publish"></a> Getting your website ready to publish</h2>
<p>Many of the Django project settings (specified in <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong>) should be different for production, either for security or performance reasons.</p>
<p><strong>Tip:</strong> It is common to have a separate <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong> file for production, and to import sensitive settings from a separate file or an environment variable. This file should then be protected, even if the rest of the source code is available on a public repository.</p>
<p>The critical settings that you must check are:</p>
<ul>
<li>
<p>DEBUG</p>
<p>This should be set as <code>False</code> in production (<code>DEBUG = False</code>). This stops the sensitive/confidential debug trace and variable information from being displayed.</p>
</li>
<li>
<p>SECRET_KEY</p>
<p>This is a large random value used for CSRF protection etc. It is important that the key used in production is not in source control or accessible outside the production server. The Django documents suggest that this might best be loaded from an environment variable or read from a serve-only file.</p>
</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># Read SECRET_KEY from an environment variable</span><br><span class="line">  import os</span><br><span class="line">  SECRET_KEY = os.environ['SECRET_KEY']</span><br><span class="line"></span><br><span class="line">  # OR</span><br><span class="line"></span><br><span class="line">  # Read secret key from a file</span><br><span class="line">  with open('/etc/secret_key.txt') as f:</span><br><span class="line">      SECRET_KEY = f.read().strip()</span><br></pre></td></tr></tbody></table></figure>
<p>Let’s change the <em>LocalLibrary</em> application so that we read our <code>SECRET_KEY</code> and <code>DEBUG</code>variables from environment variables if they are defined, but otherwise use the default values in the configuration file.</p>
<p>Open <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong>, disable the original <code>SECRET_KEY</code> configuration and add the new lines as shown below in <strong>bold</strong>. During development no environment variable will be specified for the key, so the default value will be used (it shouldn’t matter what key you use here, or if the key “leaks”, because you won’t use it in production).</p>
  <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># SECURITY WARNING: keep the secret key used in production secret!</span><br><span class="line"># SECRET_KEY = 'cg#p$g+j9tax!#a3cup@1$8obt2_+&amp;k3q+pmu)5%asj6yjpkag'</span><br><span class="line">import os</span><br><span class="line">SECRET_KEY = os.environ.get('DJANGO_SECRET_KEY', 'cg#p$g+j9tax!#a3cup@1$8obt2_+&amp;k3q+pmu)5%asj6yjpkag')</span><br></pre></td></tr></tbody></table></figure>
<p>Then comment out the existing <code>DEBUG</code> setting and add the new line shown below.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># SECURITY WARNING: don't run with debug turned on in production!</span><br><span class="line"># DEBUG = True</span><br><span class="line">DEBUG = os.environ.get('DJANGO_DEBUG', '') != 'False'</span><br></pre></td></tr></tbody></table></figure>
<p>You can set the environment variable to False by issuing the following command:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> DJANGO_DEBUG=False</span><br></pre></td></tr></tbody></table></figure>
<p>we can also use decouple to simplify this.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install python-decouple</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">from decouple import config</span><br><span class="line"># SECURITY WARNING: keep the secret key used in production secret!</span><br><span class="line">SECRET_KEY = config('SECRET_KEY')</span><br><span class="line"></span><br><span class="line"># SECURITY WARNING: don't run with debug turned on in production!</span><br><span class="line">DEBUG = config('DEBUG', default = False, cast = bool)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="heroku"><a class="markdownIt-Anchor" href="#heroku"></a> Heroku</h2>
<p>This section provides a practical demonstration of how to install on the <a target="_blank" rel="noopener" href="http://heroku.com/">Heroku PaaS cloud</a>.</p>
<h3 id="why-heroku"><a class="markdownIt-Anchor" href="#why-heroku"></a> Why Heroku?</h3>
<p>Heroku is one of the longest running and popular cloud-based PaaS services. It originally supported only Ruby apps, but now can be used to host apps from many programming environments, including Django!</p>
<p>We are choosing to use Heroku for several reasons:</p>
<ul>
<li>Heroku has a <a target="_blank" rel="noopener" href="https://www.heroku.com/pricing">free tier</a> that is <em>really</em> free (albeit with some limitations).</li>
<li>As a PaaS, Heroku takes care of a lot of the web infrastructure for us. This makes it much easier to get started, because you don’t worry about servers, load balancers, reverse proxies, or any of the other web infrastructure that Heroku provides for us under the hood.</li>
<li>While it does have some limitations these will not affect this particular application. For example:
<ul>
<li>Heroku provides only short-lived storage so user-uploaded files cannot safely be stored on Heroku itself.</li>
<li>The free tier will sleep an inactive web app if there are no requests within a half hour period. The site may then take several seconds to respond when it is woken up.</li>
<li>The free tier limits the time that your site is running to a certain amount of hours every month (not including the time that the site is “asleep”). This is fine for a low use/demonstration site, but will not be suitable if 100% uptime is required.</li>
<li>Other limitations are listed in <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/limits">Limits</a> (Heroku docs).</li>
</ul>
</li>
<li>Mostly it just works, and if you end up loving it, scaling your app is very easy.</li>
</ul>
<p>While Heroku is perfect for hosting this demonstration it may not be perfect for your real website. Heroku makes things easy to set up and scale, at the cost of being less flexible, and potentially a lot more expensive once you get out of the free tier.</p>
<h3 id="how-does-heroku-work"><a class="markdownIt-Anchor" href="#how-does-heroku-work"></a> How does Heroku work?</h3>
<p>Heroku runs Django websites within one or more “<a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/dynos">Dynos</a>”, which are isolated, virtualized Unix containers that provide the environment required to run an application. The dynos are completely isolated and have an <em>ephemeral</em> file system (a short-lived file system that is cleaned/emptied every time the dyno restarts). The only thing that dynos share by default are application <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/config-vars">configuration variables</a>. Heroku internally uses a load balancer to distribute web traffic to all “web” dynos. Since nothing is shared between them, Heroku can scale an app horizontally simply by adding more dynos (though of course you may also need to scale your database to accept additional connections).</p>
<p>Because the file system is ephemeral you can’t install services required by your application directly (e.g. databases, queues, caching systems, storage, email services, etc). Instead Heroku web applications use backing services provided as independent “add-ons” by Heroku or 3rd parties. Once attached to your web application, the dynos access the services using information contained in application configuration variables.</p>
<p>In order to execute your application Heroku needs to be able to set up the appropriate environment and dependencies, and also understand how it is launched. For Django apps we provide this information in a number of text files:</p>
<ul>
<li><strong>runtime.txt</strong>: the programming language and version to use.</li>
<li><strong>requirements.txt</strong>: the Python component dependencies, including Django.</li>
<li><strong>Procfile</strong>: A list of processes to be executed to start the web application. For Django this will usually be the Gunicorn web application server (with a <code>.wsgi</code> script).</li>
<li><strong><a target="_blank" rel="noopener" href="http://wsgi.py">wsgi.py</a></strong>: <a target="_blank" rel="noopener" href="http://wsgi.readthedocs.io/en/latest/what.html">WSGI</a> configuration to call our Django application in the Heroku environment.</li>
</ul>
<p>Developers interact with Heroku using a special client app/terminal, which is much like a Unix bash script. This allows you to upload code that is stored in a git repository, inspect the running processes, see logs, set configuration variables and much more!</p>
<p>In order to get our application to work on Heroku we’ll need to put our Django web application into a git repository, add the files above, integrate with a database add-on, and make changes to properly handle static files.</p>
<p>Once we’ve done all that we can set up a Heroku account, get the Heroku client, and use it to install our website.</p>
<h3 id="create-the-app-for-heroku"><a class="markdownIt-Anchor" href="#create-the-app-for-heroku"></a> Create the app for Heroku</h3>
<h4 id="procfile"><a class="markdownIt-Anchor" href="#procfile"></a> Procfile</h4>
<p>Create the file <code>Procfile</code> (no extension) in the root of your GitHub repository to declare the application’s process types and entry points. Copy the following text into it:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web: gunicorn movie.wsgi --log-file -</span><br></pre></td></tr></tbody></table></figure>
<p>The “<code>web:</code>” tells Heroku that this is a web dyno and can be sent HTTP traffic. The process to start in this dyno is <em>gunicorn</em>, which is a popular web application server that Heroku recommends.</p>
<h4 id="gunicorn"><a class="markdownIt-Anchor" href="#gunicorn"></a> Gunicorn</h4>
<p><a target="_blank" rel="noopener" href="http://gunicorn.org/">Gunicorn</a> is the recommended HTTP server for use with Django on Heroku (as referenced in the Procfile above). It is a pure-Python HTTP server for WSGI applications that can run multiple Python concurrent processes within a single dyno.</p>
<p>While we won’t need it serve our application during development, we’ll install it so that it becomes part of our requirements for Heroku to set up on the remote server.</p>
<p>Install <em>Gunicorn</em> locally on the command line using <em>pip</em>：</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install gunicorn</span><br></pre></td></tr></tbody></table></figure>
<h4 id="database-configuration"><a class="markdownIt-Anchor" href="#database-configuration"></a> Database configuration</h4>
<p>We can’t use the default SQLite database on Heroku because it is file-based, and it would be deleted from the ephemeral file system every time the application restarts (typically once a day, and every time the application or its configuration variables are changed).</p>
<p>The Heroku mechanism for handling this situation is to use a <a target="_blank" rel="noopener" href="https://elements.heroku.com/addons#data-stores">database add-on</a> and configure the web application using information from an environment <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/config-vars">configuration variable</a>, set by the add-on. There are quite a lot of database options, but we’ll use the <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/heroku-postgres-plans#plan-tiers">hobby tier</a> of the <em>Heroku postgres</em> database as this is free, supported by Django, and automatically added to our new Heroku apps when using the free hobby dyno plan tier.</p>
<p>The database connection information is supplied to the web dyno using a configuration variable named <code>DATABASE_URL</code>. Rather than hard-coding this information into Django, Heroku recommends that developers use the <a target="_blank" rel="noopener" href="https://warehouse.python.org/project/dj-database-url/">dj-database-url</a> package to parse the <code>DATABASE_URL</code>environment variable and automatically convert it to Django’s desired configuration format. In addition to installing the <em>dj-database-url</em> package we’ll also need to install <a target="_blank" rel="noopener" href="http://initd.org/psycopg/">psycopg2</a>, as Django needs this to interact with Postgres databases.</p>
<p><strong>dj-database-url (Django database configuration from environment variable)</strong></p>
<p>Install <em>dj-database-url</em> locally  for Heroku to set up on the remote server:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install dj-database-url</span><br></pre></td></tr></tbody></table></figure>
<p><strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong></p>
<p>Open <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong> and copy the following configuration into the bottom of the file:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># Heroku: Update database configuration from $DATABASE_URL.</span><br><span class="line">import dj_database_url</span><br><span class="line">db_from_env = dj_database_url.config(conn_max_age=500)</span><br><span class="line">DATABASES['default'].update(db_from_env)</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Note:</strong></p>
<ul>
<li>We’ll still be using SQLite during development because the <code>DATABASE_URL</code>environment variable will not be set on our development computer.</li>
<li>The value <code>conn_max_age=500</code> makes the connection persistent, which is far more efficient than recreating the connection on every request cycle. However, this is optional and can be removed if needed.</li>
</ul>
<p><strong>psycopg2 (Python Postgres database support)</strong></p>
<p>Django needs <em>psycopg2</em> to work with Postgres databases and you will need to add this to the requirements.txt for Heroku to set this up on the remote server.</p>
<p>Django will use our <code>SQLite</code> database locally by default, because the <code>DATABASE_URL</code>environment variable isn’t set in our local environment. If you want to switch to Postgres completely and use our Heroku free tier database for both development and production then you can. For example, to install psycopg2 and its dependencies locally on a Linux-based system you would use the following bash/terminal commands:</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install python-pip python-dev libpq-dev postgresql postgresql-contrib</span><br><span class="line">pip3 install psycopg2-binary</span><br></pre></td></tr></tbody></table></figure>
<p>Installation instructions for the other platforms can be found on the <a target="_blank" rel="noopener" href="http://initd.org/psycopg/docs/install.html">psycopg2 website here</a>.</p>
<p>However, you don’t need to do this — you don’t need PostgreSQL active on the local computer, as long as you give it to Heroku as a requirement, in <code>requirements.txt</code> (see below).</p>
<h4 id="serving-static-files-in-production"><a class="markdownIt-Anchor" href="#serving-static-files-in-production"></a> Serving static files in production</h4>
<p>During development we used Django and the Django development web server to serve our static files (CSS, JavaScript, etc.). In a production environment we instead typically serve static files from a content delivery network (CDN) or the web server.</p>
<p><strong>Note:</strong> Serving static files via Django/web application is inefficient because the requests have to pass through unnecessary additional code (Django) rather than being handled directly by the web server or a completely separate CDN. While this doesn’t matter for local use during development, it would have a significant performance impact if we were to use the same approach in production.</p>
<p>To make it easy to host static files separately from the Django web application, Django provides the <em>collectstatic</em> tool to collect these files for deployment (there is a settings variable that defines where the files should be collected when <em>collectstatic</em> is run). Django templates refer to the hosting location of the static files relative to a settings variable (<code>STATIC_URL</code>), so that this can be changed if the static files are moved to another host/server.</p>
<p>The relevant setting variables are:</p>
<ul>
<li><code>STATIC_URL</code>: This is the base URL location from which static files will be served, for example on a CDN.</li>
<li><code>STATIC_ROOT</code>: This is the absolute path to a directory where Django’s “collectstatic” tool will gather any static files referenced in our templates. Once collected, these can then be uploaded as a group to wherever the files are to be hosted.</li>
<li><code>STATICFILES_DIRS</code>: This lists additional directories that Django’s collectstatic tool should search for static files.</li>
</ul>
<h4 id="whitenoise"><a class="markdownIt-Anchor" href="#whitenoise"></a> Whitenoise</h4>
<p>There are many ways to serve static files in production (we saw the relevant Django settings in the previous sections). Heroku recommends using the <a target="_blank" rel="noopener" href="https://warehouse.python.org/project/whitenoise/">WhiteNoise</a> project for serving of static assets directly from Gunicorn in production.</p>
<p><strong>Note:</strong> Heroku automatically calls <em>collectstatic</em> and prepares your static files for use by WhiteNoise after it uploads your application. Check out <a target="_blank" rel="noopener" href="https://warehouse.python.org/project/whitenoise/">WhiteNoise</a> documentation for an explanation of how it works and why the implementation is a relatively efficient method for serving these files.</p>
<p>The steps to set up <em>WhiteNoise</em> to use with the project are <a target="_blank" rel="noopener" href="http://whitenoise.evans.io/en/stable/django.html">given here</a> :</p>
<p><strong>WhiteNoise</strong></p>
<p>Install whitenoise locally using the following command:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip3 install whitenoise</span><br></pre></td></tr></tbody></table></figure>
<p><strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong></p>
<p>To install <em>WhiteNoise</em> into your Django application, open <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong>, find the <code>MIDDLEWARE</code> setting and add the <code>WhiteNoiseMiddleware</code> near the top of the list, just below the <code>SecurityMiddleware</code>:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">MIDDLEWARE = [</span><br><span class="line">    'django.middleware.security.SecurityMiddleware',</span><br><span class="line">    'whitenoise.middleware.WhiteNoiseMiddleware',</span><br><span class="line">    'django.contrib.sessions.middleware.SessionMiddleware',</span><br><span class="line">    'django.middleware.common.CommonMiddleware',</span><br><span class="line">    'django.middleware.csrf.CsrfViewMiddleware',</span><br><span class="line">    'django.contrib.auth.middleware.AuthenticationMiddleware',</span><br><span class="line">    'django.contrib.messages.middleware.MessageMiddleware',</span><br><span class="line">    'django.middleware.clickjacking.XFrameOptionsMiddleware',</span><br><span class="line">]</span><br></pre></td></tr></tbody></table></figure>
<p>Optionally, you can reduce the size of the static files when they are served (this is more efficient). Just add the following to the bottom of <strong><a target="_blank" rel="noopener" href="http://settings.py">settings.py</a></strong>:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Simplified static file serving.</span><br><span class="line"># https://warehouse.python.org/project/whitenoise/</span><br><span class="line">STATICFILES_STORAGE = 'whitenoise.storage.CompressedManifestStaticFilesStorage'</span><br></pre></td></tr></tbody></table></figure>
<h4 id="requirements-runtime"><a class="markdownIt-Anchor" href="#requirements-runtime"></a> Requirements &amp; Runtime</h4>
<p>The Python requirements of your web application must be stored in a file <strong>requirements.txt</strong> in the root of your repository. Heroku will then install these automatically when it rebuilds your environment. You can create this file using <em>pip</em> on the command line (run the following in the repo root):</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 freeze &gt; requirements.txt</span><br></pre></td></tr></tbody></table></figure>
<p>After installing all the different dependencies above, your <strong>requirements.txt</strong> file should have <em>at least</em> these items listed (though the version numbers may be different). Please delete any other dependencies not listed below, unless you’ve explicitly added them for this application.</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dj-database-url</span><br><span class="line">Django</span><br><span class="line">gunicorn</span><br><span class="line">psycopg2-binary</span><br><span class="line">whitenoise</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-r requirements-dev.txt</span><br><span class="line">gunicorn</span><br><span class="line">psycopg2</span><br><span class="line">whitenoise</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dj-database-url</span><br><span class="line">Django</span><br></pre></td></tr></tbody></table></figure>
<p>Make sure that a <strong>psycopg2</strong> line like the one above is present! Even if you didn’t install this locally then you should still add this to the <strong>requirements.txt</strong>.</p>
<p>The <strong>runtime.txt</strong> file, if defined, tells Heroku which programming language to use. Create the file in the root of the repo and add the following text:</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python-3.7.6</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Note:</strong> Heroku only supports a small number of <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/python-support#supported-python-runtimes">Python runtimes</a> (at time of writing, this includes the one above). Heroku will use a supported runtime irrespective of the value specified in this file.</p>
<h4 id="save-changes-to-github-and-re-test"><a class="markdownIt-Anchor" href="#save-changes-to-github-and-re-test"></a> Save changes to Github and re-test</h4>
<p>Next lets save all our changes to Github. In the terminal (whilst inside our repository), enter the following commands:</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add -A</span><br><span class="line">git commit -m "Added files and changes required for deployment to heroku"</span><br><span class="line">git push origin master</span><br></pre></td></tr></tbody></table></figure>
<p>Before we proceed, lets test the site again locally and make sure it wasn’t affected by any of our changes above. Run the development web server as usual and then check the site still works as you expect on your browser.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 manage.py runserver</span><br></pre></td></tr></tbody></table></figure>
<p>We should now be ready to start deploying LocalLibrary on Heroku.</p>
<h3 id="create-and-upload-the-website"><a class="markdownIt-Anchor" href="#create-and-upload-the-website"></a> Create and upload the website</h3>
<p>To create the app we run the “create” command in the root directory of our repository. This creates a git remote (“pointer to a remote repository”) named <em>heroku</em> in our local git environment.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku create</span><br></pre></td></tr></tbody></table></figure>
<p><strong>Note:</strong> You can name the remote if you like by specifying a value after “create”. If you don’t then you’ll get a random name. The name is used in the default URL.</p>
<p>We can then push our app to the Heroku repository as shown below. This will upload the app, package it in a dyno, run collectstatic, and start the site.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git push heroku master</span><br></pre></td></tr></tbody></table></figure>
<p>If we’re lucky, the app is now “running” on the site, but it won’t be working properly because we haven’t set up the database tables for use by our application. To do this we need to use the <code>heroku run</code> command and start a “<a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/deploying-python#one-off-dynos">one off dyno</a>” to perform a migrate operation. Enter the following command in your terminal:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku run python manage.py migrate</span><br></pre></td></tr></tbody></table></figure>
<p>We’re also going to need to be able to add books and authors, so lets also create our administration superuser, again using a one-off dyno:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku run python manage.py createsuperuser</span><br></pre></td></tr></tbody></table></figure>
<p>Once this is complete, we can look at the site. It should work, although it won’t have any books in it yet. To open your browser to the new website, use the command:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku open</span><br></pre></td></tr></tbody></table></figure>
<h3 id="managing-addons"><a class="markdownIt-Anchor" href="#managing-addons"></a> Managing addons</h3>
<p>You can check out the add-ons to your app using the <code>heroku addons</code> command. This will list all addons, and their price tier and state.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&gt; heroku addons</span><br><span class="line"></span><br><span class="line">Add-on                                     Plan       Price  State</span><br><span class="line">─────────────────────────────────────────  ─────────  ─────  ───────</span><br><span class="line">heroku-postgresql (postgresql-flat-26536)  hobby-dev  free   created</span><br><span class="line"> └─ as DATABASE</span><br></pre></td></tr></tbody></table></figure>
<p>Here we see that we have just one add-on, the postgres SQL database. This is free, and was created automatically when we created the app. You can open a web page to examine the database add-on (or any other add-on) in more detail using the following command:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">heroku addons:open heroku-postgresql</span><br></pre></td></tr></tbody></table></figure>
<p>Other commands allow you to create, destroy, upgrade and downgrade addons (using a similar syntax to opening). For more information see <a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/managing-add-ons">Managing Add-ons</a> (Heroku docs).</p>
<h3 id="setting-configuration-variables"><a class="markdownIt-Anchor" href="#setting-configuration-variables"></a> Setting configuration variables</h3>
<p>You can check out the configuration variables for the site using the <code>heroku config</code> command. Below you can see that we have just one variable, the <code>DATABASE_URL</code> used to configure our database.</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; heroku config</span><br><span class="line"></span><br><span class="line">=== locallibrary Config Vars</span><br><span class="line">DATABASE_URL: postgres://uzfnbcyxidzgrl:j2jkUFDF6OGGqxkgg7Hk3ilbZI@ec2-54-243-201-144.compute-1.amazonaws.com:5432/dbftm4qgh3kda3</span><br></pre></td></tr></tbody></table></figure>
<p>If you recall from the section on <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Django/Deployment#Getting_your_website_ready_to_publish">getting the website ready to publish</a>, we have to set environment variables for <code>DJANGO_SECRET_KEY</code> and <code>DJANGO_DEBUG</code>. Let’s do this now.</p>
<p><strong>Note:</strong> The secret key needs to be really secret! One way to generate a new key is to use the <a target="_blank" rel="noopener" href="https://www.miniwebtool.com/django-secret-key-generator/">Django Secret Key Generator</a>.</p>
<p>We set <code>DJANGO_SECRET_KEY</code> using the <code>config:set</code> command (as shown below). Remember to use your own secret key!</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; heroku config:<span class="built_in">set</span> DJANGO_SECRET_KEY=<span class="string">'eu09(ilk6@4sfdofb=b_2ht@vad*$ehh9-)3u_83+y%(+phh&amp;='</span></span><br><span class="line"></span><br><span class="line">Setting DJANGO_SECRET_KEY and restarting locallibrary... <span class="keyword">done</span>, v7</span><br><span class="line">DJANGO_SECRET_KEY: eu09(ilk6@4sfdofb=b_2ht@vad*<span class="variable">$ehh9</span>-)3u_83+y%(+phh</span><br></pre></td></tr></tbody></table></figure>
<p>We similarly set <code>DJANGO_DEBUG</code>:</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; heroku config:set DJANGO_DEBUG=</span><br><span class="line"></span><br><span class="line">Setting DJANGO_DEBUG and restarting locallibrary... done, v8</span><br></pre></td></tr></tbody></table></figure>
<p>If you visit the site now you’ll get a “Bad request” error, because the <a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/ref/settings/#allowed-hosts">ALLOWED_HOSTS</a>setting is <em>required</em> if you have <code>DEBUG=False</code> (as a security measure). Open <strong>/locallibrary/settings.py</strong> and change the <code>ALLOWED_HOSTS</code> setting to include your base app url (e.g. ‘<a target="_blank" rel="noopener" href="http://locallibrary1234.herokuapp.com">locallibrary1234.herokuapp.com</a>’) and the URL you normally use on your local development server.</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALLOWED_HOSTS = ['&lt;your app URL without the https:// prefix&gt;.herokuapp.com','127.0.0.1']</span><br><span class="line"># For example: </span><br><span class="line"># ALLOWED_HOSTS = ['fathomless-scrubland-30645.herokuapp.com', '127.0.0.1']</span><br></pre></td></tr></tbody></table></figure>
<p>Then save your settings and commit them to your Github repo and to Heroku:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git add -A</span><br><span class="line">git commit -m <span class="string">'Update ALLOWED_HOSTS with site and development server URL'</span></span><br><span class="line">git push origin master</span><br><span class="line">git push heroku master</span><br></pre></td></tr></tbody></table></figure>
<p>After the site update to Heroku completes, enter an URL that does not exist (e.g. <strong>/catalog/doesnotexist/</strong>). Previously this would have displayed a detailed debug page, but now you should just see a simple “Not Found” page.</p>
<h3 id="debugging"><a class="markdownIt-Anchor" href="#debugging"></a> Debugging</h3>
<p>The Heroku client provides a few tools for debugging:</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Show current logs</span></span><br><span class="line">heroku logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show current logs and keep updating with any new results</span></span><br><span class="line">heroku logs --tail</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add additional logging for collectstatic (this tool is run automatically during a build)</span></span><br><span class="line">heroku config:<span class="built_in">set</span> DEBUG_COLLECTSTATIC=1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Display dyno status</span></span><br><span class="line">heroku ps</span><br></pre></td></tr></tbody></table></figure>
<p>If you need more information than these can provide you will need to start looking into <a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/topics/logging/">Django Logging</a>.</p>
<h2 id="references"><a class="markdownIt-Anchor" href="#references"></a> REFERENCES</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/howto/deployment/checklist/">https://docs.djangoproject.com/en/3.1/howto/deployment/checklist/</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/howto/static-files/deployment/">Deploying static files</a> (Django docs)</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/howto/deployment/wsgi/">How to deploy with WSGI</a> (Django docs)</li>
</ul>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/howto/deployment/wsgi/modwsgi/">How to use Django with Apache and mod_wsgi</a> (Django docs)</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.djangoproject.com/en/3.1/howto/deployment/wsgi/gunicorn/">How to use Django with Gunicorn</a> (Django docs)</li>
</ul>
</li>
<li>
<p>Heroku</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/how-heroku-works">How Heroku works</a></li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/django-app-configuration">Configuring Django apps for Heroku</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/getting-started-with-python#introduction">Getting Started on Heroku with Django</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/django-assets">Django and Static Assets</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/python-concurrency-and-database-connections">Concurrency and Database Connections in Django</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/how-heroku-works">How Heroku works</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/dynos">Dynos and the Dyno Manager</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/config-vars">Configuration and Config Vars</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/limits">Limits</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/python-gunicorn">Deploying Python applications with Gunicorn</a> (Heroku docs)</li>
<li><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/articles/deploying-python">Deploying Python and Django apps on Heroku</a> (Heroku docs)</li>
</ul>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://devcenter.heroku.com/search?q=django">Other Heroku Django docs</a></p>
</li>
<li>
<p>Digital Ocean</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials/how-to-serve-django-applications-with-uwsgi-and-nginx-on-ubuntu-16-04">How To Serve Django Applications with uWSGI and Nginx on Ubuntu 16.04</a></li>
<li><a target="_blank" rel="noopener" href="https://www.digitalocean.com/community/tutorials?q=django">Other Digital Ocean Django community docs</a></li>
</ul>
</li>
<li>
<p><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2017/07/iaas-paas-saas.html">IaaS，PaaS，SaaS 的区别</a></p>
</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joaxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://u.pinsflora.xyz/Pysnista/Django/dj_intro11_production/">https://u.pinsflora.xyz/Pysnista/Django/dj_intro11_production/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Django/">Django</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Pysnista/Django/dj_intro_/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/py/django_cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Django Introduction Part 1</div></div></a></div><div class="next-post pull-right"><a href="/Pysnista/Django/dj_intro2_models/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/py/django_cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">Django Introduction Part 2 - Models</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> Related Articles</span></div><div class="relatedPosts-list"><div><a href="/Pysnista/Django/dj_FAQ/" title="Django FAQ"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-09-05</div><div class="title">Django FAQ</div></div></a></div><div><a href="/Pysnista/Django/dj_intro3_dbs/" title="Django Introduction Part3 - Database"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_stars_man_orchard_photos.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-09-05</div><div class="title">Django Introduction Part3 - Database</div></div></a></div><div><a href="/Pysnista/Django/dj_intro4_admin/" title="Django Introduction Part4 - Admin"><img class="cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_sea_stairs.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2020-08-05</div><div class="title">Django Introduction Part4 - Admin</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Joaxin</div><div class="author-info__description">When I close my eyes, I'm in my own ♡cean 🐟aves.</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">268</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">90</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">33</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/joaxin"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/joaxin" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:lotility@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>Announcement</span></div><div class="announcement_content">感謝訪問本站，若喜歡請收藏 ^_^</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#overview"><span class="toc-number">1.</span> <span class="toc-text"> Overview</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-a-production-environment"><span class="toc-number">2.</span> <span class="toc-text"> What is a production environment?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#choosing-a-hosting-provider"><span class="toc-number">3.</span> <span class="toc-text"> Choosing a hosting provider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#getting-your-website-ready-to-publish"><span class="toc-number">4.</span> <span class="toc-text"> Getting your website ready to publish</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#heroku"><span class="toc-number">5.</span> <span class="toc-text"> Heroku</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#why-heroku"><span class="toc-number">5.1.</span> <span class="toc-text"> Why Heroku?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#how-does-heroku-work"><span class="toc-number">5.2.</span> <span class="toc-text"> How does Heroku work?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-the-app-for-heroku"><span class="toc-number">5.3.</span> <span class="toc-text"> Create the app for Heroku</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#procfile"><span class="toc-number">5.3.1.</span> <span class="toc-text"> Procfile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#gunicorn"><span class="toc-number">5.3.2.</span> <span class="toc-text"> Gunicorn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#database-configuration"><span class="toc-number">5.3.3.</span> <span class="toc-text"> Database configuration</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#serving-static-files-in-production"><span class="toc-number">5.3.4.</span> <span class="toc-text"> Serving static files in production</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#whitenoise"><span class="toc-number">5.3.5.</span> <span class="toc-text"> Whitenoise</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#requirements-runtime"><span class="toc-number">5.3.6.</span> <span class="toc-text"> Requirements &amp; Runtime</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#save-changes-to-github-and-re-test"><span class="toc-number">5.3.7.</span> <span class="toc-text"> Save changes to Github and re-test</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-and-upload-the-website"><span class="toc-number">5.4.</span> <span class="toc-text"> Create and upload the website</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#managing-addons"><span class="toc-number">5.5.</span> <span class="toc-text"> Managing addons</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#setting-configuration-variables"><span class="toc-number">5.6.</span> <span class="toc-text"> Setting configuration variables</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#debugging"><span class="toc-number">5.7.</span> <span class="toc-text"> Debugging</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references"><span class="toc-number">6.</span> <span class="toc-text"> REFERENCES</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤"><img src="https://i.postimg.cc/KYPmhV8w/android-new-logo.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安卓 | 装机必备清单及习惯步骤"/></a><div class="content"><a class="title" href="/Life/apps/life_apps_android_list/" title="安卓 | 装机必备清单及习惯步骤">安卓 | 装机必备清单及习惯步骤</a><time datetime="2020-06-20T04:29:10.462Z" title="Created 2020-06-20 12:29:10">2020-06-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_writing-letters-french.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - 操作图像"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_pillow/" title="Python - 操作图像">Python - 操作图像</a><time datetime="2020-05-02T16:00:00.000Z" title="Created 2020-05-03 00:00:00">2020-05-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word"><img src="https://i.loli.net/2020/07/09/6ALoRXnITgcuvy2.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python - PDF &amp; Word"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_files_pdf_word/" title="Python - PDF &amp; Word">Python - PDF &amp; Word</a><time datetime="2020-04-12T16:00:00.000Z" title="Created 2020-04-13 00:00:00">2020-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Shutil &amp; Zip"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_shutil_zip/" title="Python Shutil &amp; Zip">Python Shutil &amp; Zip</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess"><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_tree_dawnlights.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python Subprocess"/></a><div class="content"><a class="title" href="/Pysnista/Intro/files/py_subprocess/" title="Python Subprocess">Python Subprocess</a><time datetime="2020-02-23T16:00:00.000Z" title="Created 2020-02-24 00:00:00">2020-02-24</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover/cover_seeds.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Joaxin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Refine, the Life</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="Increase font size"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="Decrease font size"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="fasle"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/fae45343.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'fae45343',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>