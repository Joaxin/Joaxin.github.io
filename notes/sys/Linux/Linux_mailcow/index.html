<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Mailserver - Mailcow | Pinsflora</title><meta name="description" content="How to build a Emailsever on your VPS"><meta name="keywords" content="email"><meta name="author" content="Joaxin"><meta name="copyright" content="Joaxin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://u.pinsflora.com/notes/sys/Linux/Linux_mailcow/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Mailserver - Mailcow"><meta property="og:url" content="https://u.pinsflora.com/notes/sys/Linux/Linux_mailcow/"><meta property="og:site_name" content="Pinsflora"><meta property="og:description" content="How to build a Emailsever on your VPS"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/linux/email/mailcow_cover.png"><meta property="article:published_time" content="2018-09-16T16:00:00.000Z"><meta property="article:modified_time" content="2019-05-12T16:00:00.000Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-177831205-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-177831205-1');
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime: 'days',
  date_suffix: {"one_hour":"Just","hours":"hours ago","day":"days ago"},
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
    },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2019-05-13 00:00:00'
}</script><noscript><style type="text/css">
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
  }
}

var autoChangeMode = 'false'
var t = saveToLocal.get('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (saveToLocal.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><meta name="generator" content="Hexo 5.1.1"><link rel="alternate" href="/atom.xml" title="Pinsflora" type="application/atom+xml">
</head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://avatars2.githubusercontent.com/u/8346164?s=460&amp;v=4" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">272</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">98</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">31</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#what-is-mailcow"><span class="toc-number">1.</span> <span class="toc-text"> What is Mailcow?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#swap"><span class="toc-number">2.</span> <span class="toc-text"> Swap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mailcow-step-by-step"><span class="toc-number">3.</span> <span class="toc-text"> Mailcow Step-By-Step</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#moo-configuration"><span class="toc-number">4.</span> <span class="toc-text"> Moo Configuration</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#the-minimal-dns-configuration"><span class="toc-number">4.1.</span> <span class="toc-text"> The minimal DNS configuration</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#login-to-your-mailcow"><span class="toc-number">4.2.</span> <span class="toc-text"> Login to your mailcow</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#create-a-dkim-key"><span class="toc-number">4.3.</span> <span class="toc-text"> Create a DKIM key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#login-to-your-email"><span class="toc-number">4.4.</span> <span class="toc-text"> Login to your email</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rdns"><span class="toc-number">4.5.</span> <span class="toc-text"> rDNS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#references"><span class="toc-number">5.</span> <span class="toc-text"> REFERENCES</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/linux/email/mailcow_cover.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pinsflora</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-file-image-o"></i><span> Galleries</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> Games</span></a></li><li><a class="site-page" href="/tools/"><i class="fa-fw fas fa-wrench"></i><span> Tools</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Mailserver - Mailcow</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2018-09-16T16:00:00.000Z" title="Created 2018-09-17 00:00:00">2018-09-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2019-05-12T16:00:00.000Z" title="Updated 2019-05-13 00:00:00">2019-05-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/System/">System</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/System/Linux/">Linux</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">1.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>11min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="what-is-mailcow"><a class="markdownIt-Anchor" href="#what-is-mailcow"></a> What is Mailcow?</h2>
<p>​	Hosting your own email server is probably one of the most challenging things to set up. Sending a send-only email server is easy, but receiving emails and setting up mailboxes and client access is very difficult. It is necessary to configure multiple pieces and integrate them together properly to have a proper functioning Email Server.</p>
<p>​	I personally tried to do it on my own, but why reinvent the wheel? Now, we will use Mailcow to create a fully functioning email server!</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://mailcow.github.io/mailcow-dockerized-docs/">Mailcow</a> is a fully automated piece of software which installs a fully functional mail server on your machine.</p>
</blockquote>
<h2 id="swap"><a class="markdownIt-Anchor" href="#swap"></a> Swap</h2>
<p>I am using the very basic Vultr VPS, so memory is limited to 512MB, obviously it is enough for docker.</p>
<p>First us check the memory you have:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo free -mh</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">			total        used        free      shared  buff&#x2F;cache   available</span><br><span class="line">Mem:          481M        136M       190M     664K        154M        328M</span><br><span class="line">Swap:          0B          0B        0B</span><br></pre></td></tr></table></figure>
<p>Look, you do not have a swap, so u need to create it:</p>
<p>Generally, the value of swap is 1~2 times your VPS memory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install htop</span><br><span class="line">sudo htop <span class="comment">## Check the CPU RAM DISK USAGE</span></span><br><span class="line">sudo fallocate -l 1G /swapfile</span><br><span class="line">ls -lh /swapfile</span><br><span class="line"><span class="comment"># -rw-r--r-- 1 root root 1.0G Oct 17 14:55 /swapfile</span></span><br><span class="line">sudo chmod 600 /swapfile</span><br><span class="line">sudo mkswap /swapfile</span><br><span class="line"><span class="comment">## Setting up swapspace version 1, size = 1024 MiB (1073737728 bytes)</span></span><br><span class="line"><span class="comment">## no label, UUID=273b89b5-f675-4de6-a827-9a6d51d441a4</span></span><br><span class="line">sudo swapon /swapfile</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo swapon -s</span><br><span class="line"><span class="comment"># Filename                           Type            Size    Used    Priority</span></span><br><span class="line"><span class="comment"># /swapfile                          file            1048572 0       -2</span></span><br><span class="line">sudo vi /etc/fstab</span><br><span class="line"><span class="comment"># ADD /swapfile  none  swap  sw  0  0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo free -mh</span><br><span class="line"><span class="comment">#               total        used        free      shared  buff/cache   available</span></span><br><span class="line"><span class="comment"># Mem:           481M        181M         31M        844K        268M        287M</span></span><br><span class="line"><span class="comment"># Swap:          1.0G          0B        1.0G</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## If you would like to delete the swap space</span></span><br><span class="line"><span class="comment"># sudo swapoff /swapfile</span></span><br><span class="line"><span class="comment"># sudo rm /swapfile</span></span><br></pre></td></tr></table></figure>
<h2 id="mailcow-step-by-step"><a class="markdownIt-Anchor" href="#mailcow-step-by-step"></a> Mailcow Step-By-Step</h2>
<p>Update your environment first,</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update &amp;&amp; apt upgrade </span><br></pre></td></tr></table></figure>
<p>Check your ports using the following command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -tulpn | grep -E -w <span class="string">&#x27;25|80|110|143|443|465|587|993|995&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      5320&#x2F;nginx: master</span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      5320&#x2F;nginx: master</span><br></pre></td></tr></table></figure>
<p>If the command results in any programs, shut those programs down! It is okay if port 80 and 443 is occupied by an existing web server if you intend to reverse proxy to the Mailcow Web UI using this mail server.</p>
<ol>
<li>
<p>First you need to install Docker on your system, and enable it</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt autoremove <span class="comment">## clean some space</span></span><br><span class="line">curl -sSL https://get.docker.com/ | CHANNEL=stable sh</span><br></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Executing docker install script, commit: 36b78b2</span><br><span class="line">+ sh -c apt-get update -qq &gt;&#x2F;dev&#x2F;null</span><br><span class="line">+ sh -c apt-get install -y -qq apt-transport-https ca-certificates curl &gt;&#x2F;dev&#x2F;null</span><br><span class="line">+ sh -c curl -fsSL &quot;https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;ubuntu&#x2F;gpg&quot; | apt-key add -qq - &gt;&#x2F;dev&#x2F;null</span><br><span class="line">Warning: apt-key output should not be parsed (stdout is not a terminal)</span><br><span class="line">+ sh -c echo &quot;deb [arch&#x3D;amd64] https:&#x2F;&#x2F;download.docker.com&#x2F;linux&#x2F;ubuntu bionic stable&quot; &gt; &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;docker.list</span><br><span class="line">+ [ ubuntu &#x3D; debian ]</span><br><span class="line">+ sh -c apt-get update -qq &gt;&#x2F;dev&#x2F;null</span><br><span class="line">+ sh -c apt-get install -y -qq --no-install-recommends docker-ce &gt;&#x2F;dev&#x2F;null</span><br><span class="line">+ sh -c docker version</span><br><span class="line">Client:</span><br><span class="line"> Version:           18.06.1-ce</span><br><span class="line"> API version:       1.38</span><br><span class="line"> Go version:        go1.10.3</span><br><span class="line"> Git commit:        e68fc7a</span><br><span class="line"> Built:             Tue Aug 21 17:24:51 2018</span><br><span class="line"> OS&#x2F;Arch:           linux&#x2F;amd64</span><br><span class="line"> Experimental:      false</span><br><span class="line"></span><br><span class="line">Server:</span><br><span class="line"> Engine:</span><br><span class="line">  Version:          18.06.1-ce</span><br><span class="line">  API version:      1.38 (minimum version 1.12)</span><br><span class="line">  Go version:       go1.10.3</span><br><span class="line">  Git commit:       e68fc7a</span><br><span class="line">  Built:            Tue Aug 21 17:23:15 2018</span><br><span class="line">  OS&#x2F;Arch:          linux&#x2F;amd64</span><br><span class="line">  Experimental:     false</span><br><span class="line">If you would like to use Docker as a non-root user, you should now consider</span><br><span class="line">adding your user to the &quot;docker&quot; group with something like:</span><br><span class="line"></span><br><span class="line">  sudo usermod -aG docker your-user</span><br><span class="line"></span><br><span class="line">Remember that you will have to log out and back in for this to take effect!</span><br><span class="line"></span><br><span class="line">WARNING: Adding a user to the &quot;docker&quot; group will grant the ability to run</span><br><span class="line">         containers which can be used to obtain root privileges on the</span><br><span class="line">         docker host.</span><br><span class="line">         Refer to https:&#x2F;&#x2F;docs.docker.com&#x2F;engine&#x2F;security&#x2F;security&#x2F;#docker-daemon-attack-surface</span><br><span class="line">         for more information.</span><br></pre></td></tr></table></figure>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">enable</span> docker.service</span><br><span class="line">systemctl start docker.service</span><br><span class="line"><span class="comment">## Synchronizing state of docker.service with SysV service script with /lib/systemd/systemd-sysv-install.</span></span><br><span class="line"><span class="comment">## Executing: /lib/systemd/systemd-sysv-install enable docker</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Next, install Docker-Compose on your system</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -L https://github.com/docker/compose/releases/download/$(curl -Ls https://www.servercow.de/docker-compose/latest.php)/docker-compose-$(uname -s)-$(uname -m) &gt; /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line">chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> compose-$(uname -s)-$(uname -m) &gt; &#x2F;usr&#x2F;local&#x2F;bin&#x2F;docker-compose</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   617    0   617    0     0   3808      0 --:--:-- --:--:-- --:--:--  3808</span><br><span class="line">100 11.2M  100 11.2M    0     0  30.1M      0 --:--:-- --:--:-- --:--:-- 30.1M</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Then, clone the <code>mailcow</code> repository</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">umask</span> 0022</span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/mailcow/mailcow-dockerized</span><br></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Cloning into &#39;mailcow-dockerized&#39;...</span><br><span class="line">remote: Enumerating objects: 67, done.</span><br><span class="line">remote: Counting objects: 100% (67&#x2F;67), done.</span><br><span class="line">remote: Compressing objects: 100% (42&#x2F;42), done.</span><br><span class="line">remote: Total 18075 (delta 24), reused 48 (delta 23), pack-reused 18008</span><br><span class="line">Receiving objects: 100% (18075&#x2F;18075), 10.94 MiB | 16.34 MiB&#x2F;s, done.</span><br><span class="line">Resolving deltas: 100% (10553&#x2F;10553), done.</span><br></pre></td></tr></table></figure>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd mailcow-dockerized</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>After that, generate the configuration file using <code>./generate_config.sh</code>. Use your fully-qualified domain when asked</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Press enter to confirm the detected value &#39;[value]&#39; where applicable or enter a custom value.</span><br><span class="line">Hostname (FQDN): mail.yourdomain.com</span><br><span class="line">Timezone [Asia&#x2F;Shanghai]:</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>You can change the <code>mailcow.conf</code> file to edit the paramters.</p>
<ul>
<li>If you intend to reverse proxy to the Mailcow web server using the existing web server on the system (guide to reverse-proxy below), you may want to change the <code>HTTP_PORT</code> and <code>HTTPS_PORT</code> parameters to different, unused ports. Also change <code>SKIP_LETS_ENCRYPT=y</code> for reverse proxying (Not necessary, but recommended).</li>
<li>I also recommend changing <code>SYSCTL_IPV6_DISABLED=1</code> if you don’t intend to use IPv6.</li>
<li>Change <code>SKIP_CLAMD=y</code> if you have RAM contraints. ClamAV can be a RAM hog.</li>
<li>Find # Additional SAN for the certificate and enter your domain</li>
</ul>
</li>
<li>
<p>Next, start all the dockers!</p>
</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /opt/mailcow-dockerized</span><br><span class="line">sudo docker-compose pull</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">WARNING: The WATCHDOG_NOTIFY_EMAIL variable is not set. Defaulting to a blank st                ring.</span><br><span class="line">Pulling unbound-mailcow   ... done</span><br><span class="line">Pulling mysql-mailcow     ... done</span><br><span class="line">Pulling redis-mailcow     ... done</span><br><span class="line">Pulling clamd-mailcow     ... done</span><br><span class="line">Pulling php-fpm-mailcow   ... done</span><br><span class="line">Pulling sogo-mailcow      ... done</span><br><span class="line">Pulling dovecot-mailcow   ... done</span><br><span class="line">Pulling postfix-mailcow   ... done</span><br><span class="line">Pulling memcached-mailcow ... done</span><br><span class="line">Pulling nginx-mailcow     ... done</span><br><span class="line">Pulling rspamd-mailcow    ... done</span><br><span class="line">Pulling acme-mailcow      ... done</span><br><span class="line">Pulling netfilter-mailcow ... done</span><br><span class="line">Pulling watchdog-mailcow  ... done</span><br><span class="line">Pulling dockerapi-mailcow ... done</span><br><span class="line">Pulling ipv6nat           ... done</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker-compose up -d</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">WARNING: The WATCHDOG_NOTIFY_EMAIL variable is not set. Defaulting to a blank string.</span><br><span class="line">Removing mailcowdockerized_mysql-mailcow_1</span><br><span class="line">Removing mailcowdockerized_sogo-mailcow_1</span><br><span class="line">Removing mailcowdockerized_dovecot-mailcow_1</span><br><span class="line">Removing mailcowdockerized_postfix-mailcow_1</span><br><span class="line">Removing mailcowdockerized_watchdog-mailcow_1</span><br><span class="line">Recreating 4adbee63f314_mailcowdockerized_sogo-mailcow_1 ...</span><br><span class="line">Recreating 4adbee63f314_mailcowdockerized_sogo-mailcow_1     ... done</span><br><span class="line">Recreating 66901ec350da_mailcowdockerized_mysql-mailcow_1    ... done</span><br><span class="line">Recreating d15cea546274_mailcowdockerized_watchdog-mailcow_1 ...</span><br><span class="line">Recreating d15cea546274_mailcowdockerized_watchdog-mailcow_1 ... done</span><br><span class="line">Starting mailcowdockerized_clamd-mailcow_1                   ... done</span><br><span class="line">Starting mailcowdockerized_redis-mailcow_1                   ... done</span><br><span class="line">Recreating 6a867a09fa87_mailcowdockerized_dovecot-mailcow_1  ... done</span><br><span class="line">Starting mailcowdockerized_unbound-mailcow_1                 ... done</span><br><span class="line">Starting mailcowdockerized_memcached-mailcow_1               ... done</span><br><span class="line">Starting mailcowdockerized_dockerapi-mailcow_1               ... done</span><br><span class="line">Recreating fb2ac0439a75_mailcowdockerized_postfix-mailcow_1  ... done</span><br><span class="line">Creating mailcowdockerized_nginx-mailcow_1                   ... error</span><br><span class="line"></span><br><span class="line">ERROR: for mailcowdockerized_nginx-mailcow_1  Cannot start service nginx-mailcow: driver failed programming external connectivity on endpoint mailcowdockerized_nginx-mailcow_1 (1ce8415046d369a04a8c554f4b8e381821126cf2684ed9baebbd3c35432f4641): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use</span><br><span class="line">Creating mailcowdockerized_netfilter-mailcow_1               ... done</span><br><span class="line"></span><br><span class="line">ERROR: for nginx-mailcow  Cannot start service nginx-mailcow: driver failed programming external connectivity on endpoint mailcowdockerized_nginx-mailcow_1 (1ce8415046d369a04a8c554f4b8e381821126cf2684ed9baebbd3c35432f4641): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use</span><br><span class="line">ERROR: Encountered errors while bringing up the project.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo nginx -s stop</span><br><span class="line">sudo docker-compose up -d</span><br><span class="line">sudo nginx -s start</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">WARNING: The WATCHDOG_NOTIFY_EMAIL variable is not set. Defaulting to a blank string.</span><br><span class="line">mailcowdockerized_sogo-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_mysql-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_watchdog-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_dovecot-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_memcached-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_ipv6nat_1 is up-to-date</span><br><span class="line">mailcowdockerized_clamd-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_redis-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_postfix-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_unbound-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_dockerapi-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_php-fpm-mailcow_1 is up-to-date</span><br><span class="line">mailcowdockerized_netfilter-mailcow_1 is up-to-date</span><br><span class="line">Starting mailcowdockerized_nginx-mailcow_1 ... done</span><br><span class="line">Creating mailcowdockerized_rspamd-mailcow_1 ... done</span><br><span class="line">Creating mailcowdockerized_acme-mailcow_1   ... done</span><br></pre></td></tr></table></figure>
<p><strong>port 25</strong></p>
<p>netstat -tuplen | grep <em>25</em></p>
<p>iptables -nL | grep 25</p>
<p>The other option you have, is to use <strong>Nmap</strong> ↴</p>
<p>You can use <code>nmap -sT localhost</code> to determine which ports are listening for TCP connections from the network. To check for UDP ports, you should use <code>-sU</code> option.</p>
<p>To check for port 25, you can easily use <code>nmap -p25 localhost</code>.</p>
<p>And if you do not have access to the system, you can use <code>nmap -sS -p25 yourTargetIP</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.60 ( https:&#x2F;&#x2F;nmap.org ) at 2018-10-17 19:12 CST</span><br><span class="line">Nmap scan report for localhost (127.0.0.1)</span><br><span class="line">Host is up (0.000078s latency).</span><br><span class="line">Other addresses for localhost (not scanned): ::1</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">25&#x2F;tcp open  smtp</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds</span><br></pre></td></tr></table></figure>
<h2 id="moo-configuration"><a class="markdownIt-Anchor" href="#moo-configuration"></a> Moo Configuration</h2>
<h3 id="the-minimal-dns-configuration"><a class="markdownIt-Anchor" href="#the-minimal-dns-configuration"></a> The minimal DNS configuration</h3>
<p>This example shows you a set of records for one domain managed by mailcow. Each domain that is added to mailcow needs at least this set of records to function correctly.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> Name              Type       Value</span><br><span class="line">mail                IN A       1.2.3.4</span><br><span class="line">autodiscover        IN CNAME   mail</span><br><span class="line">autoconfig          IN CNAME   mail</span><br><span class="line">@                   IN MX 10   mail</span><br><span class="line">@                 IN  TXT &quot;v&#x3D;spf1 a ip4:1.2.3.4 ip6:1111:2222:3333:4444::1&#x2F;128 ~all&quot;</span><br></pre></td></tr></table></figure>
<h3 id="login-to-your-mailcow"><a class="markdownIt-Anchor" href="#login-to-your-mailcow"></a> Login to your mailcow</h3>
<p>You should now be able to access the web administration page at <code>https://&lt;domain-name&gt;</code> with default credentials <code>admin</code> and password <code>moohoo</code>. But wait, even the easiest mail servers need some extra work!</p>
<p>Then,add your domain <a target="_blank" rel="noopener" href="http://xxx.xxx">xxx.xxx</a>(<code>Configuration-&gt;Mailboxes-&gt;Domains</code>),mailbox(<code>Configuration-&gt;Mailboxes-&gt; Mailboxes</code>)</p>
<h3 id="create-a-dkim-key"><a class="markdownIt-Anchor" href="#create-a-dkim-key"></a> Create a DKIM key</h3>
<p><code>Configuration -&gt; Administration -&gt; ARC/DKIM keys``Domain</code>:<code>xxx.xxx</code>， <code>Selector</code> :<code>dkim</code>，length:1024：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dkim._domainkey  IN TXT     &quot;v&#x3D;DKIM1; k&#x3D;rsa; t&#x3D;s; s&#x3D;email; p&#x3D;...&quot;</span><br><span class="line">_dmarc           IN TXT     &quot;v&#x3D;DMARC1; p&#x3D;reject; pct&#x3D;100;&quot;</span><br></pre></td></tr></table></figure>
<p>Now, your DNS record would like be this,</p>
<p><img src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/linux/email/mailcow_dnsrecord.png" alt="DNS Record From Aliyun" /></p>
<h3 id="login-to-your-email"><a class="markdownIt-Anchor" href="#login-to-your-email"></a> Login to your email</h3>
<p>Once your domain is added you should be able to login to SOGo the Built-in Mail client.</p>
<p>Browse to <a target="_blank" rel="noopener" href="https://mail.yourdomain.com/SOGo">https://mail.yourdomain.com/SOGo</a> and login with the mailbox details you’ve just created.</p>
<p>name: <a href="mailto:name@xxx.xxx">name@xxx.xxx</a> password:your password</p>
<h3 id="rdns"><a class="markdownIt-Anchor" href="#rdns"></a> rDNS</h3>
<p><a target="_blank" rel="noopener" href="https://www.vultr.com/docs/how-to-create-reverse-dns-or-ptr-records-in-the-vultr-control-panel"> Reverse DNS or PTR Records </a></p>
<p><a target="_blank" rel="noopener" href="https://www.vultr.com/docs/how-to-create-reverse-dns-or-ptr-records-in-the-vultr-control-panel"> Reverse DNS or PTR Records </a></p>
<p>In order for mail to be accepted correctly we need to set PTR records for the IP’s used on your server, in this guide we’re using <a target="_blank" rel="noopener" href="http://mail.yourdomain.com">mail.yourdomain.com</a> so we need to set the PTR to that.</p>
<p>In the DevCapsule Control Panel, select the server you’re using and goto the settings tab.</p>
<p>Click IPv4 and edit the PTR setting to <a target="_blank" rel="noopener" href="http://mail.yourdomain.com">mail.yourdomain.com</a></p>
<h2 id="references"><a class="markdownIt-Anchor" href="#references"></a> REFERENCES</h2>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://github.com/mailcow/mailcow-dockerized/">https://github.com/mailcow/mailcow-dockerized/</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://mailcow.github.io/mailcow-dockerized-docs/install/">https://mailcow.github.io/mailcow-dockerized-docs/install/</a></p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://blog.shivamtrivedi.com/how-to-install-and-configure-mailcow-on-ubuntu-16-04/">https://blog.shivamtrivedi.com/how-to-install-and-configure-mailcow-on-ubuntu-16-04/</a></p>
</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Joaxin</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://u.pinsflora.com/notes/sys/Linux/Linux_mailcow/">https://u.pinsflora.com/notes/sys/Linux/Linux_mailcow/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/email/">email</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/notes/it/notes_it_vuepress/"><img class="prev-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">VuePress 笔记</div></div></a></div><div class="next-post pull-right"><a href="/life/games/life_game_94/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/cover_posts/misc/94_halloween.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">94%</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div></div></div></div></article></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/joaxin/img_bed/img/linux/email/mailcow_cover.png)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Joaxin</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Refine, the Life</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">繁</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js', function () {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'default',
      })
      false && mermaid.init()
    })
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script defer="defer" id="ribbon" src="/js/third-party/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="fasle"></script><script src="/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/fae45343.js","daovoice")
</script><script>var isChatBtn = true
daovoice('init', {
  app_id: 'fae45343',},{
  launcher: { 
     disableLauncherIcon: isChatBtn // 悬浮 ICON 是否显示
  },
});
daovoice('update');

if (isChatBtn) {
  var chatBtnFn = () => {
    var chatBtn = document.getElementById("chat_btn")
    chatBtn.addEventListener("click", function(){
      daovoice('show')
    });
  }
  chatBtnFn()
} else {
  if (true) {
    function chatBtnHide () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: true // 悬浮 ICON 是否显示
        },
      });
    }
    function chatBtnShow () {
      daovoice('update', {},{
        launcher: { 
        disableLauncherIcon: false // 悬浮 ICON 是否显示
        },
      });
    }
  }
}</script></div></body></html>